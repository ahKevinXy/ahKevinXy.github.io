"use strict";(self.webpackChunkah_kevin_xy=self.webpackChunkah_kevin_xy||[]).push([[1350],{68360:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>p,contentTitle:()=>c,default:()=>y,frontMatter:()=>a,metadata:()=>o,toc:()=>l});var i=t(74848),r=t(28453);const a={title:"Go \u4e0e Java  Rsa\u52a0\u5bc6\u7b97\u6cd5",tags:["Go","Java","\u52a0\u5bc6","RSA"],authors:"ahKevinXy",keywords:["java","go","RSA","\u52a0\u5bc6","\u517c\u5bb9"],description:"Go \u4e0e Java  Rsa\u52a0\u5bc6\u7b97\u6cd5 \u517c\u5bb9\u6027\u52a0\u5bc6\u89e3\u51b3\u65b9\u6848 \u5b8c\u7f8e\u89e3\u51b3\u8bed\u8a00\u4e4b\u95f4\u52a0\u5bc6\u4e0d\u517c\u5bb9",hide_table_of_contents:!1},c="Go \u4e0e Java  Rsa\u52a0\u5bc6\u7b97\u6cd5",o={permalink:"/blog/2022/11/25/index",source:"@site/blog/2022/11/25/index.md",title:"Go \u4e0e Java  Rsa\u52a0\u5bc6\u7b97\u6cd5",description:"Go \u4e0e Java  Rsa\u52a0\u5bc6\u7b97\u6cd5 \u517c\u5bb9\u6027\u52a0\u5bc6\u89e3\u51b3\u65b9\u6848 \u5b8c\u7f8e\u89e3\u51b3\u8bed\u8a00\u4e4b\u95f4\u52a0\u5bc6\u4e0d\u517c\u5bb9",date:"2022-11-25T00:00:00.000Z",formattedDate:"2022\u5e7411\u670825\u65e5",tags:[{label:"Go",permalink:"/blog/tags/go"},{label:"Java",permalink:"/blog/tags/java"},{label:"\u52a0\u5bc6",permalink:"/blog/tags/\u52a0\u5bc6"},{label:"RSA",permalink:"/blog/tags/rsa"}],readingTime:3.17,hasTruncateMarker:!0,authors:[{name:"ahKevinXy",title:"\u4f5c\u8005",url:"https://github.com/ahKevinXy",email:"ahkevinxy@gmail.com",imageURL:"/img/headers.png",key:"ahKevinXy"}],frontMatter:{title:"Go \u4e0e Java  Rsa\u52a0\u5bc6\u7b97\u6cd5",tags:["Go","Java","\u52a0\u5bc6","RSA"],authors:"ahKevinXy",keywords:["java","go","RSA","\u52a0\u5bc6","\u517c\u5bb9"],description:"Go \u4e0e Java  Rsa\u52a0\u5bc6\u7b97\u6cd5 \u517c\u5bb9\u6027\u52a0\u5bc6\u89e3\u51b3\u65b9\u6848 \u5b8c\u7f8e\u89e3\u51b3\u8bed\u8a00\u4e4b\u95f4\u52a0\u5bc6\u4e0d\u517c\u5bb9",hide_table_of_contents:!1},unlisted:!1,prevItem:{title:"umi4 \u914d\u7f6e antd \u9ed8\u8ba4\u4e2d\u6587\u6a21\u5f0f",permalink:"/blog/2023/02/24/index"},nextItem:{title:"\u7a0b\u5e8f\u5458\u5230\u67b6\u6784\u5e08",permalink:"/blog/2022/09/22/index"}},p={authorsImageUrls:[void 0]},l=[{value:"go  \u4ee3\u7801",id:"go--\u4ee3\u7801",level:2},{value:"java \u4ee3\u7801",id:"java-\u4ee3\u7801",level:2}];function s(e){const n={admonition:"admonition",code:"code",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"\u26a1\ufe0f \u548c \u7532\u65b9\u5bf9\u63a5\u7cfb\u7edf \u9047\u5230 java Rsa \u52a0\u5bc6  go \u65e0\u6cd5\u89e3\u5bc6\u7684\u95ee\u9898"}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"go \u751f\u6210\u7684\u516c\u94a5 \u4e0d\u80fd\u76f4\u63a5\u7ed9Java\u4f7f\u7528"}),"\n",(0,i.jsxs)(n.li,{children:["java\u7684 \u516c\u94a5 \u9700\u8981\u628a  go \u751f\u6210\u7684\u5934 ",(0,i.jsx)(n.code,{children:"-----BEGIN RSA Public Key-----"})," \u548c ",(0,i.jsx)(n.code,{children:"-----END RSA Public Key-----"})," \u5220\u9664 \u4e0d\u80fd\u4fdd\u5b58\u5373\u53ef"]}),"\n"]})}),"\n",(0,i.jsx)(n.h2,{id:"go--\u4ee3\u7801",children:"go  \u4ee3\u7801"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",children:'package rsa\n\nimport (\n\t"crypto/rand"\n\t"crypto/rsa"\n\t"crypto/x509"\n\t"encoding/base64"\n\t"encoding/pem"\n\t"fmt"\n\t"os"\n)\n\n//RSA\u89e3\u5bc6\nfunc Decrypt(cipherText []byte, path string) []byte {\n\t//\u6253\u5f00\u6587\u4ef6\n\tfile, err := os.Open(path)\n\tif err != nil {\n\t\tpanic(err)\n\t}\n\tdefer file.Close()\n\t//\u83b7\u53d6\u6587\u4ef6\u5185\u5bb9\n\tinfo, _ := file.Stat()\n\tbuf := make([]byte, info.Size())\n\tfile.Read(buf)\n\t//pem\u89e3\u7801\n\tblock, _ := pem.Decode(buf)\n\t//X509\u89e3\u7801\n\tprivateKey, err := x509.ParsePKCS1PrivateKey(block.Bytes)\n\tif err != nil {\n\t\tpanic(err)\n\t}\n\t//\u5bf9\u5bc6\u6587\u8fdb\u884c\u89e3\u5bc6\n\tplainText, _ := rsa.DecryptPKCS1v15(rand.Reader, privateKey, cipherText)\n\t//\u8fd4\u56de\u660e\u6587\n\treturn plainText\n}\n\n// DecryptByString\n// @Description: \u89e3\u5bc6\n// @Author ahKevinXy\n// @Date 2022-11-22 16:50:15\nfunc DecryptByString(cipherText string, key string) []byte {\n\t//\u6253\u5f00\u6587\u4ef6\n\tcontent := Base64Decode(cipherText)\n\t//X509\u89e3\u7801\n\n\tblock, _ := pem.Decode([]byte(key))\n\n\tprivateKey, err := x509.ParsePKCS1PrivateKey(block.Bytes)\n\tif err != nil {\n\t\tpanic(err)\n\t}\n\t//\u5bf9\u5bc6\u6587\u8fdb\u884c\u89e3\u5bc6\n\tplainText, _ := rsa.DecryptPKCS1v15(rand.Reader, privateKey, content)\n\t//\u8fd4\u56de\u660e\u6587\n\treturn plainText\n}\n\n//RSA\u52a0\u5bc6 \u901a\u8fc7\u79c1\u94a5\u8def\u5f84\nfunc Encrypt(plainText []byte, path string) []byte {\n\t//\u6253\u5f00\u6587\u4ef6\n\tfile, err := os.Open(path)\n\tif err != nil {\n\t\tpanic(err)\n\t}\n\n\tdefer file.Close()\n\t//\u8bfb\u53d6\u6587\u4ef6\u7684\u5185\u5bb9\n\tinfo, _ := file.Stat()\n\tbuf := make([]byte, info.Size())\n\tfile.Read(buf)\n\t//pem\u89e3\u7801\n\tblock, _ := pem.Decode(buf)\n\t//x509\u89e3\u7801\n\tpublicKeyInterface, err := x509.ParsePKIXPublicKey(block.Bytes)\n\tif err != nil {\n\t\tpanic(err)\n\t}\n\t//\u7c7b\u578b\u65ad\u8a00\n\tpublicKey := publicKeyInterface.(*rsa.PublicKey)\n\t//\u5bf9\u660e\u6587\u8fdb\u884c\u52a0\u5bc6\n\tcipherText, err := rsa.EncryptPKCS1v15(rand.Reader, publicKey, plainText)\n\tif err != nil {\n\t\tpanic(err)\n\t}\n\t//\u8fd4\u56de\u5bc6\u6587\n\treturn cipherText\n}\n\n// \u901a\u8fc7\u76f4\u63a5\u4f20 string \u65b9\u5f0f\nfunc EncryptByString(plainText string, public string) string {\n\n\tblock, _ := pem.Decode([]byte(public))\n\t//x509\u89e3\u7801\n\tpublicKeyInterface, err := x509.ParsePKIXPublicKey(block.Bytes)\n\tif err != nil {\n\t\tpanic(err)\n\t}\n\t//\u7c7b\u578b\u65ad\u8a00\n\tpublicKey := publicKeyInterface.(*rsa.PublicKey)\n\t//\u5bf9\u660e\u6587\u8fdb\u884c\u52a0\u5bc6\n\tcipherText, err := rsa.EncryptPKCS1v15(rand.Reader, publicKey, []byte(plainText))\n\tif err != nil {\n\t\tpanic(err)\n\t}\n\tfmt.Println(cipherText)\n\t//\u8fd4\u56de\u5bc6\u6587\n\tfmt.Println(string(cipherText))\n\n\treturn Base64EncodeString(string(cipherText))\n\n}\n\nfunc Base64EncodeString(str string) string {\n\treturn base64.StdEncoding.EncodeToString([]byte(str))\n}\n\n// Base64Decode\n// @Description: base64\u89e3\u7801\n// @Author ahKevinXy\n// @Date 2022-11-22 17:04:52\nfunc Base64Decode(data string) []byte {\n\tdecodedByte, _ := base64.StdEncoding.DecodeString(data)\n\treturn decodedByte\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"java-\u4ee3\u7801",children:"java \u4ee3\u7801"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'\nimport javax.crypto.Cipher;\nimport java.io.ByteArrayOutputStream;\nimport java.security.*;\nimport java.security.interfaces.RSAPrivateKey;\nimport java.security.interfaces.RSAPublicKey;\nimport java.security.spec.InvalidKeySpecException;\nimport java.security.spec.PKCS8EncodedKeySpec;\nimport java.security.spec.X509EncodedKeySpec;\nimport java.util.Base64;\nimport java.util.HashMap;\nimport java.util.Map;\n\n\n\npublic class RSATest {\n\n public static final String KEY_ALGORITHM = "RSA";\n    // \u516c\u94a5\n    private static final String PUBLIC_KEY = "xxxxx\u52a0\u5bc6\u516c\u94a5";\n    private static final int MAX_ENCRYPT_BLOCK = 117;\n    private static final int MAX_DECRYPT_BLOCK = 128;\n    public static void main(String[] args) throws Exception {\n\n        String cipherText;\n        String content = "\u8fd9\u662f\u4e00\u4e2a\u6d4b\u8bd5\u52a0\u5bc6\u5bc6\u7801";\n        String publicKey = PUBLIC_KEY;\n\n        cipherText = encrypt(content, publicKey);\n        System.out.println(cipherText);\n    }\n\n\n\n    // \u83b7\u53d6\u516c\u94a5\n    public static PublicKey getPublicKey(String publicKeyString) throws NoSuchAlgorithmException, InvalidKeySpecException {\n        byte[] publicKeyByte = Base64.getDecoder().decode(publicKeyString);\n        X509EncodedKeySpec keySpec = new X509EncodedKeySpec(publicKeyByte);\n        KeyFactory keyFactory = KeyFactory.getInstance(KEY_ALGORITHM);\n        return keyFactory.generatePublic(keySpec);\n    }\n    public static String encrypt(String text, String publicKeyStr) {\n        try {\n          \n            Cipher cipher = Cipher.getInstance(KEY_ALGORITHM);\n            cipher.init(Cipher.ENCRYPT_MODE, getPublicKey(publicKeyStr));\n            byte[] tempBytes = cipher.doFinal(text.getBytes("UTF-8"));\n            return Base64.getEncoder().encodeToString(tempBytes);\n        } catch (Exception e) {\n            throw new RuntimeException("\u52a0\u5bc6\u5b57\u7b26\u4e32[" + text + "]\u65f6\u9047\u5230\u5f02\u5e38", e);\n        }\n    }\n\n\n\n\n\n}\n\n\n\n'})})]})}function y(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(s,{...e})}):s(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>c,x:()=>o});var i=t(96540);const r={},a=i.createContext(r);function c(e){const n=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),i.createElement(a.Provider,{value:n},e.children)}}}]);