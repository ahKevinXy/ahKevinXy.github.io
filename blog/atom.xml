<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://ahkevinxy.github.io/blog</id>
    <title>ahKevinXy Blog</title>
    <updated>2023-09-05T00:00:00.000Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://ahkevinxy.github.io/blog"/>
    <subtitle>ahKevinXy Blog</subtitle>
    <icon>https://ahkevinxy.github.io/static/img/favicon.ico</icon>
    <entry>
        <title type="html"><![CDATA[MySQL学习]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/09/05/mysql</id>
        <link href="https://ahkevinxy.github.io/blog/2023/09/05/mysql"/>
        <updated>2023-09-05T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[如何学习MySQL 你不知道的哪些事情]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="sql查询是如何执行的">SQL查询是如何执行的<a href="#sql查询是如何执行的" class="hash-link" aria-label="SQL查询是如何执行的的直接链接" title="SQL查询是如何执行的的直接链接">​</a></h2><p>MySQL 可以分成server 和存储引擎两个部分</p><ul><li><p><code>Server</code> 包括连接器,查询缓存,分析器,优化器,执行器,以及所有的内置函数,所有跨储存引擎</p></li><li><p><code>储存层</code> 负责数据的储存和提取,其架构是插件式 支持 InnoDB,MyISAM,Memory </p></li></ul><p><strong>连接器</strong>
用于数据库连接</p><p><strong>查询缓存</strong></p><p><strong>分析器</strong></p><p>语法分析</p><p><strong>优化器</strong></p><p>表里面有多个索引的时候，决定使用哪个索引；或者在一个语句有多表关联（join）的时候，决定各个表的连接顺序</p><p><strong>执行器</strong></p><ol><li>判断是否有权限</li></ol><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="sql更新语句如何执行">SQL更新语句如何执行<a href="#sql更新语句如何执行" class="hash-link" aria-label="SQL更新语句如何执行的直接链接" title="SQL更新语句如何执行的直接链接">​</a></h2><p><code>重要的日志模块</code>：redo log</p><p><code>重要的日志模块</code>：binlog</p><ol><li>redo log 是 InnoDB 引擎特有的；binlog 是 MySQL 的 Server 层实现的，所有引擎都可以使用。</li><li>redo log 是物理日志，记录的是“在某个数据页上做了什么修改”；binlog 是逻辑日志，记录的是这个语句的原始逻辑，比如“给 ID=2 这一行的 c 字段加 1 ”。</li><li>redo log 是循环写的，空间固定会用完；binlog 是可以追加写入的。“追加写”是指 binlog 文件写到一定大小后会切换到下一个，并不会覆盖以前的日志。</li></ol><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="事务">事务<a href="#事务" class="hash-link" aria-label="事务的直接链接" title="事务的直接链接">​</a></h2><p><strong>隔离性和隔离级别</strong></p><p>ACID (Atomicity,Consistency,Isolation,Durability)</p><ol><li>原子性 </li><li>一致性</li><li>隔离性</li><li>持久性</li></ol><p>隔离 </p><ol><li>读未提交 (read uncommitted) 一个事务还没提交时，它做的变更就能被别的事务看到</li><li>读提交(read committed) 一个事务提交之后，它做的变更才会被其他事务看到</li><li>可重复读 (repeatable read) 一个事务执行过程中看到的数据，总是跟这个事务在启动时看到的数据是一致的</li><li>串行 (serializable) 顾名思义是对于同一行记录，“写”会加“写锁”，“读”会加“读锁”。当出现读写锁冲突的时候，后访问的事务必须等前一个事务执行完成，才能继续执行</li></ol><p>MySQL 的隔离级别设置为<code>读提交</code></p><p><strong>事务的启动方式</strong></p><ol><li>显示启动事务语句 <code>begin</code> <code>start transaction</code> 开始事务 <code>commit</code> 提交 <code>rollback</code> 回滚</li><li>set autocommit=0，这个命令会将这个线程的自动提交关掉。意味着如果你只执行一个 select 语句，这个事务就启动了，而且并不会自动提交。这个事务持续存在直到你主动执行 commit 或 rollback 语句，或者断开连接。</li></ol><p>set autocommit=1, 通过显式语句的方式来启动事务</p>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="基础" term="基础"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[如何做好一份属于自己的ppt]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/09/05/ppt</id>
        <link href="https://ahkevinxy.github.io/blog/2023/09/05/ppt"/>
        <updated>2023-09-05T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[如何学习iOS开发]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="基本技巧">基本技巧<a href="#基本技巧" class="hash-link" aria-label="基本技巧的直接链接" title="基本技巧的直接链接">​</a></h2><ol><li>shift (规则键) 点击拖放 图片点击按 限制水平垂直反向</li><li>ctrl  (ctrl shift 水平复制移动) (ctrl shift 按照中心缩放)</li><li>ctrl + G  组合功能 (ctrl + shift + G 解除组合)</li><li>ctrl + Y 重复上一步操作</li><li>ctrl + Z 撤销操作</li><li>格式选项 (窗口) <code>图层</code></li><li>形状布尔计算 (形状格式)</li><li>图片格式(对齐)</li></ol>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="iOS" term="iOS"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[如何成为一名架构师]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/09/05/struct</id>
        <link href="https://ahkevinxy.github.io/blog/2023/09/05/struct"/>
        <updated>2023-09-05T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[如何成为一名架构师]]></summary>
        <content type="html"><![CDATA[<p>一个好的架构必须满足两方面挑战：业务复杂性和技术复杂性。</p><ol><li>业务架构</li><li>应用架构</li><li>技术架构</li></ol><p>业务架构就是讲清楚核心业务的处理过程，定义各个业务模块的相互关系，它从概念层面帮助我们理解系统面临哪些问题以及如何处理；而应用架构就是讲清楚系统内部是怎么组织的，有哪些应用，相互间是怎么调用的，它从逻辑层面帮助我们理解系统内部是如何分工与协作的。</p><p>技术架构就是讲清楚系统由哪些硬件、操作系统和中间件组成，它们是如何和我们开发的应用一起配合，应对各种异常情况，保持系统的稳定可用。所以，技术架构从物理层面帮助我们理解系统是如何构造的，以及如何解决稳定性的问题。</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="什么是架构师">什么是架构师<a href="#什么是架构师" class="hash-link" aria-label="什么是架构师的直接链接" title="什么是架构师的直接链接">​</a></h2><ol><li>沟通家里</li><li>抽象思维</li><li>多领域知识</li><li>技术前沿性</li><li>平衡取舍</li></ol><p><code>产品经理的职责</code>就是：告诉用户，系统长什么样子；告诉开发，他要实现什么功能。</p><p><code>业务架构师的职责</code> </p><p>架构的目标</p><ol><li>业务的可扩展性</li><li>业务的可复用性</li></ol><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="如何实现业务的可扩展性">如何实现业务的可扩展性<a href="#如何实现业务的可扩展性" class="hash-link" aria-label="如何实现业务的可扩展性的直接链接" title="如何实现业务的可扩展性的直接链接">​</a></h2><p><strong>系统的构成:</strong> 模块 + 关系</p><ul><li>模块</li></ul><p>从业务的角度看，每个模块都代表了某个业务概念，或者说业务领域</p><p>模块内部由数据和业务逻辑组成，其中数据是核心，业务逻辑围绕着数据，对数据做进一步加工，方便外部使用。</p><ul><li><p>依赖关系
依赖关系实质上体现的是模块的组织结构。</p></li><li><p>MVC 架构</p><ul><li>表示层 对应的前端模块</li><li>应用层 对应和前端表示层直接关联的服务端</li><li>聚合服务层</li><li>基础服务层</li></ul></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="架构的转变">架构的转变<a href="#架构的转变" class="hash-link" aria-label="架构的转变的直接链接" title="架构的转变的直接链接">​</a></h2><ol><li>单体架构</li><li>分布式架构</li><li>SOA架构 面向服务的架构</li><li>微服务架构</li></ol><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="系统故障">系统故障<a href="#系统故障" class="hash-link" aria-label="系统故障的直接链接" title="系统故障的直接链接">​</a></h2><ol><li>资源不可以</li><li>资源不足</li><li>节点功能异常</li></ol><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="如何避免故障">如何避免故障<a href="#如何避免故障" class="hash-link" aria-label="如何避免故障的直接链接" title="如何避免故障的直接链接">​</a></h2><ol><li>冗余无单点</li><li>水平扩展</li><li>柔性事务</li><li>系统可降级性 (限流,降级,熔断,功能禁用)</li><li>系统可监控</li></ol><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="日活百万系统如何架构设计">日活百万系统如何架构设计<a href="#日活百万系统如何架构设计" class="hash-link" aria-label="日活百万系统如何架构设计的直接链接" title="日活百万系统如何架构设计的直接链接">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="前端改造">前端改造<a href="#前端改造" class="hash-link" aria-label="前端改造的直接链接" title="前端改造的直接链接">​</a></h3><ul><li>web 端cdn优化</li><li>nginx 负载均衡</li><li>通信线路备份 (前置代理机) </li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="应用和服务的水平扩展">应用和服务的水平扩展<a href="#应用和服务的水平扩展" class="hash-link" aria-label="应用和服务的水平扩展的直接链接" title="应用和服务的水平扩展的直接链接">​</a></h3><ul><li>订单水平分库</li><li>异步化处理</li><li>主动通知 避免轮询</li><li>缓存的使用</li><li>一体化监控</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="如何做好系统监控">如何做好系统监控<a href="#如何做好系统监控" class="hash-link" aria-label="如何做好系统监控的直接链接" title="如何做好系统监控的直接链接">​</a></h2><ul><li><code>用户体验</code> 指的是从前端用户的访问速度出发，来监测系统的可用性，包括页面能否打开、关键接口的响应时间等等，用户体验监控一般结合前端的埋点来实现。</li><li><code>业务监控</code> 从业务结果的角度来看，比如说订单数、交易金额等等，业务监控也是最直观的，我们知道，如果业务数据没问题，系统整体也就没有问题</li><li><code>应用监控</code> 指的是对自己开发的代码进行监控，比如接口在一段时间内的调用次数、响应时间、出错次数等等</li><li><code>中间件监控</code> 的是对标准中间件进行监控，它是第三方开发的代码，比如数据库、缓存、Tomcat 等等，这些组件对应的是系统的 PaaS 层</li><li><code>基础平台监控</code> (操作系统/服务器/网络) 的是对系统底层资源进行监控，如操作系统、硬件设备等等，这个层次的监控对应的是系统的 IaaS 层</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="如何打造一体化的监控系统">如何打造一体化的监控系统<a href="#如何打造一体化的监控系统" class="hash-link" aria-label="如何打造一体化的监控系统的直接链接" title="如何打造一体化的监控系统的直接链接">​</a></h2><ul><li>节点信息采集</li><li>接入监控系统</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="常用系统参数">常用系统参数<a href="#常用系统参数" class="hash-link" aria-label="常用系统参数的直接链接" title="常用系统参数的直接链接">​</a></h2><p><img loading="lazy" alt="pt" src="/assets/images/基础数据-be7f53a8d6f15716b44846021d5cc72c.png" width="1010" height="1352" class="img_ev3q"></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="如何分库分表">如何分库分表<a href="#如何分库分表" class="hash-link" aria-label="如何分库分表的直接链接" title="如何分库分表的直接链接">​</a></h2><ul><li><code>垂直分库</code> 垂直分库就是数据库里的表太多，我们把它们分散到多个数据库</li><li><code>水平分库</code> 单个数据库存储不下，或者数据库的读写性能有压力。通过水平分库，我们把一张表拆成多张表，每张表存放部分记录，分别保存在不同的数据库里，水平分库需要对应用做比较大的改造。</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="分库策略">分库策略<a href="#分库策略" class="hash-link" aria-label="分库策略的直接链接" title="分库策略的直接链接">​</a></h3>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="基础" term="基础"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[分布式系统设计]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/09/03/distributed</id>
        <link href="https://ahkevinxy.github.io/blog/2023/09/03/distributed"/>
        <updated>2023-09-03T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[如何搭建分布式系统]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="shardingsphere">shardingSphere<a href="#shardingsphere" class="hash-link" aria-label="shardingSphere的直接链接" title="shardingSphere的直接链接">​</a></h2><ol><li><code>Cassandra</code></li></ol>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="极客时间" term="极客时间"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[ios]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/09/03/ios</id>
        <link href="https://ahkevinxy.github.io/blog/2023/09/03/ios"/>
        <updated>2023-09-03T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[---]]></summary>
        <content type="html"><![CDATA[<hr><p>title:  iOS 开发</p><p>tags: <!-- -->[iOS]<!-- -->
authors: ahKevinXy
description: 如何学习iOS开发
image: <a href="https://source.unsplash.com/random?people&amp;35" target="_blank" rel="noopener noreferrer">https://source.unsplash.com/random?people&amp;35</a></p><hr><h1>ios 开发入门学习</h1><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="资源--awesome">资源  <a href="https://github.com/vsouza/awesome-ios" target="_blank" rel="noopener noreferrer">AweSome</a><a href="#资源--awesome" class="hash-link" aria-label="资源--awesome的直接链接" title="资源--awesome的直接链接">​</a></h2><ol><li><a href="https://ming1016.github.io/" target="_blank" rel="noopener noreferrer">戴铭</a></li></ol><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//嵌套视图通过简单的 DSL 也能很好地表现出来。详细的使用说明和代码实现，你可以在这里查看</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">https://github.com/ming1016/STMAssembleView</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="架构设计规范">架构设计规范<a href="#架构设计规范" class="hash-link" aria-label="架构设计规范的直接链接" title="架构设计规范的直接链接">​</a></h2><ol><li>单一功能原则：对象功能要单一，不要在一个对象里添加很多功能。</li><li>开闭原则：扩展是开放的，修改是封闭的。</li><li>里氏替换原则：子类对象是可以替代基类对象的。</li><li>接口隔离原则：接口的用途要单一，不要在一个接口上根据不同入参实现多个功能。</li><li>依赖反转原则：方法应该依赖抽象，不要依赖实例。iOS 开发就是高层业务方法依赖于协议。</li></ol><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="llvm">LLVM<a href="#llvm" class="hash-link" aria-label="LLVM的直接链接" title="LLVM的直接链接">​</a></h2><p>LLVM的编译过程非常复杂。如果你有兴趣的话，可以通过<a href="https://llvm.org/docs/" target="_blank" rel="noopener noreferrer">官方手册</a>查看完整的编译过程。</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ios开发学习资料和书单推荐">iOS开发学习资料和书单推荐<a href="#ios开发学习资料和书单推荐" class="hash-link" aria-label="iOS开发学习资料和书单推荐的直接链接" title="iOS开发学习资料和书单推荐的直接链接">​</a></h2><p>iOS 开发往往会涉及界面交互，<code>iOS Examples</code>和<code>Cocoa Controls</code>这两个网站收集了大量的开源组件和库，并且进行了非常细致的分类，你能够非常方便地找到适合自己的“轮子”。</p><p>上的<code>Open-Source iOS Apps</code><a href="https://github.com/dkhamsing/open-source-ios-apps" target="_blank" rel="noopener noreferrer">项目</a>。作者在这个项目中收录了很多优秀的、完整的开源 iOS App，并做了详细分类，还专门标出了上架了 App Store 的开源 iOS App。</p><p><code>AFNetworking</code> 和 <code>Alamofire</code> 的作者 Mattt 维护着一个 NSHipster的网站，主要关注的是一些不常用的 iOS 知识点</p><p><code>Raywenderlich</code>出版的图书质量都非常不错，可以一步一步教你掌握一些开发知识，内容非常实用，而且这些图书的涉及面广。比如，这些图书包括有 ARKit、Swift 服务端的 <code>Vapor</code> 和 <code>Kitura</code>、<code>Metal</code>、数据结构和算法的 Swift 版、设计模式、Core Data、iOS 动画、Apple 调试和逆向工程、<code>RxSwift</code>、<code>Realm</code>、2D 和 3D 游戏开发等各个方面。</p>]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[八小时Golang学习笔记📒]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/09/02/learn-go</id>
        <link href="https://ahkevinxy.github.io/blog/2023/09/02/learn-go"/>
        <updated>2023-09-02T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[go 语言基础  go语言晋级 如何快速入门 go 语言]]></summary>
        <content type="html"><![CDATA[<p>from <a href="https://www.bilibili.com/video/BV1gf4y1r79E?p=10&amp;vd_source=a86822017d9569c1898827cc698926aa" target="_blank" rel="noopener noreferrer">【8小时转职Golang工程师(如果你想低成本学习Go语言)】</a></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="变量的声明">变量的声明<a href="#变量的声明" class="hash-link" aria-label="变量的声明的直接链接" title="变量的声明的直接链接">​</a></h2><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">package</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"fmt"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 1. 使用 var 声明</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> a </span><span class="token builtin">int</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">a</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 使用 b := 模式 (只能在函数体内使用)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    b </span><span class="token operator" style="color:#393A34">:=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">b</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 3.指定默认值</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> c </span><span class="token builtin">int</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">c</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 4. var 推断模式 (全局变量通常)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> d </span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">d</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 5. 多个变量声明</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> aa </span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">bb</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">cc </span><span class="token builtin">int</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">aa</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">bb</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">cc</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="const-与-iota">const 与 iota<a href="#const-与-iota" class="hash-link" aria-label="const 与 iota的直接链接" title="const 与 iota的直接链接">​</a></h2><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">package</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"fmt"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Bj</span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Sh</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    City </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">iota</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// iota 默认为零</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Ah</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Js</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Sz</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    B </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;&lt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">10</span><span class="token operator" style="color:#393A34">*</span><span class="token boolean" style="color:#36acaa">iota</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    KB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    GB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// error code 错误码应用</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    UserAuthErrorCode </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20000</span><span class="token operator" style="color:#393A34">+</span><span class="token boolean" style="color:#36acaa">iota</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    UserPasswordErrorCode </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> length </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">length</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="golang-中函数多返回值的三种模式">Golang 中函数多返回值的三种模式<a href="#golang-中函数多返回值的三种模式" class="hash-link" aria-label="Golang 中函数多返回值的三种模式的直接链接" title="Golang 中函数多返回值的三种模式的直接链接">​</a></h2><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">package</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">HideName</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// HaveName 会初始化默认值</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">HaveName</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">a </span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> b </span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    a </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    b </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="defer-语句调用顺序">defer 语句调用顺序<a href="#defer-语句调用顺序" class="hash-link" aria-label="defer 语句调用顺序的直接链接" title="defer 语句调用顺序的直接链接">​</a></h2><p>函数结束前的执行的程序</p><p>栈模式  <code>先进先出</code></p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">package</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"fmt"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">a</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">a</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">b</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">b</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">c</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">c</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">defer</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">a</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">defer</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">b</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">defer</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">c</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// c , b, a </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="数组与动态数组">数组与动态数组<a href="#数组与动态数组" class="hash-link" aria-label="数组与动态数组的直接链接" title="数组与动态数组的直接链接">​</a></h2><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">package</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"fmt"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> myArray1 </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">int</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    myArray2 </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">myArray1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">myArray2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="slice">slice<a href="#slice" class="hash-link" aria-label="slice的直接链接" title="slice的直接链接">​</a></h2><ol><li>cap 容量(自动扩容)</li><li>len 长度</li><li>copy 复制</li></ol><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="map-的三种声明定义方式">map 的三种声明定义方式<a href="#map-的三种声明定义方式" class="hash-link" aria-label="map 的三种声明定义方式的直接链接" title="map 的三种声明定义方式的直接链接">​</a></h2><blockquote><p>map 是并发不安全模式</p></blockquote><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">package</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"fmt"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//  声明是初始化 必须开辟空间 不然空指针</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> mp1 </span><span class="token keyword" style="color:#00009f">map</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">string</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mp1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// nil</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 开辟空间</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mp1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">make</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">map</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">//开辟初始 10个容量</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// make 直接生成</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mp2 </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">make</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">map</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mp2</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">"1"</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">"1"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mp2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 初始赋值</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mp3 </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">map</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">"a"</span><span class="token punctuation" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">"1"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mp3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="放射解析结构体标签">放射解析结构体标签<a href="#放射解析结构体标签" class="hash-link" aria-label="放射解析结构体标签的直接链接" title="放射解析结构体标签的直接链接">​</a></h2><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">package</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">"fmt"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">"reflect"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> Resume </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Name </span><span class="token builtin">string</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">`info:"name"`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Sex  </span><span class="token builtin">string</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">`info:"sex"`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">findTag</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">str </span><span class="token keyword" style="color:#00009f">interface</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    t </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> reflect</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">TypeOf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">str</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Elem</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> t</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">NumField</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i</span><span class="token operator" style="color:#393A34">++</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        tagsString </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> t</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Field</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Tag</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"info"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tagsString</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> tags Resume</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">findTag</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tags</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="channel的基本定义与使用">channel的基本定义与使用<a href="#channel的基本定义与使用" class="hash-link" aria-label="channel的基本定义与使用的直接链接" title="channel的基本定义与使用的直接链接">​</a></h2><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">package</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"fmt"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 无缓冲管道</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">make</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">chan</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">go</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">func</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">defer</span><span class="token plain"> fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"stop channel"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// 写入通道</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        c </span><span class="token operator" style="color:#393A34">&lt;-</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">666</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 读取 阻塞</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    num </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;-</span><span class="token plain">c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">defer</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">c</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">num</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="channel-有缓冲和无缓冲">channel 有缓冲和无缓冲<a href="#channel-有缓冲和无缓冲" class="hash-link" aria-label="channel 有缓冲和无缓冲的直接链接" title="channel 有缓冲和无缓冲的直接链接">​</a></h2><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">package</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">"fmt"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">"time"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">make</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">chan</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 获取容量和长度</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"%v %v"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">c</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">cap</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">c</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">go</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">func</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">30</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i</span><span class="token operator" style="color:#393A34">++</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            c </span><span class="token operator" style="color:#393A34">&lt;-</span><span class="token plain"> i</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"%d %d"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">c</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">cap</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">c</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Sleep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Second</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="go" term="go"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[jetbrains 好用的插件]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/09/01/jetbrains</id>
        <link href="https://ahkevinxy.github.io/blog/2023/09/01/jetbrains"/>
        <updated>2023-09-01T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[jetbrains 好用到爆炸的插件  jetbrains 必备插件 jetbrains插件]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="rainbow-brackets">Rainbow Brackets<a href="#rainbow-brackets" class="hash-link" aria-label="Rainbow Brackets的直接链接" title="Rainbow Brackets的直接链接">​</a></h2><p>代码中的匹配中括号添加颜色，使您更轻松地理解嵌套的圆括号</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="one-dark-theme">One Dark Theme<a href="#one-dark-theme" class="hash-link" aria-label="One Dark Theme的直接链接" title="One Dark Theme的直接链接">​</a></h2><p> 好用的主题</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="translation">Translation<a href="#translation" class="hash-link" aria-label="Translation的直接链接" title="Translation的直接链接">​</a></h2><p>翻译</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="atom-material-icons">Atom Material Icons<a href="#atom-material-icons" class="hash-link" aria-label="Atom Material Icons的直接链接" title="Atom Material Icons的直接链接">​</a></h2><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="gittoolbox">GitToolBox<a href="#gittoolbox" class="hash-link" aria-label="GitToolBox的直接链接" title="GitToolBox的直接链接">​</a></h2><p>GitToolBox 扩展了内置的 Git 集成</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="goanno">goanno<a href="#goanno" class="hash-link" aria-label="goanno的直接链接" title="goanno的直接链接">​</a></h2><p>go 语言 优秀的注释插件</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="主题排行"><a href="https://plugins.jetbrains.com/search?orderBy=downloads&amp;tags=Theme" target="_blank" rel="noopener noreferrer">主题排行</a><a href="#主题排行" class="hash-link" aria-label="主题排行的直接链接" title="主题排行的直接链接">​</a></h2>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="jetbrains" term="jetbrains"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[如何安装 go grpc protoc-gen-go-grpc protoc-gen-go]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/08/29/grpc</id>
        <link href="https://ahkevinxy.github.io/blog/2023/08/29/grpc"/>
        <updated>2023-08-29T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[如何指定版本安装 protoc-gen-go   protoc-gen-go-grpc protoc-gen-go protoc]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="安装-protoc">安装 protoc<a href="#安装-protoc" class="hash-link" aria-label="安装 protoc的直接链接" title="安装 protoc的直接链接">​</a></h2><p>打开 <a href="https://github.com/protocolbuffers/protobuf/releases" target="_blank" rel="noopener noreferrer">下载地址protoc</a>
选择需要的版本</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="安装-protoc-gen-go">安装 protoc-gen-go<a href="#安装-protoc-gen-go" class="hash-link" aria-label="安装 protoc-gen-go的直接链接" title="安装 protoc-gen-go的直接链接">​</a></h2><p>打开 <a href="https://pkg.go.dev/google.golang.org/protobuf@v1.25.0/cmd/protoc-gen-go" target="_blank" rel="noopener noreferrer">官方网站</a></p><p>选择需要的版本安装</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 最新版本</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># go install google.golang.org/protobuf/cmd/protoc-gen-go@latest </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 指定版本</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> go </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> google.golang.org/protobuf/cmd/protoc-gen-go@v1.25.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="安装protoc-gen-go-grpc">安装protoc-gen-go-grpc<a href="#安装protoc-gen-go-grpc" class="hash-link" aria-label="安装protoc-gen-go-grpc的直接链接" title="安装protoc-gen-go-grpc的直接链接">​</a></h2><p>打开 <a href="https://google.golang.org/grpc/cmd/protoc-gen-go-grpc" target="_blank" rel="noopener noreferrer">官网</a></p><div class="language-BASH codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-BASH codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">## 安装最新版本</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">go install google.golang.org/grpc/cmd/protoc-gen-go-grpc@latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 指定版本 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">go install google.golang.org/grpc/cmd/protoc-gen-go-grpc@v1.0.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="go" term="go"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[React hook 详解]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/08/26/react-hook</id>
        <link href="https://ahkevinxy.github.io/blog/2023/08/26/react-hook"/>
        <updated>2023-08-26T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[React hook 如何巧妙使用]]></summary>
        <content type="html"><![CDATA[<p>Hook 是react <code>16.8</code> 的新增特性，它可以在不编写class 的情况下使用state 以及其它react 特性</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="hook-优势">hook 优势<a href="#hook-优势" class="hash-link" aria-label="hook 优势的直接链接" title="hook 优势的直接链接">​</a></h2><ul><li>hook 在无需改变组件结构的情况下复用状态逻辑</li><li>hook 将组件中相互关联的部分拆分成更小的函数</li><li>hook 在非class 的情况下可以使用更多的react 特性 </li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="使用规则">使用规则<a href="#使用规则" class="hash-link" aria-label="使用规则的直接链接" title="使用规则的直接链接">​</a></h2><p>Hook 就是<code>javascript</code> </p><ol><li>只能在函数外层调用 hook,不要在循环，条件判断或子函数中调用</li><li>只能在react的函数组件和自定义hook中调用hook</li></ol><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="usestate">useState<a href="#usestate" class="hash-link" aria-label="useState的直接链接" title="useState的直接链接">​</a></h2><p><code>useState</code> 用于在函数组件中调用给组件添加一些内部状态<code>state</code></p><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">state</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">setState</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">useState</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">initialState</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="react" term="react"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[html css 基础]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/08/18/website</id>
        <link href="https://ahkevinxy.github.io/blog/2023/08/18/website"/>
        <updated>2023-08-18T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[html css 入门 如何使用css html]]></summary>
        <content type="html"><![CDATA[<blockquote><p><a href="https://developer.mozilla.org/zh-CN/" target="_blank" rel="noopener noreferrer">mdn</a></p></blockquote><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="不常用文本标签">不常用文本标签<a href="#不常用文本标签" class="hash-link" aria-label="不常用文本标签的直接链接" title="不常用文本标签的直接链接">​</a></h2><div class="playgroundContainer_X_Ta"><div class="playgroundHeader_dyrN">结果</div><div class="playgroundPreview_DzOI"><div>Loading...</div></div><div class="playgroundHeader_dyrN">实时编辑器</div><div class="playgroundEditor_Q6Y7" style="position:relative;text-align:left;box-sizing:border-box;padding:0;overflow:hidden;white-space:pre;font-family:monospace;color:#393A34;background-color:#f6f8fa"><textarea style="margin:0;border:0;background:none;box-sizing:inherit;display:inherit;font-family:inherit;font-size:inherit;font-style:inherit;font-variant-ligatures:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;tab-size:inherit;text-indent:inherit;text-rendering:inherit;text-transform:inherit;white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word;position:absolute;top:0;left:0;height:100%;width:100%;resize:none;color:inherit;overflow:hidden;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;-webkit-text-fill-color:transparent;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px" class="npm__react-simple-code-editor__textarea" autocapitalize="off" autocomplete="off" autocorrect="off" spellcheck="false" data-gramm="false">&lt;html&gt;

&lt;p&gt;
    &lt;cite&gt; 这是一个作品标题&lt;/cite&gt;
&lt;/p&gt;

&lt;p&gt;
    &lt;dfn&gt; 特殊术语&lt;/dfn&gt;
&lt;/p&gt;

&lt;p&gt;
    &lt;del&gt;这是一个删除文本&lt;/del&gt; &lt;ins&gt;插入文本&lt;/ins&gt;
&lt;/p&gt;

&lt;p&gt;
    &lt;code&gt;cosole.log('测试代码')&lt;/code&gt;
&lt;/p&gt;
&lt;p&gt;
    H&lt;sub&gt;2&lt;/sub&gt;O
&lt;/p&gt;

&lt;p&gt;
    8&lt;sup&gt;3&lt;/sup&gt;
&lt;/p&gt;
&lt;p&gt;
    &lt;abbr title="这是一个标题"&gt;大新闻&lt;/abbr&gt; 今天是2023年08月18日
&lt;/p&gt;
&lt;p&gt;
    &lt;small&gt;附属细则&lt;/small&gt; 2002年的第一场雪
&lt;/p&gt;
&lt;/html&gt;
</textarea><pre aria-hidden="true" style="margin:0;border:0;background:none;box-sizing:inherit;display:inherit;font-family:inherit;font-size:inherit;font-style:inherit;font-variant-ligatures:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;tab-size:inherit;text-indent:inherit;text-rendering:inherit;text-transform:inherit;white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word;position:relative;pointer-events:none;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px"><div class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">html</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain-text"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">cite</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"> 这是一个作品标题</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">cite</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain-text"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dfn</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"> 特殊术语</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dfn</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain-text"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">del</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">这是一个删除文本</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">del</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"> </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">ins</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">插入文本</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">ins</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain-text"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">code</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">cosole.log('测试代码')</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">code</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">    H</span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">sub</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">2</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">sub</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">O</span></div><div class="token-line" style="color:#393A34"><span class="token plain-text"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain-text"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">    8</span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">sup</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">3</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">sup</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">abbr</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">title</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag attr-value" style="color:#e3116c">这是一个标题</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">大新闻</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">abbr</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"> 今天是2023年08月18日</span></div><div class="token-line" style="color:#393A34"><span class="token plain-text"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">small</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">附属细则</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">small</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"> 2002年的第一场雪</span></div><div class="token-line" style="color:#393A34"><span class="token plain-text"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">html</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div></pre><style>
/**
 * Reset the text fill color so that placeholder is visible
 */
.npm__react-simple-code-editor__textarea:empty {
  -webkit-text-fill-color: inherit !important;
}

/**
 * Hack to apply on some CSS on IE10 and IE11
 */
@media all and (-ms-high-contrast: none), (-ms-high-contrast: active) {
  /**
    * IE doesn't support '-webkit-text-fill-color'
    * So we use 'color: transparent' to make the text transparent on IE
    * Unlike other browsers, it doesn't affect caret color in IE
    */
  .npm__react-simple-code-editor__textarea {
    color: transparent !important;
  }

  .npm__react-simple-code-editor__textarea::selection {
    background-color: #accef7 !important;
    color: transparent !important;
  }
}
</style></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="超链接">超链接<a href="#超链接" class="hash-link" aria-label="超链接的直接链接" title="超链接的直接链接">​</a></h2><ol><li>跳转页面</li><li>跳转锚点</li><li>唤醒指定应用</li></ol><div class="playgroundContainer_X_Ta"><div class="playgroundHeader_dyrN">结果</div><div class="playgroundPreview_DzOI"><div>Loading...</div></div><div class="playgroundHeader_dyrN">实时编辑器</div><div class="playgroundEditor_Q6Y7" style="position:relative;text-align:left;box-sizing:border-box;padding:0;overflow:hidden;white-space:pre;font-family:monospace;color:#393A34;background-color:#f6f8fa"><textarea style="margin:0;border:0;background:none;box-sizing:inherit;display:inherit;font-family:inherit;font-size:inherit;font-style:inherit;font-variant-ligatures:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;tab-size:inherit;text-indent:inherit;text-rendering:inherit;text-transform:inherit;white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word;position:absolute;top:0;left:0;height:100%;width:100%;resize:none;color:inherit;overflow:hidden;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;-webkit-text-fill-color:transparent;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px" class="npm__react-simple-code-editor__textarea" autocapitalize="off" autocomplete="off" autocorrect="off" spellcheck="false" data-gramm="false">&lt;html lang="zh"&gt;



&lt;body&gt;
&lt;p&gt;
    &lt;a href="http://ahKevinXy.github.io" target="_blank"&gt;跳转自己blog&lt;/a&gt;
&lt;/p&gt;
&lt;p&gt;
    &lt;a href="#不常用文本标签"&gt;去头部&lt;/a&gt;
&lt;/p&gt;
&lt;p&gt;
    &lt;a href="mailto:ahkevinxy.gmail.com"&gt;去发邮件&lt;/a&gt;
&lt;/p&gt;
&lt;p&gt;
    
&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;</textarea><pre aria-hidden="true" style="margin:0;border:0;background:none;box-sizing:inherit;display:inherit;font-family:inherit;font-size:inherit;font-style:inherit;font-variant-ligatures:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;tab-size:inherit;text-indent:inherit;text-rendering:inherit;text-transform:inherit;white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word;position:relative;pointer-events:none;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px"><div class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">html</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">lang</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag attr-value" style="color:#e3116c">zh</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain-text" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain-text" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain-text"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">body</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">a</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">href</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag attr-value" style="color:#e3116c">http://ahKevinXy.github.io</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">target</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag attr-value" style="color:#e3116c">_blank</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">跳转自己blog</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">a</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">a</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">href</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag attr-value" style="color:#e3116c">#不常用文本标签</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">去头部</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">a</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">a</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">href</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag attr-value" style="color:#e3116c">mailto:ahkevinxy.gmail.com</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">去发邮件</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">a</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">    </span></div><div class="token-line" style="color:#393A34"><span class="token plain-text"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">body</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">html</span><span class="token tag punctuation" style="color:#393A34">&gt;</span></div></pre><style>
/**
 * Reset the text fill color so that placeholder is visible
 */
.npm__react-simple-code-editor__textarea:empty {
  -webkit-text-fill-color: inherit !important;
}

/**
 * Hack to apply on some CSS on IE10 and IE11
 */
@media all and (-ms-high-contrast: none), (-ms-high-contrast: active) {
  /**
    * IE doesn't support '-webkit-text-fill-color'
    * So we use 'color: transparent' to make the text transparent on IE
    * Unlike other browsers, it doesn't affect caret color in IE
    */
  .npm__react-simple-code-editor__textarea {
    color: transparent !important;
  }

  .npm__react-simple-code-editor__textarea::selection {
    background-color: #accef7 !important;
    color: transparent !important;
  }
}
</style></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="列表">列表<a href="#列表" class="hash-link" aria-label="列表的直接链接" title="列表的直接链接">​</a></h2><div class="playgroundContainer_X_Ta"><div class="playgroundHeader_dyrN">结果</div><div class="playgroundPreview_DzOI"><div>Loading...</div></div><div class="playgroundHeader_dyrN">实时编辑器</div><div class="playgroundEditor_Q6Y7" style="position:relative;text-align:left;box-sizing:border-box;padding:0;overflow:hidden;white-space:pre;font-family:monospace;color:#393A34;background-color:#f6f8fa"><textarea style="margin:0;border:0;background:none;box-sizing:inherit;display:inherit;font-family:inherit;font-size:inherit;font-style:inherit;font-variant-ligatures:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;tab-size:inherit;text-indent:inherit;text-rendering:inherit;text-transform:inherit;white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word;position:absolute;top:0;left:0;height:100%;width:100%;resize:none;color:inherit;overflow:hidden;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;-webkit-text-fill-color:transparent;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px" class="npm__react-simple-code-editor__textarea" autocapitalize="off" autocomplete="off" autocorrect="off" spellcheck="false" data-gramm="false">
&lt;div&gt;
    &lt;div&gt;
        &lt;span&gt;无序列表&lt;/span&gt;
    &lt;ul&gt;
        &lt;li&gt;1&lt;/li&gt;
        &lt;li&gt;2&lt;/li&gt;
        &lt;li&gt;3&lt;/li&gt;
    &lt;/ul&gt;
    &lt;/div&gt;
    &lt;div&gt;
        &lt;span&gt;有序列表&lt;/span&gt;
    &lt;ol&gt;
        &lt;li&gt;1&lt;/li&gt;
        &lt;li&gt;3&lt;/li&gt;
        &lt;li&gt;4&lt;/li&gt;
        &lt;li&gt;5&lt;/li&gt;
    &lt;/ol&gt;
    &lt;/div&gt;
    &lt;div&gt;
        &lt;span&gt;自定义列表&lt;/span&gt;
        &lt;dl&gt;
            &lt;dt&gt;📒笔记&lt;/dt&gt;
            &lt;dd&gt;这是一个简单的笔记&lt;/dd&gt;
            &lt;dd&gt;也可以是电子版也是纸质版&lt;/dd&gt;
            &lt;dt&gt;✈️起飞&lt;/dt&gt;
            &lt;dd&gt;这是一个简单的起飞&lt;/dd&gt;
        &lt;/dl&gt;
    &lt;/div&gt;
&lt;/div&gt;</textarea><pre aria-hidden="true" style="margin:0;border:0;background:none;box-sizing:inherit;display:inherit;font-family:inherit;font-size:inherit;font-style:inherit;font-variant-ligatures:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;tab-size:inherit;text-indent:inherit;text-rendering:inherit;text-transform:inherit;white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word;position:relative;pointer-events:none;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px"><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">span</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">无序列表</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">span</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">ul</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">li</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">1</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">li</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">li</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">2</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">li</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">li</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">3</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">li</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">ul</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">span</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">有序列表</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">span</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">ol</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">li</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">1</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">li</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">li</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">3</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">li</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">li</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">4</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">li</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">li</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">5</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">li</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">ol</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">span</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">自定义列表</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">span</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dl</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dt</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">📒笔记</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dt</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dd</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">这是一个简单的笔记</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dd</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dd</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">也可以是电子版也是纸质版</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dd</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dt</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">✈️起飞</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dt</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dd</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">这是一个简单的起飞</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dd</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dl</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span></div></pre><style>
/**
 * Reset the text fill color so that placeholder is visible
 */
.npm__react-simple-code-editor__textarea:empty {
  -webkit-text-fill-color: inherit !important;
}

/**
 * Hack to apply on some CSS on IE10 and IE11
 */
@media all and (-ms-high-contrast: none), (-ms-high-contrast: active) {
  /**
    * IE doesn't support '-webkit-text-fill-color'
    * So we use 'color: transparent' to make the text transparent on IE
    * Unlike other browsers, it doesn't affect caret color in IE
    */
  .npm__react-simple-code-editor__textarea {
    color: transparent !important;
  }

  .npm__react-simple-code-editor__textarea::selection {
    background-color: #accef7 !important;
    color: transparent !important;
  }
}
</style></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="表格">表格<a href="#表格" class="hash-link" aria-label="表格的直接链接" title="表格的直接链接">​</a></h2><div class="playgroundContainer_X_Ta"><div class="playgroundHeader_dyrN">结果</div><div class="playgroundPreview_DzOI"><div>Loading...</div></div><div class="playgroundHeader_dyrN">实时编辑器</div><div class="playgroundEditor_Q6Y7" style="position:relative;text-align:left;box-sizing:border-box;padding:0;overflow:hidden;white-space:pre;font-family:monospace;color:#393A34;background-color:#f6f8fa"><textarea style="margin:0;border:0;background:none;box-sizing:inherit;display:inherit;font-family:inherit;font-size:inherit;font-style:inherit;font-variant-ligatures:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;tab-size:inherit;text-indent:inherit;text-rendering:inherit;text-transform:inherit;white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word;position:absolute;top:0;left:0;height:100%;width:100%;resize:none;color:inherit;overflow:hidden;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;-webkit-text-fill-color:transparent;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px" class="npm__react-simple-code-editor__textarea" autocapitalize="off" autocomplete="off" autocorrect="off" spellcheck="false" data-gramm="false">
&lt;div&gt;
    &lt;table border="10" &gt;
        &lt;caption&gt;学生信息&lt;/caption&gt;
        &lt;thead&gt;
        &lt;tr&gt;
        &lt;td&gt;序号&lt;/td&gt;
        &lt;td&gt;姓名&lt;/td&gt;
        &lt;td&gt;性别&lt;/td&gt;
        &lt;td&gt;年龄&lt;/td&gt;
        &lt;/tr&gt;
        &lt;/thead&gt;
        &lt;tbody&gt;
        &lt;tr&gt;
            &lt;td&gt;1&lt;/td&gt;
            &lt;td&gt;张三&lt;/td&gt;
            &lt;td&gt;男&lt;/td&gt;
            &lt;td&gt;18&lt;/td&gt;
        &lt;/tr&gt;
        &lt;/tbody&gt;
        &lt;tr&gt;
            &lt;td&gt;&lt;/td&gt;
            &lt;td&gt;&lt;/td&gt;
            &lt;td&gt;&lt;/td&gt;
           
          
            &lt;td&gt;总计: 1&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tfoot&gt;
   
        &lt;/tfoot&gt;
    &lt;/table&gt;
&lt;/div&gt;
</textarea><pre aria-hidden="true" style="margin:0;border:0;background:none;box-sizing:inherit;display:inherit;font-family:inherit;font-size:inherit;font-style:inherit;font-variant-ligatures:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;tab-size:inherit;text-indent:inherit;text-rendering:inherit;text-transform:inherit;white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word;position:relative;pointer-events:none;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px"><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">table</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">border</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag attr-value" style="color:#e3116c">10</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">caption</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">学生信息</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">caption</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">thead</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">tr</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">td</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">序号</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">td</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">td</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">姓名</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">td</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">td</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">性别</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">td</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">td</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">年龄</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">td</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">tr</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">thead</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">tbody</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">tr</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">td</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">1</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">td</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">td</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">张三</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">td</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">td</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">男</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">td</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">td</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">18</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">td</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">tr</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">tbody</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">tr</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">td</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">td</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">td</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">td</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">td</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">td</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">           </span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">          </span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">td</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">总计: 1</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">td</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">tr</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">tfoot</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">   </span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">tfoot</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">table</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div></pre><style>
/**
 * Reset the text fill color so that placeholder is visible
 */
.npm__react-simple-code-editor__textarea:empty {
  -webkit-text-fill-color: inherit !important;
}

/**
 * Hack to apply on some CSS on IE10 and IE11
 */
@media all and (-ms-high-contrast: none), (-ms-high-contrast: active) {
  /**
    * IE doesn't support '-webkit-text-fill-color'
    * So we use 'color: transparent' to make the text transparent on IE
    * Unlike other browsers, it doesn't affect caret color in IE
    */
  .npm__react-simple-code-editor__textarea {
    color: transparent !important;
  }

  .npm__react-simple-code-editor__textarea::selection {
    background-color: #accef7 !important;
    color: transparent !important;
  }
}
</style></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="html-字符实体">html 字符实体<a href="#html-字符实体" class="hash-link" aria-label="html 字符实体的直接链接" title="html 字符实体的直接链接">​</a></h2><ul><li><code>&amp;nbsp;</code> 空格</li><li><code>&amp;lt;</code> <code>&lt;</code> </li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="html-全局属性">html 全局属性<a href="#html-全局属性" class="hash-link" aria-label="html 全局属性的直接链接" title="html 全局属性的直接链接">​</a></h2><ul><li><code>id</code>  给标签指定唯一标识</li><li><code>class</code> 可以然标签相关联</li><li><code>style</code> 给标签加样式</li><li><code>dir</code> 内容方向</li><li><code>title</code> 给标签设置文字提示 图片和超链接 多</li></ul>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="基础" term="基础"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[google  浏览器快捷键]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/08/12/chrome</id>
        <link href="https://ahkevinxy.github.io/blog/2023/08/12/chrome"/>
        <updated>2023-08-12T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[google 浏览器快捷键大全 如何使用谷歌浏览器]]></summary>
        <content type="html"><![CDATA[<ol><li><code>Ctrl+N</code> 打开新窗口</li><li><code>Ctrl+T</code> 打开新标签页</li><li><code>Ctrl+Shift+N</code> 在隐身模式下打开新窗口。</li><li><code>Ctrl+O</code>，然后选择文件。 在 Google Chrome 浏览器中打开计算机中的文件。</li><li><code>Ctrl+Shift+T</code> 重新打开上次关闭的标签页。Google Chrome 浏览器可记住最近关闭的 10 个标签页。</li><li><code>Ctrl+1</code> 到 <code>Ctrl+8</code> 切换到标签栏中指定位置编号所对应的标签页。</li><li><code>Ctrl+9</code> 切换到最后一个标签页。</li><li><code>Ctrl+Tab</code> 或 <code>Ctrl+PgDown</code> 切换到下一个标签页。</li><li><code>Ctrl+Shift+Tab</code> 或 <code>Ctrl+PgUp</code> 切换到上一个标签页。</li><li><code>Alt+F4</code> 关闭当前窗口。</li><li><code>Ctrl+W</code> 或 <code>Ctrl+F4</code> 关闭当前标签页或弹出窗口。</li><li>用鼠标中键(或鼠标滚轮)点击标签页。 关闭所点击的标签页。</li><li>按 <code>Backspace</code> 键，或同时按 <code>Alt</code> 和向左箭头键。 转到当前标签页的上一页浏览历史记录。</li><li>按 <code>Shift+Backspace</code>，或同时按 <code>Alt</code>和向右箭头键。 转到当前标签页的下一页浏览历史记录。</li><li><code>Alt+Home</code> 在当前窗口打开主页。</li><li><code>Ctrl+Shift+J</code> <strong>打开开发人员工具</strong>。</li><li><code>Ctrl+Shift+Delete</code> <strong>打开“清除浏览数据”对话框</strong>。</li><li>或 <code>Ctrl+L</code> 或 <code>Alt+D</code> 突出显示网址。</li><li><code>Ctrl+P</code> 打印当前网页。</li><li><code>Ctrl+S</code> 保存当前网页。</li><li><code>F5</code> 或 <code>Ctrl+R</code> 重新载入当前网页。</li><li><code>Esc</code> 停止载入当前网页</li><li><code>Ctrl+F</code> 打开查找栏。</li><li><code>Ctrl+G</code> 或 <code>F3</code> 在查找栏中查找下一条与输入内容相匹配的内容。</li><li><code>Ctrl+Shift+G</code>、<code>Shift+F3</code> 或<code>Shift+Enter</code> 在查找栏中查找上一条与输入内容相匹配的内容。</li><li>点击鼠标中键(或鼠标滚轮)。 激活自动滚动模式。当您移动鼠标时，网页会根据鼠标的移动方向自动滚动。</li><li><code>Ctrl+F5</code> 或 <code>Shift+F5</code> 重新载入当前网页，忽略缓存的内容</li><li>按住 <code>Alt</code> 键，然后点击链接。 下载链接目标。</li><li><code>Ctrl+U</code> 打开当前网页的源代码</li><li>将链接拖到书签栏中 将链接保存为书签。</li><li><code>Ctrl+D</code> 将当前网页保存为书签</li><li><code>Ctrl+Shift+D</code> 将所有打开的网页以书签的形式保存在新文件夹中</li><li><code>Ctrl+C</code> 将突出显示的内容复制到剪贴板中。 </li><li><code>Ctrl+V</code> 或 <code>Shift+Insert</code> 从剪贴板中粘贴内容。 </li><li><code>Ctrl+Shift+V</code> 从剪贴板中粘贴内容(不带格式)。 </li><li><code>Ctrl+X</code> <code>或 Shift+Delete</code> 删除突出显示的内容并将其复制到剪贴板中。 </li><li>F11 在全屏模式下打开网页。再按一次F11 可退出全屏模式。 </li><li>Ctrl++，或者按住 Ctrl 键并且向上滚动鼠标滚轮。 放大网页上的所有内容。 </li><li>Ctrl+-，或者按住 Ctrl 键并且向下滚动鼠标滚轮。 缩小网页上的所有内容。 </li><li>Ctrl+0 将网页上的所有内容都恢复到正常大小。 </li><li>空格键 向下滚动网页。 </li><li>Home 转至网页顶部。 </li><li>End 转至网页底部。 </li><li>按住 Shift 键的同时滚动鼠标滚轮。 在网页上横向滚动。</li></ol>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="google" term="google"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Electron 入门]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/08/12/electron</id>
        <link href="https://ahkevinxy.github.io/blog/2023/08/12/electron"/>
        <updated>2023-08-12T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[如何使用 electron 构建属于自己的 桌面应用]]></summary>
        <content type="html"><![CDATA[<p>Electron是由Github开发的开源框架，它允许开发者使用Web技术构建跨平台的桌面应用。Electron=Chromium+Node.js+Native API，其中Chromium为Electron提供了强大的UI能力，可以不考虑兼容性的情况下，利用强大的Web生态来开发界面；Native API让Electron有了跨平台和桌面端的原生能力，比如说它有统一的原生界面，窗口、托盘这些</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="electron-工作流">electron 工作流<a href="#electron-工作流" class="hash-link" aria-label="electron 工作流的直接链接" title="electron 工作流的直接链接">​</a></h2><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="启动流程">启动流程<a href="#启动流程" class="hash-link" aria-label="启动流程的直接链接" title="启动流程的直接链接">​</a></h2><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="相关属于说明">相关属于说明<a href="#相关属于说明" class="hash-link" aria-label="相关属于说明的直接链接" title="相关属于说明的直接链接">​</a></h2><p>主进程</p><ul><li><code>package.json</code> 中 main 属性对应的文件</li><li>一个应用只会有一个主进程</li><li>只有主进程可以进行 gui的api 操作 </li></ul><p>渲染进程</p><ul><li>windows 中展示的界面提供渲染进程表现</li><li>一个应用可以有多个渲染进程</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="环境搭建">环境搭建<a href="#环境搭建" class="hash-link" aria-label="环境搭建的直接链接" title="环境搭建的直接链接">​</a></h2><blockquote><p>工具</p></blockquote><ol><li>vscode</li><li>命令行工具</li><li>git </li><li>node </li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#在x64机器上安装ia32位版本</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">npm</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> --arch</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">ia32 electron</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 使用 --platform 来指定开发平台 (例如, win32、linux 等):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">npm</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> --platform</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">win32 electron</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>设置 中国代理</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token assign-left variable" style="color:#36acaa">ELECTRON_MIRROR</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">"https://npmmirror.com/mirrors/electron/"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>跳过 二进制下载</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token assign-left variable" style="color:#36acaa">ELECTRON_SKIP_BINARY_DOWNLOAD</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">yarn</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="electron-生命周期">Electron 生命周期<a href="#electron-生命周期" class="hash-link" aria-label="Electron 生命周期的直接链接" title="Electron 生命周期的直接链接">​</a></h2><ul><li>ready:app 初始化完成</li><li>dom-ready 一个窗口中的文本加载完成</li><li>did-finish-load 导航完成时触发</li><li>window-all-closed 所有窗口都被关闭时触发</li><li>before-quit 在关闭窗口之前触发</li><li>will-quit 在窗口关闭并且应用退出时触发</li><li>quit 当窗口关闭时触发 此时删除窗口引用</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="创建项目">创建项目<a href="#创建项目" class="hash-link" aria-label="创建项目的直接链接" title="创建项目的直接链接">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="初始化应用">初始化应用<a href="#初始化应用" class="hash-link" aria-label="初始化应用的直接链接" title="初始化应用的直接链接">​</a></h3><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">npm</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Yarn</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># npm </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">npm</span><span class="token plain"> init</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># yarn</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">yarn</span><span class="token plain"> init</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># npm </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># couldn't auto-convert command</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">yarn</span><span class="token plain"> init</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># yarn</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">yarn</span><span class="token plain"> init</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><p> 添加 electron DEVDEPENDENCY</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>信息</div><div class="admonitionContent_S0QG"><p> 应用需要运行 Electron API，因此这听上去可能有点反直觉。 实际上，打包后的应用本身会包含 Electron 的二进制文件，因此不需要将 Electron 作为生产环境依赖。</p></div></div><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">npm</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Yarn</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># npm </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">npm</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> electron --save-dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># yarn </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">yarn</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"> electron --dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># npm </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># couldn't auto-convert command</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">yarn</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"> electron --dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># yarn </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">yarn</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"> electron --dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="导入模块">导入模块<a href="#导入模块" class="hash-link" aria-label="导入模块的直接链接" title="导入模块的直接链接">​</a></h3><ul><li>app 应用程序的事件生命周期</li><li>BrowerWindow 负责创建和管理应用窗口</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="使用预加载脚本">使用预加载脚本<a href="#使用预加载脚本" class="hash-link" aria-label="使用预加载脚本的直接链接" title="使用预加载脚本的直接链接">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="什么是预加载脚本">什么是预加载脚本<a href="#什么是预加载脚本" class="hash-link" aria-label="什么是预加载脚本的直接链接" title="什么是预加载脚本的直接链接">​</a></h3><p>Electron 的主进程是 一个拥有着完全操作系统访问权限的 Node.js 环境。 除了 Electron 模组 之外，您也可以访问 Node.js 内置模块 和所有通过 npm 安装的包。 另一方面，出于安全原因，渲染进程默认跑在网页页面上，而并非 Node.js里。</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="在进程之间通信">在进程之间通信<a href="#在进程之间通信" class="hash-link" aria-label="在进程之间通信的直接链接" title="在进程之间通信的直接链接">​</a></h3><p> 可以使用 Electron 的 ipcMain 模块和 ipcRenderer 模块来进行进程间通信</p>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="Go" term="Go"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Go  File 处理]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/08/08/go-file</id>
        <link href="https://ahkevinxy.github.io/blog/2023/08/08/go-file"/>
        <updated>2023-08-08T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[go 如何读取文件 如何生成文件  go 文件处理方法合集 go 如何大文件读取  如何固定长度读取]]></summary>
        <content type="html"><![CDATA[<p><img loading="lazy" src="https://source.unsplash.com/random?nature&amp;21" alt="预览图" class="img_ev3q"></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="osreadfile-指定文件读取文件"><code>os.ReadFile</code> 指定文件读取文件<a href="#osreadfile-指定文件读取文件" class="hash-link" aria-label="osreadfile-指定文件读取文件的直接链接" title="osreadfile-指定文件读取文件的直接链接">​</a></h2><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">package</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">"fmt"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">"os"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fileName </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"test.txt"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    content</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">ReadFile</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fileName</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">string</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">content</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ioutilreadfile-读取文件"><code>ioutil.ReadFile</code> 读取文件<a href="#ioutilreadfile-读取文件" class="hash-link" aria-label="ioutilreadfile-读取文件的直接链接" title="ioutilreadfile-读取文件的直接链接">​</a></h2><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">package</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">"fmt"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">"io/ioutil"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fileName </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"test.txt"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    content</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> ioutil</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">ReadFile</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fileName</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">string</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">content</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="osopen-通过句柄打开文件"><code>os.Open</code> 通过句柄打开文件<a href="#osopen-通过句柄打开文件" class="hash-link" aria-label="osopen-通过句柄打开文件的直接链接" title="osopen-通过句柄打开文件的直接链接">​</a></h2><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">package</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">"fmt"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">"io/ioutil"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">"os"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fileName </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"test.txt"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    file</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fileName</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">defer</span><span class="token plain"> file</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    content</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> ioutil</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">ReadAll</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">file</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">!=</span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">string</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">content</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="osopenfile-打开文件"><code>os.OpenFile</code> 打开文件<a href="#osopenfile-打开文件" class="hash-link" aria-label="osopenfile-打开文件的直接链接" title="osopenfile-打开文件的直接链接">​</a></h2><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">package</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">"fmt"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">"os"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fileName </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"test.txt"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//  If the file does not exist, and the O_CREATE flag</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// flag：文件的打开方式，如只读、只写、读写等</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//文件的读写权限 </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    file</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">OpenFile</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fileName</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">O_RDONLY</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">defer</span><span class="token plain"> file</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    content</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> ioutil</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">ReadAll</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">file</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">!=</span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">string</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">content</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="切片读取文件-按照行读取">切片读取文件 按照行读取<a href="#切片读取文件-按照行读取" class="hash-link" aria-label="切片读取文件 按照行读取的直接链接" title="切片读取文件 按照行读取的直接链接">​</a></h2><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">package</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">"bufio"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">"fmt"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">"io"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">"os"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">"strings"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fileName </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"test.txt"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    file</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fileName</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">defer</span><span class="token plain"> file</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 解决 content 文件过大导致</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// content, err := ioutil.ReadAll(file)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    r </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> bufio</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">NewReader</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">file</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        lineBytes</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> r</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">ReadBytes</span><span class="token punctuation" style="color:#393A34">(</span><span class="token char">'\n'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        line </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> strings</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">TrimSpace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">string</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">lineBytes</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> io</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">EOF </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> io</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">EOF </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">break</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">line</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="按照固定长度读取">按照固定长度读取<a href="#按照固定长度读取" class="hash-link" aria-label="按照固定长度读取的直接链接" title="按照固定长度读取的直接链接">​</a></h2><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">package</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">"bufio"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">"fmt"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">"io"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">"os"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    file</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"test.txt"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    r </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> bufio</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">NewReader</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">file</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    buf </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">make</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">byte</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1024</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        n</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> r</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Read</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">buf</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> io</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">EOF </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> n </span><span class="token operator" style="color:#393A34">==</span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">break</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">string</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">buf</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">n</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="使用syscall-库">使用<code>syscall</code> 库<a href="#使用syscall-库" class="hash-link" aria-label="使用syscall-库的直接链接" title="使用syscall-库的直接链接">​</a></h2><p>会每次读取  100 字节的数据，并发送到通道中，由另外一个协程进行读取并打印出来</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">package</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">"fmt"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">"sync"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">"syscall"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fd</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> syscall</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"christmas_apple.py"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> syscall</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">O_RDONLY</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"Failed on open: "</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">defer</span><span class="token plain"> syscall</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fd</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> wg sync</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">WaitGroup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    wg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dataChan </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">make</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">chan</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">byte</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">go</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">func</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        wg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Done</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            data </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">make</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">byte</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            n</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">_</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> syscall</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Read</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fd</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> n </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">break</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            dataChan </span><span class="token operator" style="color:#393A34">&lt;-</span><span class="token plain"> data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dataChan</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">go</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">func</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">defer</span><span class="token plain"> wg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Done</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ok </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;-</span><span class="token plain">dataChan</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!</span><span class="token plain">ok </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">string</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">default</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    wg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Wait</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="Go" term="Go"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Go  json 处理]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/08/08/go-json</id>
        <link href="https://ahkevinxy.github.io/blog/2023/08/08/go-json"/>
        <updated>2023-08-08T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[go 如何读取json 文件 如何生成文件 如何解析json 文件]]></summary>
        <content type="html"><![CDATA[<p><img loading="lazy" src="https://source.unsplash.com/random?nature&amp;24" alt="预览图" class="img_ev3q"></p><p>go  json 文件处理 生成json 文件</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">"name"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"张三"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">package</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">"fmt"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">"os"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> UserInfo </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Name </span><span class="token builtin">string</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">`json:"name"`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 读取文件</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    file</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">ReadFile</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"main.json"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> u UserInfo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 序列化文件</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">=</span><span class="token plain">json</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Unmarshal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">file</span><span class="token punctuation" style="color:#393A34">,</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">u</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">err </span><span class="token operator" style="color:#393A34">!=</span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">u</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="Go" term="Go"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Go select 学习]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/08/08/go-select</id>
        <link href="https://ahkevinxy.github.io/blog/2023/08/08/go-select"/>
        <updated>2023-08-08T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[如何使用 go select]]></summary>
        <content type="html"><![CDATA[<p><img loading="lazy" src="https://source.unsplash.com/random?nature&amp;22" alt="预览图" class="img_ev3q">
在 Go 语言内 <code>select</code> 是一个关键字,用于监听 和<code>channel</code> 有关的IO 操作</p><p>通过 <code>select</code> 语句,可以同时监听多个channel,并在其中任意一个<code>channel</code> 就绪时进行处理</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="基本语法">基本语法<a href="#基本语法" class="hash-link" aria-label="基本语法的直接链接" title="基本语法的直接链接">​</a></h2><p><code>select</code> 语句基本语法:</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;-</span><span class="token plain">channel1</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// do channel1 逻辑</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> data</span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;-</span><span class="token plain">channel2</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 通过channel 就绪时候处理</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">default</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 没有任何通道就绪时进行处理</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>语法类型 <code>switch</code> 相识</p><p><code>switch</code> 用于条件判断 而 <code>select</code> 用于通道操作.不能在<code>select</code>语句中使用任意类型的条件表达式只能对通道进行操作</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="使用规则">使用规则<a href="#使用规则" class="hash-link" aria-label="使用规则的直接链接" title="使用规则的直接链接">​</a></h2><ol><li><code>select</code> 语句只能使用过程中,用于多个通道之间进行选择,以监听通道的就绪昨天,而不是用于其它类型的条件判断</li><li><code>select</code> 语句可以保护多个<code>case</code>语句,每个<code>case</code>子句对应一个通道操作,当其中任意一个通道就绪时,相应的<code>case</code> 子句将会执行</li><li>如果多个通路都就绪,<code>select</code> 语句会随机一个通道执行,这样保证多个通道公平竞争</li><li><code>select</code> 语句的执行可能是阻塞,也可以是非阻塞.如果没有任何一个通道就绪没有默认的 <code>default</code> 子句,<code>select</code> 语句会阻塞,直到有一个通道来执行,如果没有任何一个通道就绪且没有默认的<code>default</code>子句,<code>select</code> 语句会阻塞,直到一个通道就绪.如果有<code>default</code> 子句,且没有任何通道就绪,那么<code>select</code> 语句会执行<code>default</code> 子句，从而避免阻塞。</li></ol><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="多路复用">多路复用<a href="#多路复用" class="hash-link" aria-label="多路复用的直接链接" title="多路复用的直接链接">​</a></h2><p><code>select</code> 最常见的用途之一，同时监听多个通道，并根据它们的就绪状态执行不同的操作。</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">package</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">"fmt"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">"time"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c1 </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">make</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">chan</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c2 </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">make</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">chan</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">go</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">func</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Sleep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Second</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        c1 </span><span class="token operator" style="color:#393A34">&lt;-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"one"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">go</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">func</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Sleep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Second</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        c2 </span><span class="token operator" style="color:#393A34">&lt;-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"two"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> msg </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;-</span><span class="token plain">c1</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">msg</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> msg </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;-</span><span class="token plain">c2</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">msg</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>执行上面的代码，程序会随机打印 one 或者 two，如果通道为空的话，程序就会一直阻塞在那里。</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="非阻塞通信">非阻塞通信<a href="#非阻塞通信" class="hash-link" aria-label="非阻塞通信的直接链接" title="非阻塞通信的直接链接">​</a></h2><p>当通道中没有数据可读或者没有缓冲空间可写时，普通的读写操作将会阻塞。</p><p>但通过 <code>select</code> 语句，我们可以在没有数据就绪时执行默认的逻辑，避免程序陷入无限等待状态。</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">package</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">"fmt"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    channel </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">make</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">chan</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> data </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;-</span><span class="token plain">channel</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"Received:"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">default</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"No data available."</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>执行上面代码，程序会执行 default 分支。</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="超时处理">超时处理<a href="#超时处理" class="hash-link" aria-label="超时处理的直接链接" title="超时处理的直接链接">​</a></h2><p>通过结合 <code>select</code> 和 <code>time.After</code> 函数，我们可以在指定时间内等待通道就绪，超过时间后执行相应的逻辑。</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">package</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">"fmt"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">"time"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    channel </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">make</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">chan</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> data </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;-</span><span class="token plain">channel</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"Received:"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;-</span><span class="token plain">time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">After</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Second</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"Timeout occurred."</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>执行上面代码，如果 <code>channel</code> 在 3 秒内没有数据可读，<code>select</code> 会执行 <code>time.After</code> 分支。</p>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="Go" term="Go"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[JVM常用命令]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/08/01/jvm-0801</id>
        <link href="https://ahkevinxy.github.io/blog/2023/08/01/jvm-0801"/>
        <updated>2023-08-01T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[JVM常用命令]]></summary>
        <content type="html"><![CDATA[<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="jvm常用命令">JVM常用命令<a href="#jvm常用命令" class="hash-link" aria-label="JVM常用命令的直接链接" title="JVM常用命令的直接链接">​</a></h3><p><img loading="lazy" src="https://source.unsplash.com/random?nature&amp;19" alt="预览图" class="img_ev3q"></p><ul><li>lsof -i:8902  <strong>查看端口8902对应应用的pid</strong></li><li>jstat -class PID  <strong>类加载统计</strong></li><li>jstat -compiler PID   <strong>编译统计</strong></li><li>jstat -gc PID <strong>垃圾回收统计</strong></li><li>jstat -gccapacity PID  <strong>堆内存统计</strong></li><li>jstat -gcutil PID <strong>查看堆比例</strong></li><li>jstat -gccause PID <strong>GC的原因</strong></li><li>jstat -gcnew PID <strong>新生代垃圾回收统计</strong></li><li>jstat -gcnewcapacity PID <strong>新生代内存统计</strong></li><li>jstat -gcold PID <strong>老年代垃圾回收统计</strong></li><li>jstat -gcoldcapcacity PID <strong>老年代内存统计</strong></li><li>jstat -gcmetacapacity PID <strong>元数据空间统计</strong></li><li>jstat -printcompilation PID <strong>JVM编译方法统计</strong></li><li>jmap -histo PID <strong>查看类的实例</strong></li><li>jmap -heap PID <strong>查看堆栈信息</strong></li><li>jmap -dump:live,format=b,file=/tmp/m.hprof PID <strong>保存内存的堆栈为文件</strong></li><li>jhat -J-Xmx2048m -port 5000 /tmp/m.hprof <strong>在线查看堆文件的类，速度比较慢</strong></li><li>jcmd PID GC.run <strong>强制gc</strong></li></ul>]]></content>
        <author>
            <name>flankx</name>
            <email>137472591@qq.com</email>
            <uri>https://github.com/flankx</uri>
        </author>
        <category label="JVM" term="JVM"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Hash 冲突解决方法]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/07/27/hash-1</id>
        <link href="https://ahkevinxy.github.io/blog/2023/07/27/hash-1"/>
        <updated>2023-07-27T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Hash 冲突 java 如何解决 Hash冲突]]></summary>
        <content type="html"><![CDATA[<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="hash-冲突解决方法"><code>Hash</code> 冲突解决方法<a href="#hash-冲突解决方法" class="hash-link" aria-label="hash-冲突解决方法的直接链接" title="hash-冲突解决方法的直接链接">​</a></h3><ol><li><p>开放定址法
这种方法也称再散列法，其基本思想是：当关键字key的哈希地址p=H（key）出现冲突时，以p为基础，产生另一个哈希地址p1，如果p1仍然冲突，再以p为基础，产生另一个哈希地址p2，…，直到找出一个不冲突的哈希地址pi&nbsp;，将相应元素存入其中。这种方法有一个通用的再散列函数形式：
Hi=（H（key）+di）% m&nbsp;&nbsp; i=1，2，…，n</p></li><li><p>再哈希法
这种方法是同时构造多个不同的哈希函数：
Hi=RH1（key）&nbsp; i=1，2，…，k
当哈希地址Hi=RH1（key）发生冲突时，再计算Hi=RH2（key）……，直到冲突不再产生。这种方法不易产生聚集，但增加了计算时间</p></li><li><p>链地址法
这种方法的基本思想是将所有哈希地址为i的元素构成一个称为同义词链的单链表，并将单链表的头指针存在哈希表的第i个单元中，因而查找、插入和删除主要在同义词链中进行。链地址法适用于经常进行插入和删除的情况</p></li><li><p>建立公共溢出区
这种方法的基本思想是：将哈希表分为基本表和溢出表两部分，凡是和基本表发生冲突的元素，一律填入溢出表</p></li></ol>]]></content>
        <author>
            <name>flankx</name>
            <email>137472591@qq.com</email>
            <uri>https://github.com/flankx</uri>
        </author>
        <category label="Hash" term="Hash"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Transactional 什么情况下会失效？]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/07/25/spring-0725</id>
        <link href="https://ahkevinxy.github.io/blog/2023/07/25/spring-0725"/>
        <updated>2023-07-25T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Spring事物 Spring如何解决事务问题]]></summary>
        <content type="html"><![CDATA[<ul><li><code>@Transactional</code>&nbsp;注解只有作用到 public 方法上事务才生效，不推荐在接口上使用；</li><li>避免同一个类中调用&nbsp;<code>@Transactional</code>&nbsp;注解的方法，这样会导致事务失效；</li><li>正确的设置&nbsp;<code>@Transactional</code>&nbsp;的&nbsp;<code>rollbackFor</code>&nbsp;和&nbsp;<code>propagation</code>&nbsp;属性，否则事务可能会回滚失败;</li><li>被&nbsp;<code>@Transactional</code>&nbsp;注解的方法所在的类必须被 <code>Spring</code> 管理，否则不生效；</li><li>底层使用的数据库必须支持事务机制，否则不生效；</li></ul>]]></content>
        <author>
            <name>flankx</name>
            <email>137472591@qq.com</email>
            <uri>https://github.com/flankx</uri>
        </author>
        <category label="Spring" term="Spring"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[如何保证 redis 缓存一致性？]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/07/24/redis-4</id>
        <link href="https://ahkevinxy.github.io/blog/2023/07/24/redis-4"/>
        <updated>2023-07-24T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Redis一致性 redis 如何使用到缓存一致性]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="方案一">方案一<a href="#方案一" class="hash-link" aria-label="方案一的直接链接" title="方案一的直接链接">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="采用延时双删策略">采用延时双删策略<a href="#采用延时双删策略" class="hash-link" aria-label="采用延时双删策略的直接链接" title="采用延时双删策略的直接链接">​</a></h3><ul><li>基本思路： 在写库前后都进行删除缓存操作，并且设置合理的超时时间</li><li>基本步骤： 先删除缓存–再写数据库—休眠一段时间—再次删除缓存
注：休眠的时间是根据自己的项目的读数据业务逻辑的耗时来确定的。这样做主要是为了保证在写请求之前确保读请求结束，写请求可以删除读请求造成的缓存脏数据。</li><li>该方案的弊端： 集合双删策略+缓存超时策略设置，这样最差的结果就是在超时时间内数据存在不一致，又增加了写请求的耗时。</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="方案二">方案二<a href="#方案二" class="hash-link" aria-label="方案二的直接链接" title="方案二的直接链接">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="一步更新缓存基于订阅binlog的同步机制">一步更新缓存（基于订阅Binlog的同步机制）<a href="#一步更新缓存基于订阅binlog的同步机制" class="hash-link" aria-label="一步更新缓存（基于订阅Binlog的同步机制）的直接链接" title="一步更新缓存（基于订阅Binlog的同步机制）的直接链接">​</a></h3><ul><li>基本思路： <code>MySQL Binlog</code>增强订阅消费 + 消息队列 + 增量数据更新到<code>Redis</code>。</li></ul>]]></content>
        <author>
            <name>flankx</name>
            <email>137472591@qq.com</email>
            <uri>https://github.com/flankx</uri>
        </author>
        <category label="Redis" term="Redis"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Redis数据结构]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/07/23/redis-3</id>
        <link href="https://ahkevinxy.github.io/blog/2023/07/23/redis-3"/>
        <updated>2023-07-23T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Redis数据结构 redis 常用数据库结构与使用]]></summary>
        <content type="html"><![CDATA[<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5种基础数据结构">5种基础数据结构<a href="#5种基础数据结构" class="hash-link" aria-label="5种基础数据结构的直接链接" title="5种基础数据结构的直接链接">​</a></h3><ul><li>String字符串</li><li>List列表</li><li>Set集合</li><li>Hash散列</li><li>Zset有序集合</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="3种特殊数据结构">3种特殊数据结构<a href="#3种特殊数据结构" class="hash-link" aria-label="3种特殊数据结构的直接链接" title="3种特殊数据结构的直接链接">​</a></h3><ul><li>HyperLogLogs基数统计</li><li>Bitmap位存储</li><li>Geospatial地理位置</li></ul>]]></content>
        <author>
            <name>flankx</name>
            <email>137472591@qq.com</email>
            <uri>https://github.com/flankx</uri>
        </author>
        <category label="Redis" term="Redis"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Redis 淘汰机制]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/07/22/redis-2</id>
        <link href="https://ahkevinxy.github.io/blog/2023/07/22/redis-2"/>
        <updated>2023-07-22T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Redis 淘汰机制 redis如何淘汰]]></summary>
        <content type="html"><![CDATA[<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="redis提供6种数据淘汰策略"><code>Redis</code>提供6种数据淘汰策略<a href="#redis提供6种数据淘汰策略" class="hash-link" aria-label="redis提供6种数据淘汰策略的直接链接" title="redis提供6种数据淘汰策略的直接链接">​</a></h3><ol><li><code>volatile-lru</code>（least recently used）：从已设置过期时间的数据集（server.db<!-- -->[i]<!-- -->.expires）中挑选最近最少使用的数据淘汰</li><li><code>volatile-ttl</code>：从已设置过期时间的数据集（server.db<!-- -->[i]<!-- -->.expires）中挑选将要过期的数据淘汰</li><li><code>volatile-random</code>：从已设置过期时间的数据集（server.db<!-- -->[i]<!-- -->.expires）中任意选择数据淘汰</li><li><code>allkeys-lru</code>（least recently used）：当内存不足以容纳新写入数据时，在键空间中，移除最近最少使用的 key（这个是最常用的）</li><li><code>allkeys-random</code>：从数据集（server.db<!-- -->[i]<!-- -->.dict）中任意选择数据淘汰</li><li><code>no-eviction</code>：禁止驱逐数据，也就是说当内存不足以容纳新写入数据时，新写入操作会报错。这个应该没人使用吧！
4.0 版本后增加以下两种：</li><li><code>volatile-lfu</code>（least frequently used）：从已设置过期时间的数据集（server.db<!-- -->[i]<!-- -->.expires）中挑选最不经常使用的数据淘汰</li><li><code>allkeys-lfu</code>（least frequently used）：当内存不足以容纳新写入数据时，在键空间中，移除最不经常使用的 key</li></ol><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="redis持久化机制">Redis持久化机制<a href="#redis持久化机制" class="hash-link" aria-label="Redis持久化机制的直接链接" title="Redis持久化机制的直接链接">​</a></h3><ol><li>RDB快照</li><li>AOF只追加文件</li></ol>]]></content>
        <author>
            <name>flankx</name>
            <email>137472591@qq.com</email>
            <uri>https://github.com/flankx</uri>
        </author>
        <category label="Redis" term="Redis"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Redis缓存异常处理]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/07/21/redis-1</id>
        <link href="https://ahkevinxy.github.io/blog/2023/07/21/redis-1"/>
        <updated>2023-07-21T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Redis缓存异常处理]]></summary>
        <content type="html"><![CDATA[<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="redis-缓存击穿穿透雪崩等场景的处理方式"><code>Redis</code> 缓存击穿、穿透、雪崩等场景的处理方式<a href="#redis-缓存击穿穿透雪崩等场景的处理方式" class="hash-link" aria-label="redis-缓存击穿穿透雪崩等场景的处理方式的直接链接" title="redis-缓存击穿穿透雪崩等场景的处理方式的直接链接">​</a></h3><p><img loading="lazy" alt="Alt text" src="/assets/images/redis-1-73402c15035d023fa536eb0b8060b01d.png" width="1080" height="622" class="img_ev3q"></p>]]></content>
        <author>
            <name>flankx</name>
            <email>137472591@qq.com</email>
            <uri>https://github.com/flankx</uri>
        </author>
        <category label="Redis" term="Redis"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[锁的状态]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/07/20/lock-2</id>
        <link href="https://ahkevinxy.github.io/blog/2023/07/20/lock-2"/>
        <updated>2023-07-20T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[java 锁的状态 如何使用java 锁]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="锁状态无锁状态偏向锁状态轻量级锁状态和重量级锁状态这几个状态会随着竞争情况逐渐升级锁可以升级但不能降级">锁状态：无锁状态、偏向锁状态、轻量级锁状态和重量级锁状态，这几个状态会随着竞争情况逐渐升级。锁可以升级但不能降级<a href="#锁状态无锁状态偏向锁状态轻量级锁状态和重量级锁状态这几个状态会随着竞争情况逐渐升级锁可以升级但不能降级" class="hash-link" aria-label="锁状态：无锁状态、偏向锁状态、轻量级锁状态和重量级锁状态，这几个状态会随着竞争情况逐渐升级。锁可以升级但不能降级的直接链接" title="锁状态：无锁状态、偏向锁状态、轻量级锁状态和重量级锁状态，这几个状态会随着竞争情况逐渐升级。锁可以升级但不能降级的直接链接">​</a></h2><p><img loading="lazy" alt="Alt text" src="data:image/webp;base64,UklGRkggAABXRUJQVlA4IDwgAABwlACdASq8ApcAPpFGnEulo6K/o/PZY/ASCWlu/Bd8HkB6TC51DQ/V3+39s39y+230d8Ufpr9m/d313MqdqX8q+5f63+9+2P9s/63+G8efjJ/e+oR+af0D/feKHsr9i/xX7O+wL7B/Wu/B/z/8h6l/nn9X/7P+G+AD+bf1j/qeqX/D8Rf7f/vPYC/nP+D/7/+K92X+6/bf0N/WvsI/sR1xvSjTEfMMPxJY8hgZ1iyYVkMDLX/b+3kw2zcmyVM6xZLjEam4l/4j8HzmtHGY4kGSEBnWLJcYjU3EwHkgYY1o4zjk+WcBLBIPExFwEmQ0MP41JIWox9t8kqKnXRqRjo+fAryP1KBzeAwx3YKwAo7ZNDpPnYVPTv//4VtibRsJlpG0w2kqpf3XwG0WUVBM+HYevw0FE2h86gy4D5JWi63LI5Hg1ZjZzc4yd7kc5ghz29fdSAyXzsn9zMIgTno/JmWPqZHqvSwbGT0YRJG+/i2EmEb3NyjDT6p5fFJR6kwt1wnFttK2I+5MjfyQCw3NBTM8ziJOgP+LlgP447M3/BlG56WG2SZgGrG2eUnMMU+0zTk4pJIjsJlMPghydY2l2nPIOvMu0/qEbLFkwEkPUqK66vL/RNGS9YHiGfWkygHhqA2B3bExIZqouSJ9yILJtppCNBcb7w0ILzYjSjCBcz9DwIPU57oFMrmASb5g3ljbPlA2nK3SIjk5ARamYTW7ajfAmWEnLBrhBybl/Ax5RisoSa5S6RshKOhAnj8wZxBxQtr5+SW3SyWg/7jXyIH4TDOy+t6gB89BLlsU28BLjmvgHvHTUJv/fQXG0IK2QDuMUSnEOLf9AxyANxePLuos1l3JSYs6+n3Cjd7BnVDHhtXNIbFrbv7+gRhzrvX+wndOhOVT4KFn/wcJxBiSFl74Z9DHmWF/GqsYTqT756ZuYB4AXl90JQzyV0RIMhPDKRVxGZPrm5gbpfZenHoSUJWi0qJ8BvqDZPIW6DUsmx9AQ4z/IrQvR+OwCLsav2HIvfzreIWVtZHWgn9z+8BNMOJKW7y1ZQnZcgflae5T981/oVl1448t19wo3Wi25hBkFzJcFF/Yc8E0S7eCQ4XBc9x4v7gdxkmMeGU4ibW/Tp/EljxTk/YuflxXLqMhywzwsSj2IzSxEXJCjUVYsoBYi1YPDAxKC5aN1edPsQDqGAuYukCfmQKpj50YsTwhjZpnjaBOFu772DCkudrJhn/JbBeGtwg7vRCnySTFQYDKqXaTYuFLkzKFwtySwrxoCKpa1V74uzhLGpvBXUPHpPFusIl7+PGiGzMR0RZRZKp0FUQWzg3vAVco+pHrudAGvub5V0L7fOybCCzJtyJwzd8ATamw/gn5p+P24ZNpWBS6x8OLPT6jWmVu/TaXL90dQsFKNemP71NweHluXo9IPvInL8aZABW/0qq80Y9au/DgEChaBs8/c4fiOFz7ovIjXMzGq3f6TC2SXVLUASo1Z/AItCWQ0Ed5IY/wLpVnCOSp58ebKH1lzSYRLAhVoufyMu6iGEsC5IcmzThc5SsGFRGjzL50OJOWySXKcRTPfnwdkjKWxSKESGEnLDHhlN90Y+qOAAD+9tDj9k80f+VB3zhFmWJG+MNu+cenpP2fLtAA+ODppNIUSCp1GOtzONgr5wqoaUSSeqbGxKXuU9xAQqQslG+zUXM/kaB7Rv2y9ZQCUqDZO46HMAAArb9mdif19Mjql9XUdygyoq0d1AOmQgMIyDc66eTh7r9Pz+ikaoTPxsRGJtpI5mAK4kPcgg1oxZTrERuVee1xx+yRG001vZNfuswXs3WaLyDah8n0mHNdWXGZolfUmno0NNhcfbjdtVTQIhfL3Av/lRdkJFfEPUyXG7B306UU+jbgk1oK7GBYa0D4Kk+WxpYi6pF4itXg8cVF9la5GlFrE35KchNaA1C9SdxagOSRYWjXK0vNdttuzEzN73j+R2+HSu/PiA9LCHKCsNdCbn5gmtmXgc0S4lVhRqzLYN/1kPz+5fdWaOB0lg2iGpvogEQfMTnZDrixwzfK44ad2oVPXz1hO/6FPhP9vs5QQIOPSBo6O76eLkVCAsUzGVv/W6bm7AX9ueZQYcuLIA/WRJQoJh092d4RfpQSkBGz32txPoij3qsgrAlMgIwKKX2yTNpnaDvgQh8gIjwVjniWJSc/U42EQCeYfWHpUR+B7B6/YVFLu6LXbeAsg6CDAgaTeORFYMKw/Q24VjZQ9pVij7bVVFCDirde4sW5NhTeNBYf4aKP1zBGTmEfPamLLf5TPUoBEEwGEUEcSmbWRz8OcjCsz8EvvtRx5+ekMT7KJCoSNWexqiPpVVffIc89uKIyB0NK9QSROJLW67JRk/BqyCEaktkwaT7whkQylD1E3P56drUs76ifkvJWopKRCyyleHVADRwdld8aaPnzlY4SSzb5W3WW7mLqaHVj5EQNvF9fX0VgJES+DQgcqiJg6hCOTOK7QeIDJ1wS7ghjnHN/uBJU9rJq4XABqRWTvHfiQqMZq/41+mg028iY/bMC/MTswcMH701BfLFDxqdtjxTcqrzO2rqWPUQa85dHuEt6EXBqFrbr/61xEr+sQBskNaXSwrCHKBxiFLKbVyKK7s/j0+pDEwLUUcle283eaKZD5c/mSd6/CcSmtuJIUaTs+Iex9TTCiBSfnnrklwHaKVMN/206nGy2M20N7r6UpWtWddC5twv6U5p6k5UDgfa7jZ2gSomNZl/7gLjrp1AmpqJThyvmuUO/sb+qRhMRpd1gpmv1HPcSemJ0xzLMOJLrdDA+YkqOrYWm2tWM7l+QQWtFa9eUYZgKynU7/g9nYw/dZc7IUV/Ac0XjjW8UovwUvnRLvgYev6aL/nxPcAfi7Ny1C4/dAc3in52L8UwOOou1UFyU/lVIitiEUzrKyZ+Di/cycbHUxkF23FzXJChUFSyeZfk0KxPNdkb419vnad87WI43CjF6lYxT1r522tG8OCf0VQS19SJ2A4DIj8Zc+x8/GiY0fHo1IJKg7IKGH3LZ9fhiKwAO8o12zLUk6E5mxUcom3eDUe/K0g/ZUIhHliUUpsOXWZMaqZ5dqHX9vADv8pvk27d7Gm7PaNSvFOW7wGtwYUdV9tKtgl1WIrnRoINJeP50wxgVpomMP3JLQyZDsPFDZxlVFlFFhLIlEzNkHwyb7lf0xlUpaeq8GWkQKnC1NGy9FXtOjyH0bRq/4CUoxVJAylxi7L3AEo2bbXJ+OJ7oStbM/LnOm8BpwnL2o8JxBO6JYaq2CfWCWllPfB0qRq+dXF/sEf9LFh7jRJjlGuMeQffRkv9zP1HwOZJhdlOFe1Tp1XSFl1usWzg27XrdI/LNajHX+YSXAVGvkAUUHlIuOna1B6SSQa++Ri2PYHwxfg8zgavd8F3Y3qOd1BsX26mW4z6dqSsXKChxPvHC47Z29NZqVy7uOWgsqkbvP9EQ9A0bptjN/IWpAf6B4pQWpvnB41bpkXNrehXz6bxXhuy0D8Iwcv8EMZywq7hcgqABjU4jj84dabFYTrOZzrO/Mgqz3+x9ckRL8hGE1lRTPv9v+L8UmZV4AJbPNzcVh6lVSeYkj4eOIRUD3JymRNRSKmrW2BLyK17IxRJ3FfO8iQC3/1X302+Uwf8xk/EQhW2+cyl7OboTf0yZdEvYnUa0Didenz0wXP0mrmRPHGIJjVIJSBhcKZOTRWYa4Xccn6fQ/p1gUT5nbK9gUHUPZxCxmHcy4k9jDO+PIrtyqVW9sgWTjuJincUhw83damGc3T9skotiT1XHvdUyHG6y3hW1MUdJjVCpIBMgGUYEznrV7e4jBf/3/speI0rCWjpA94e4bmI9542Qm4T+v3WoB+3GWHyLCmtOZ5inGKkHt9tdvyl5SLOX0aDoS2+KNH0ivpx2ZdZvgGiHXHMl0d3LhPqzNPfxGW6M5aptyyOQ3N9/Z8hQxtyNH0NonOAoU9skYm8UWAkF8OL/ztg7IAvDQk6wbT/Y6BEwpoGaq4dUivyWVhFEEP+bheR+OjTdkbk3Ffx6ySMwBnsdnFfyNzgSZI/lHLjkGTM9dpeEllWM6wMCFoLiCcdhzBvwAEcAqeX/HYsWdC9Pi2I0kEeMMygI5tU8RguCNavDmA0zmf1ubqQciTzEeATzzAzkPtNpVVfFbNK/sLfkMxI/iAun+zaPkK3LmG8W148bNIZtdNqc8w2M827oW+VE/8eOuzA2EHa6zBvv0k7XDQ9+lKQ5wzQQpmXYo4TujywxHQt2phSFzqE9mGCSbdJe5CMj1gTgOv1po4/u1RSufBM+X5m8X1ltBYl1l3KXE0bTokTL588z8N/eDBhU0qubH/o2gjIYuvEKTyBK5iAmCGxbQLXk9Ro8mn51rUt60NYic/mq33KI04UertxzPWWgDuwC7f5CFovhZwTSXsHJCdsJpMoJqaCyWu7VdBPY7P+LrIw3q0A2To1w/O6x/5eyb8Pj4AboqKOInO2Uqr5YMOpCLSMzaDDNDq1QZHwQMjErFi9N3lssn7awnO2UpVvFJtFpz9wd6zAxL3xw/MuvX+KVB9+BiGXtAtGRrARXyjrTo3jNXCfpMp7+UU+6u0XuIw8eoRUFcKuwdGaIBzqtjMtAkmN41YyVV4aFsykyarV2JC49N25cFy7TKRnUr004C4cOm2lJJfqxfzPTg45Umg8xI3K3YOiTs2xhAuzbWbBnu5SnnU38w+UpJIOijaHfWe1FCnBatiDYIcMpjq8V7E1bMoEb8XVTv6HK/Uk8EK8VYmK5XmixoEx52ECDiPoBfS2CLvVlGHQ5Jn0qdF8c1Y1STKs8UI4EPTR9PWdn8M+o2cIAXRd6aFdblZRLNCQF4uEXz2jBG7EnL5kVGXWUY0Ju8kf29kqD7WqDkwWYK3URpUvQ5oFH8MW8/DqvlgUUugKDI17PzZQvVo3X3j8Qw/S9gqKTM56ajtwkUKhykHz3Jcj5erj9ly9bTA5NSuPuY1YB8KbgfH/bPoSnsuGWnNk+QIA/eooKFTyZ2+8TOBNGO7KBU/Y4WDHNnRHJBb3jgDLU+KFotcf69c4D49Vh3cSx1N7s7F5DUc1wbxkIjg9OFHWNhBFrcPUaXtyGcWEkh2qlbcNvhR0oMe/xzLigeuIkodAt/HL0eC6f7I+vh1OtTBKMbEcsVPAtZ6XXx8tLYOipihmjEoB9v5oQFtxH7Ov/0hEPoqW4JjlZoaOcu8zUF7ejNggRk7bqa2gv0/JKK1oNRMXx+yH5eSCYD1kvYCPUF8Rs1MoWaJNnpYIlD77+/DT/jjrMyG99Xucx0wCpUjX5Ojrnm1FfnhEmKnzdBQ5LqYEqzNikkvDyID2wFEgOfzc6FOKDC8ETxVQ22VK7MYxhuhREQW8DTdukIAUfbp4fLObkGm+hI/mSjMirIEbvL6NkCLXFKVTXhX+dsnn7SpiOz7oMC+7nCtAntHZpKb4sujRqs8QpOfurgPpl0zUv9rfwx/cIRa16o9et7//9o/6DAz2k5iifKoTHhH0EFhH8fR5QQjjKjSWI5aBEVtPBPX3znqbezw6oTDfE3g7p+O6VcX3TWOVDXzwzwsm7wosge7dWrsognvwnKvtWMqr1yYP/XlVZ+a0BBZhjlOKH5C6XLlkzsRM0QG9IPBx/o1TdrZdRi8v8aFsJ/ranYC20aLLt6ACdta/NPSnmKknzeTMJfndGJil74MIVOQtZQxuM9ZzBfQinIIDtBEQQ2FoBCoqrzbIUTQxHiVxuTUSVtnKNPdPqJPUv5fj6hZthcm5BKEgIBN7FE00YPhKAoaz+cYocQJShj9f1cSaHYSf2OM62JhHKOEbRDS3oHVPX+H45PkZzCTVqYXajcU3FLtF+WBHzT9DovGHoG+IK04mKjNG2I6gDv7DQF/f+gBZPuFZSL7Uo8ON3t8LqW+B7104clkhqmxgKeW3FR+a/j+1V4HIE80LS5KnOHcmBaci2q2CyPNDpplhJVZat2bINAzCBzsV4p0mo0RuS+REUJ+Cf1hcFuBQL50rR8dwrkwh0+UHm8LjZy67Ia7TRSkX0pV1bOoGbzKHyP7zbVXY4DAxSFs7LECTyYGVCGGPIQkbeEWO/1MCB+vsDWqJf22OYhnm4TysP5aIDshIcWSk9MWeM/Dv3oxpVsYNuFgEhwzmJELoSt6cjkfHeBVz84HkJnP17MViBrUfs7Z4jA9JaLHlgTlckkG0lx1su7gAszAZ71KR43Qr++Hao0+mt0Un8bDwfO3D2+aoyAPRFqzgJGaa0zJv0F1PBg9MUbQ8zf+ayyE0NDO4cQG6U9olM53UfiA91GXOQXnSze/g7k7V4QWzQtNoZ+Zw3MdzTkD8o6U9UxmsRtYh9zGylJQeK4wRNH8O1BgG4fWSXD0p66qID+YeqsVXM0dznpsrVVWbTEfJgvKo21a57RNX3jbNyraGq3GGi0dnhdmBOiAnhUZivrtcG1XwEdXg+ilNf0BdPrtvJf6M3E1EEW0Y7r8vdeVj9LHhWijiPe1qwNbNnRCpx2VvscsXTTq1UR/cwIIbinnZAVERzEkkJq9+Y6YSW7V5PJ3bT/GfKj/iAwSxgMu62YSsiEVme1FUdeyqKlcTXiHMluwSzq8QdglherNkFUp+P82WYfVQEl/X4DqkcQtgcrYFMXHwuIcZ+nUNXiZpgWtq61rPhyECKuF8cPSp1v2kSJ9mMgX6fgvkIf//OtkOqhfpkiKihFWatk17O4HeBXje3MXvErdQIPpxa81AgGu/di98DRVenvMdbIVie/1/MGxYX60Py4Vn2atuGXGZr5DksHijoFIYc+C22AROfmSWP62CWxExNFWbsBxIvN61v8Mwhhdya6ZBEQJ3cEMYm/XycGVskLq2ahSRUJ43BFHh2K6FoyDTIObGCGS3iUxY6wmKXg5BG3uXFSw3SsNbkzBhqJJa/repYb0k8vs8j7UG1U2G7jqqHQ2XYL6o0kQDHDP+DTVUXojUt5hHOERPF3miPVznwsVmztGjvJyJch6k3I1IWSz7ac1/+TVEo5rx0z6ze0he2NrX3q8mxP+qdJPjxNg0ZdSfrHkAjZ2kb9eAE0duj/VqpyMqhtSdHgaCvbrN1Q1DOUoChgTon0AHdvJcndKrWnOCd6PGGvf+E7ILcwtznhsLOiaktjpF1AejU4iJ3BjrQceFMKSRxS9No4sf7S79n4o2fGqP7xL7i/ZMsVeNMMlttKzGrd44/MDrjtXQkAiZUzTeUDfMcKHp4NSnRiO9zwutW09Bfqg9S8VaBC3npsW62qj7vydiKShxYbxRHfa/z+s9owuFhYbZQCWcreXueep1Iu+qf4p+S7FgMhq6rM69nQIZx4OeO0l9D0b0oe+/v3819Ms8utCEyDqpjkY7VFe8pfpIqAbnnftCY/bc+St1gDgdMXbPGNmO0nOhtSvRDRnkoYhUu9WJ9LKE8j03PSr97vxXqNIcePcJJT/D7c9Y0XFesEKzTGbU8TBwL1IzRhk6faYgvVRZ8WdfT2Ibj1sbg7UnR7y8S18XU3an941K+FekSV6vigaoQRbvwGfA+NhFyP/PZwOVPeECIbd3D0j0atZvil38JlnAbl48KgJfdz+Pn66SJupPjTx+OusHkZKiEnYzU5MOLebRmLI+SfUC6JvloRIHjhxE9StoT1n+iUEAW/2d6eSNhjPfVUbh84Dugwt2HaH8R6+QF5ILoq6Ebxf0Ij2NOdR/63P3cJzTc63rjQ6LwB3G5Jm4f/GA6c7gyzhPiUfGmjd0zbvXiRc5KtGefQuqeQMJ4TZG5eAWHbJJW9lujs5TFKJOCNYObJnCAH9BU2vNcShhJtMj6dwcPkAKQls8A64nu/rhp5fCt0j+I1PzzPM3gwVA0a8O0Qyarjn7f869eedcbaT37O1f94a54v+JXaZWUx+3njpfvnnzVd3EdGg55meCo/+iv4JDdAAAAAAF7Mlnh2BFmVupy4JjRovTNgjfoZ3bApSNh2l3lP0qXxamB0KzQVkePJN8G9fsRCYbfSFh6vfpm3zYkg3bf3uEjYbQ+7Szk4JKHQXN1H6G2yH6H7Vr6JbDwGXUZ2kMiNiWvQOcUkb9n+k5elwGcAteVuQe3dJsh/Q9sCqaHFzx6u2VOnFePgD1AcIfXEenKmge1bBL2awe8sbN4b7rAXtWXLSlwXOFFyBbaVda8ryKzrBonl21IEMkkjYhu+gCTf/5O7r5pgzONLkzGzld8UstPpbDZtYRVjgLxh5JDx39xAaKDPcpY4dIdSC6RWIK3QSCXhESKrF09YciYwoJNWcdL/nZh+gd6o0PweUhOasTja5S0EjM6m9xJerm5+woYrMAOeUS3T5zvOrnpDWfHzs0BYxLlH73MPNF1Jf8qei9qv3fgGQSDrrhjryfmNqR3BHfita0Rip21uO1WBgQwXfTI1z0yPdEe+3ETne3qd5x6ekD4qFuIC4dBEZcF5Xh1tKgFUB6BjyDwphrDwg8hkrouhimT7jmPS06STeLRiPkJYZ9T5iMipNhHGM/McNA9y9/VkCb+axMX9bU4JnQ6vqf35U0G/ZfyYs8if/XTU1GfquF4RwfgfS4HBcmq4y6GUs1GNyy9GSRHQ/U5tW0pD36swe5TLL6sD+ddle8SQ77wD85p/wIvnJSatcfK9NgpGVqGxfONUyA0awNMIXhdq38T79tr6p2dRhgNuiMAkjiFCqLeNmgrYgkelh3AG8OS8T75vfuL9610mb5N2K2VgYDgocyp1ejB7n1k2BjOQzYXCVtyJ+VA6iNZY6eq3QbBHsQLARNIxe37pPMiRxP86qWtgsakW84T7OnAAUjjy1ucXCDGnM+khUWKcTKTMU2rovDMczvrfJQzhGeRJ/8u70BUGZyYAhpU3ORurdbu5UXw+iWzJjfIIlN4u5eT4/H1YiGTQkrlgqkmBRq9Q1hWwurwZJwGWJSxSMnKtotxaahZ/QRjrWy6ITxK7qoXtAUA4gfgaQ3NL9CwdhR7QbgeAafLNcdKmi2wqb21nke4jmikkSxTYLtRjtzd1jzIy/oDzSgTcIjClrWxrGG8RpMtZRtYrDfip2ClqXwSH76DCrKIPheTwVu//kOFBEzY5HBgokuzvt3tFENVisMjNabxnqwGjFrfpcuqs8pPLtV9vwV0gYJXiTDVJpo1og5irPK/umqLm2rlOuNVZDL0xgiYVogKAiywG960+9gqCEFoyGYe3E0X/74BxnPoosS2m/NHGGXOB4qNCUDpzJyWiDlBWa5cE8ba7FtRHi+4RkaoEn4NVy28sAUXZfOG28aRIlltooDWq0slRgMXOO+We+0zIufx5a/JKIa66+w5xIvrHjTDQWi4ijZkqtgwQDPC6XHO8w+id6JvzBGylaFljtWGjMDwRWbEWvrxhhSDUFpdk59YWEslZ0pjUal+crZWhwmbcQSf5UUc3CZxQ4x6grVNJhueaOZ51CQZj35fG6le6moQ3jbt5tZnWIfHo7tXYJ69YCAQB98jE59PTUKaC3VhkI7hc+suLesldfCBY0gL9DaeoPp71wmIQGy5Ya3xbe03KdmXe/cfUYOwsOF+0fByuexQUoJd3lv4nJ3oFf6EnRI8qgv5v0UilQFzm3348G3s8vorlcI4PNac4dIyRfjFeEBO9M1RSumK2vNpfswRD0VMFM6fgkHubshygS8cLWVGMBsY6X3R7Fx6PNCBFptsEi9VrifT+SUmY9+gpHU+AYH18a07RGgKmXOrZb2tQEAwdo2vRIUt/aemOJbdbUAGGoMycdoGNJj0tV4tvPKAXktAQATHe9uDeg5RbNq/xaCqklbgyAL3yrHUesaFvYxSlEpcCdLyQNpwhmAS03V/2+xqT4V43DGHnRz4kTzlff99UxJzUg1y9TsTxXb6pyGttCcai5JFMaZipCs3LFnBDEr7pN+7astxxvBanMM/GR4ZYjpsBMsnJna7hi+nQyMHNeZi0xAshfWms8OwTES32tStw+ubGZ6VNrVAXqyqvz97ZKxadDcxWZvdr9oYpb5oyG0uyRXuvggR5meWKPclQ77sdy39BY+HUSkkVdGwXJPijtOyx6/GpfnK04lrkIcmdccmAk6r8hTf8yP3D0HmQsFFSgeSUYygpdammdeYk1raNCgg4pr13TsFlHbAgk6WrC3395q6B5nW2zUM54EAiHCSyM7zZbEHe8t50fdt4oGznCD2gFCShpfcXJzfxxQhB0mDwk8p+g9Nc6hwhBIxss/RGJQqoDRJJIg+4iisbqa0MX2H9cKApebhKG1WflUBb50/cRBTeEvdrhL8ieX5ngLogTBmB3PaBQRbBpEetO+PfYB/6tICnZrMEq4zhRmhihb5UvaYgi/hDGkDozV6vSaUDFl5ngnfPcM1xCI0/hJkiqd7uVlXSfTTjyy0HhAd69W4Jdy1wYzN+87pjptXH1+2tC6Sxh0vV09JSblCx8UudBNj7n+tyQBzE7KM4+tZz0fCGz1xTBr7gm6JpZpciFSgcOg2dEG/kHoApLyKV3yzrDCsw+uE+VYnECJxZqXrAvHEFcS31KSe17QpjKrxWByLg5nxdIUHTIy+lGVgUeoMbPMIdcIzrz2y6+Z2ZlC+HjoxvKX34LoxppC0+8uvFCrIJz7mvR1PX3pOee3kXrOfPk5Kan0vaPt/1oAzmgAxI1GAVJ7x+1dA6hM238uDCdm6+ZGSfFNvO/UKj0svL6LbAQkysfFYwFiLiEn8IhO+jZ8O3JqUSxYdEwfvLWHnPUwwChzsmylB6T3JqKDIk8VhXvk9A5q5+l+JOBEaU0HYDkN1fZs6NnDTItkS0rNjiBrfTKZB3mzTkSVaEWHjzFZzmo4e0w4IWMvBKhQTQc10hZner96HOpPOx5UP/7BdJsEeVtS8a0oW4QFTGOYwpCTjUOR6j9286f6hZTGVdyW0m5yYjWlyh+5P5RhphDzDIJLVmhN5nPdqMBg8NjeBUjsirxZsFnbtq73cqdJ/0BQCTlkNwHc43ZZy2uKabp+2JsxaCw7SIAAAAAAcdjOHAAAAAA==" width="700" height="151" class="img_ev3q"></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="各种锁的比较">各种锁的比较<a href="#各种锁的比较" class="hash-link" aria-label="各种锁的比较的直接链接" title="各种锁的比较的直接链接">​</a></h2><p><img loading="lazy" alt="Alt text" src="/assets/images/lock-2-39c60f481cbb320520da98d58cff63d2.webp" width="800" height="193" class="img_ev3q"></p>]]></content>
        <author>
            <name>flankx</name>
            <email>137472591@qq.com</email>
            <uri>https://github.com/flankx</uri>
        </author>
        <category label="Java" term="Java"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[synchronized & ReentrantLock 区别]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/07/19/lock-1</id>
        <link href="https://ahkevinxy.github.io/blog/2023/07/19/lock-1"/>
        <updated>2023-07-19T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Java 锁的区别 如何使用java 锁]]></summary>
        <content type="html"><![CDATA[<table><thead><tr><th>类别</th><th>synchronized</th><th>ReentrantLock</th></tr></thead><tbody><tr><td>存在层次</td><td>Java的关键字，JVM层面</td><td>是一个类</td></tr><tr><td>锁的释放</td><td>1.以获取锁的线程执行同步代码，释放锁 2.线程执行发生一次，JVM会让线程释放锁</td><td>在finally中必须释放锁，不然容易造成线程死锁</td></tr><tr><td>锁的获取</td><td>加锁A线程获得锁，B线程等待，如果A阻塞，B线程会一直等待</td><td>分情况而定，Lock有多种锁的获取方式 condition</td></tr><tr><td>锁状态</td><td>无法判断</td><td>可以判断</td></tr><tr><td>锁类型</td><td>可重入，不可判断，非公平</td><td>可重入，可判断，可公平</td></tr><tr><td>性能</td><td>少量同步</td><td>大量同步</td></tr></tbody></table>]]></content>
        <author>
            <name>flankx</name>
            <email>137472591@qq.com</email>
            <uri>https://github.com/flankx</uri>
        </author>
        <category label="Java" term="Java"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[SpringBoot自动配置实现原理]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/07/18/autoconfig-1</id>
        <link href="https://ahkevinxy.github.io/blog/2023/07/18/autoconfig-1"/>
        <updated>2023-07-18T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Spring boot 如何自动配置]]></summary>
        <content type="html"><![CDATA[<p><code>SpringBoot</code> 定义了一套接口规范，这套规范规定：<code>SpringBoot</code> 在启动时会扫描外部引用 jar 包中的 <code>META-INF/spring.factories</code> 文件，将文件中配置的类型信息加载到 Spring 容器（此处涉及到 JVM 类加载机制与 <code>Spring</code> 的容器知识），并执行类中定义的各种操作。对于外部 jar 来说，只需要按照 <code>SpringBoot</code> 定义的标准，就能将自己的功能装置进 <code>SpringBoot</code></p><ul><li><code>@SpringBootApplication</code> 看作是&nbsp;<code>@Configuration</code>、<code>@EnableAutoConfiguration</code>、<code>@ComponentScan</code>&nbsp;注解的集合</li><li><code>@EnableAutoConfiguration</code>：启用 <code>SpringBoot</code> 的自动配置机制</li><li><code>@Configuration</code>：允许在上下文中注册额外的 bean 或导入其他配置类</li><li><code>@ComponentScan</code>： 扫描被 <code>@Component</code>&nbsp;(<code>@Service</code>,<code>@Controller</code>)注解的 bean，注解默认会扫描启动类所在的包下所有的类 ，可以自定义不扫描某些 bean。如下图所示，容器中将排除TypeExcludeFilter和AutoConfigurationExcludeFilter。</li></ul><p>总结：<code>SpringBoot</code> 通过 <code>@EnableAutoConfiguration</code> 开启自动装配，通过 <code>SpringFactoriesLoader</code> 最终加载 <code>META-INF/spring.factories</code> 中的自动配置类实现自动装配，自动配置类其实就是通过<code>@Conditional</code> 按需加载的配置类，想要其生效必须引入   <code>spring-boot-starter-xxx</code> 包实现起步依赖</p>]]></content>
        <author>
            <name>flankx</name>
            <email>137472591@qq.com</email>
            <uri>https://github.com/flankx</uri>
        </author>
        <category label="SpringBoot" term="SpringBoot"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[如何开发一下适合自己后台管理系统]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/07/18/develop</id>
        <link href="https://ahkevinxy.github.io/blog/2023/07/18/develop"/>
        <updated>2023-07-18T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[umax-admin 从零开发一个属于自己的后台管理系统]]></summary>
        <content type="html"><![CDATA[<p>市场上很多 gin vue admin 等管理系统 </p><p>相对来说没有一个合适的 react admin 管理后台</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="技术选项">技术选项<a href="#技术选项" class="hash-link" aria-label="技术选项的直接链接" title="技术选项的直接链接">​</a></h2><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="方案设计">方案设计<a href="#方案设计" class="hash-link" aria-label="方案设计的直接链接" title="方案设计的直接链接">​</a></h2><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="技术设计">技术设计<a href="#技术设计" class="hash-link" aria-label="技术设计的直接链接" title="技术设计的直接链接">​</a></h2><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="总结">总结<a href="#总结" class="hash-link" aria-label="总结的直接链接" title="总结的直接链接">​</a></h2>]]></content>
        <author>
            <name>Easytooler</name>
            <email>ah_kevin_xy@126.com</email>
            <uri>https://github.com/Easytooler</uri>
        </author>
        <category label="React" term="React"/>
        <category label="admin" term="admin"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[如何使用 warp+的24PB 流量账号]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/07/16/warp</id>
        <link href="https://ahkevinxy.github.io/blog/2023/07/16/warp"/>
        <updated>2023-07-16T21:48:40.000Z</updated>
        <summary type="html"><![CDATA[如何轻松使 warp+ 获取 24PB 流量账号  1.1.1.1如何获得免费流量 github 加速 github 速度提升 无法打开github]]></summary>
        <content type="html"><![CDATA[<p>github  无法打开问题解决</p><p>免费送的24PB 有手就可以领取的福利</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="下载-warp-客户端">下载 warp 客户端<a href="#下载-warp-客户端" class="hash-link" aria-label="下载 warp 客户端的直接链接" title="下载 warp 客户端的直接链接">​</a></h2><p><a href="https://1.1.1.1/" target="_blank" rel="noopener noreferrer">下载地址</a></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="安装-warp">安装 warp<a href="#安装-warp" class="hash-link" aria-label="安装 warp的直接链接" title="安装 warp的直接链接">​</a></h2><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="获取步骤">获取步骤<a href="#获取步骤" class="hash-link" aria-label="获取步骤的直接链接" title="获取步骤的直接链接">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="通过接口的形式获取-1个-g-流量">通过接口的形式获取 1个 G 流量<a href="#通过接口的形式获取-1个-g-流量" class="hash-link" aria-label="通过接口的形式获取 1个 G 流量的直接链接" title="通过接口的形式获取 1个 G 流量的直接链接">​</a></h3><ol><li>打开这个项目: <a href="https://replit.com/@misaka-blog/warp-key-generator" target="_blank" rel="noopener noreferrer">https://replit.com/@misaka-blog/warp-key-generator</a> ，点击绿色的“run”按钮</li></ol><p><img loading="lazy" alt="查看图片" src="/assets/images/1-0c73997f1e7419d698e495454ac02532.jpeg" width="2880" height="1800" class="img_ev3q"></p><ol start="2"><li>输入生成的密钥数量，然后回车
<img loading="lazy" alt="查看图片" src="/assets/images/2-a4acc58a6779801aac1105ac3261f7a9.jpeg" width="2880" height="1800" class="img_ev3q"></li><li>生成的密钥将会显示在控制台上面，复制粘贴备用</li></ol><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="获取-24pb-流量">获取 24PB 流量<a href="#获取-24pb-流量" class="hash-link" aria-label="获取 24PB 流量的直接链接" title="获取 24PB 流量的直接链接">​</a></h3><ol><li><p>打开 <a href="https://web.telegram.org/" target="_blank" rel="noopener noreferrer">Telegram</a></p></li><li><p>打开这个TG频道：<a href="https://t.me/warpplus" target="_blank" rel="noopener noreferrer">@warpplus</a>，找到频道最新发布的WARP+的账户密钥
<img loading="lazy" alt="查看图片" src="/assets/images/3-47b6302de45b0692ee2616524ce51a80.png" width="1988" height="1228" class="img_ev3q"></p></li><li><p>也可以通过这个TG Bot：<a href="https://t.me/generatewarpplusbot" target="_blank" rel="noopener noreferrer">@generatewarpplusbot</a>，生成一个自己独有的WARP+账户密钥
<img loading="lazy" alt="查看图片" src="/assets/images/4-b9bf7d13912e9327b7c918c3680c0856.png" width="874" height="809" class="img_ev3q"></p></li><li><p>按照下方步骤，输入频道或者是机器人提供的WARP+密钥</p></li><li><p>这就白嫖了一个WARP+ 24PB流量的账户了
<img loading="lazy" alt="查看图片" src="/assets/images/5-4d1e9e25e69ef683b536c71216b0b5a2.png" width="2314" height="900" class="img_ev3q">
<img loading="lazy" alt="查看图片" src="/assets/images/6-2d69ebc3c867625923760a3e9523894e.png" width="1712" height="1238" class="img_ev3q"></p></li></ol>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="教程" term="教程"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Java接口与抽象类的区别]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/07/16/Java-1</id>
        <link href="https://ahkevinxy.github.io/blog/2023/07/16/Java-1"/>
        <updated>2023-07-16T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[接口与抽象类的区别]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="相同点">相同点<a href="#相同点" class="hash-link" aria-label="相同点的直接链接" title="相同点的直接链接">​</a></h2><ul><li>（1）都不能被实例化</li><li>（2）接口的实现类或抽象类的子类都只有实现了接口或抽象类中的方法后才能实例化。</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="不同点">不同点<a href="#不同点" class="hash-link" aria-label="不同点的直接链接" title="不同点的直接链接">​</a></h2><ul><li>（1）接口只有定义，不能有方法的实现，java 1.8中可以定义default方法体，而抽象类可以有定义与实现，方法可在抽象类中实现。</li><li>（2）实现接口的关键字为implements，继承抽象类的关键字为extends。一个类可以实现多个接口，但一个类只能继承一个抽象类。所以，使用接口可以间接地实现多重继承。</li><li>（3）接口强调特定功能的实现，而抽象类强调所属关系。</li><li>（4）接口成员变量默认为public static final，必须赋初值，不能被修改；其所有的成员方法都是public、abstract的。抽象类中成员变量默认default，可在子类中被重新定义，也可被重新赋值；抽象方法被abstract修饰，不能被private、static、synchronized和native等修饰，必须以分号结尾，不带花括号。</li></ul>]]></content>
        <author>
            <name>flankx</name>
            <email>137472591@qq.com</email>
            <uri>https://github.com/flankx</uri>
        </author>
        <category label="Java" term="Java"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Spring 启动时执行指定方法]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/07/15/Spring-1 </id>
        <link href="https://ahkevinxy.github.io/blog/2023/07/15/Spring-1 "/>
        <updated>2023-07-15T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Spring 启动时执行指定方法]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="一实现方式">一、实现方式<a href="#一实现方式" class="hash-link" aria-label="一、实现方式的直接链接" title="一、实现方式的直接链接">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1-实现-servletcontextlistener-的-contextinitialized-方法">1. 实现 ServletContextListener 的 contextInitialized 方法<a href="#1-实现-servletcontextlistener-的-contextinitialized-方法" class="hash-link" aria-label="1. 实现 ServletContextListener 的 contextInitialized 方法的直接链接" title="1. 实现 ServletContextListener 的 contextInitialized 方法的直接链接">​</a></h3><div class="language-Java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-Java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import lombok.extern.slf4j.Slf4j;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.springframework.stereotype.Component;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.servlet.ServletContextEvent;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.servlet.ServletContextListener;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Slf4j</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Component</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class ServletContextListenerDemo implements ServletContextListener {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * web应用程序初始化过程正在启动的通知。在初始化web应用程序中的任何过滤器或servlet之前执行</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param sce</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void contextInitialized(ServletContextEvent sce) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log.info("启动执行 ServletContextListener 的 contextInitialized 方法");</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2-静态代码块">2. 静态代码块<a href="#2-静态代码块" class="hash-link" aria-label="2. 静态代码块的直接链接" title="2. 静态代码块的直接链接">​</a></h3><div class="language-Java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-Java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Slf4j</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Component</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class TestDemo {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    static {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log.info("启动执行静态代码块");</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public TestDemo() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log.info("构造方法");</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @PostConstruct</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void initial() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log.info("执行 PostConstruct 注解的方法");</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="3-注解-postconstruct-同上">3. 注解 @PostConstruct 【同上】<a href="#3-注解-postconstruct-同上" class="hash-link" aria-label="3. 注解 @PostConstruct 【同上】的直接链接" title="3. 注解 @PostConstruct 【同上】的直接链接">​</a></h3><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="4-实现-servletcontextaware-的-setservletcontext-方法">4. 实现 ServletContextAware 的 setServletContext 方法<a href="#4-实现-servletcontextaware-的-setservletcontext-方法" class="hash-link" aria-label="4. 实现 ServletContextAware 的 setServletContext 方法的直接链接" title="4. 实现 ServletContextAware 的 setServletContext 方法的直接链接">​</a></h3><div class="language-Java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-Java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import lombok.extern.slf4j.Slf4j;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.springframework.stereotype.Component;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.springframework.web.context.ServletContextAware;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import javax.servlet.ServletContext;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Slf4j</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Component</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class ServletContextAwareDemo implements ServletContextAware {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * 在填充普通bean属性之后，但在初始化回调（如InitializingBean的afterPropertiesSet或自定义init方法）之前调用。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * 在ApplicationContextAware的setApplicationContext之后调用。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param servletContext</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void setServletContext(ServletContext servletContext) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log.info("启动执行 setServletContext 方法");</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5-注解-eventlistener">5. 注解 @EventListener<a href="#5-注解-eventlistener" class="hash-link" aria-label="5. 注解 @EventListener的直接链接" title="5. 注解 @EventListener的直接链接">​</a></h3><div class="language-Java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-Java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import lombok.extern.slf4j.Slf4j;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.springframework.context.event.ContextRefreshedEvent;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.springframework.context.event.EventListener;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.springframework.stereotype.Component;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Slf4j</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Component</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class EventListenerDemo {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @EventListener</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void init(ContextRefreshedEvent event) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log.info("启动 EventListener 事件交给 spring 管理");</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="6-实现-applicationrunner-接口的-run-方法">6. 实现 ApplicationRunner 接口的 run 方法<a href="#6-实现-applicationrunner-接口的-run-方法" class="hash-link" aria-label="6. 实现 ApplicationRunner 接口的 run 方法的直接链接" title="6. 实现 ApplicationRunner 接口的 run 方法的直接链接">​</a></h3><div class="language-Java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-Java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Slf4j</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Component</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class ApplicationRunnerDemo implements ApplicationRunner {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void run(ApplicationArguments args) throws Exception {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log.info("启动 ApplicationRunner 的 run 方法");</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Set&lt;String&gt; optionNames = args.getOptionNames();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for (String op: optionNames</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             ) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            log.info("传入的参数名" + op);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String[] sourceArgs = args.getSourceArgs();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for (String arg:sourceArgs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             ) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            log.info("传入的原始参数。" + arg);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="7-实现-commandlinerunner-接口的-run-方法">7. 实现 CommandLineRunner 接口的 run 方法<a href="#7-实现-commandlinerunner-接口的-run-方法" class="hash-link" aria-label="7. 实现 CommandLineRunner 接口的 run 方法的直接链接" title="7. 实现 CommandLineRunner 接口的 run 方法的直接链接">​</a></h3><div class="language-Java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-Java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Slf4j</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Component</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class CommandLineRunnerDemo implements CommandLineRunner {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void run(String... args) throws Exception {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log.info("执行 CommandLineRunner 的 run 方法， 传入参数 ", args);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="二执行顺序">二、执行顺序<a href="#二执行顺序" class="hash-link" aria-label="二、执行顺序的直接链接" title="二、执行顺序的直接链接">​</a></h2><div class="language-log codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-log codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">22:03:25.688  INFO 21132 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">22:03:25.716  INFO 21132 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">22:03:25.716  INFO 21132 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.19]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">22:03:25.808  INFO 21132 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">22:03:25.809  INFO 21132 --- [main] o.s.web.context.ContextLoader            : Root WebApplicationContext: initialization completed in 1200 ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">22:03:25.841  INFO 21132 --- [main] c.b.n.i.ServletContextListenerDemo       : 启动执行 ServletContextListener 的 contextInitialized 方法</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">22:03:25.850  INFO 21132 --- [main] c.b.n.i.ServletContextAwareDemo          : 启动执行 setServletContext 方法</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">22:03:25.851  INFO 21132 --- [main] com.bookman.notes.initmethod.TestDemo    : 启动执行静态代码块</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">22:03:25.851  INFO 21132 --- [main] com.bookman.notes.initmethod.TestDemo    : 构造方法</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">22:03:25.852  INFO 21132 --- [main] com.bookman.notes.initmethod.TestDemo    : 执行 PostConstruct 注解的方法</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">22:03:25.983  INFO 21132 --- [main] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService 'applicationTaskExecutor'</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">22:03:26.121  INFO 21132 --- [main] c.b.notes.initmethod.EventListenerDemo   : 启动 EventListener 事件交给 spring 管理</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">22:03:26.150  INFO 21132 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">22:03:26.155  INFO 21132 --- [main] com.bookman.notes.NotesApplication       : Started NotesApplication in 1.953 seconds (JVM running for 2.378)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">22:03:26.156  INFO 21132 --- [main] c.b.n.initmethod.ApplicationRunnerDemo   : 启动 ApplicationRunner 的 run 方法</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">22:03:26.157  INFO 21132 --- [main] c.b.n.initmethod.ApplicationRunnerDemo   : 传入的参数名foo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">22:03:26.157  INFO 21132 --- [main] c.b.n.initmethod.ApplicationRunnerDemo   : 传入的原始参数。--foo=debug</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">22:03:26.157  INFO 21132 --- [main] c.b.n.initmethod.CommandLineRunnerDemo   : 执行 CommandLineRunner 的 run 方法， 传入参数  </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content>
        <author>
            <name>flankx</name>
            <email>137472591@qq.com</email>
            <uri>https://github.com/flankx</uri>
        </author>
        <category label="Spring" term="Spring"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[如何搭建属于一个自己的路由器]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/07/15/router</id>
        <link href="https://ahkevinxy.github.io/blog/2023/07/15/router"/>
        <updated>2023-07-15T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[如何 使用 Java 深入理解路由器技术,搭建一个属于自己的路由器]]></summary>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="路由器" term="路由器"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[国内苹果开发者账号申请及上线]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/07/13/apple_develop</id>
        <link href="https://ahkevinxy.github.io/blog/2023/07/13/apple_develop"/>
        <updated>2023-07-13T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[企业如何在appstore 上架自己的APP 已经更新迭代自己的版本 如何申请邓白氏编码]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="第一步-注册">第一步 注册<a href="#第一步-注册" class="hash-link" aria-label="第一步 注册的直接链接" title="第一步 注册的直接链接">​</a></h2><p>注册 苹果账号</p><p>下载 APP  Developer</p><p>申请邓白氏编码</p><p><a href="https://www.dnbportal.cn/duns/apply" target="_blank" rel="noopener noreferrer">申请注册地址</a> <code>周期在7天</code></p><p>Developer 提交注册企业账号($99/year) 折合人民币(699/年) <strong>不能开发票</strong></p>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="苹果" term="苹果"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[导出文件及压缩]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/07/13/export-1</id>
        <link href="https://ahkevinxy.github.io/blog/2023/07/13/export-1"/>
        <updated>2023-07-13T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Java 导出文件 压缩 Java如何导出文件 Java如何压缩文件]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1-导出文件">1 导出文件<a href="#1-导出文件" class="hash-link" aria-label="1 导出文件的直接链接" title="1 导出文件的直接链接">​</a></h2><ul><li>1.1 设置返回的请求头</li></ul><table><thead><tr><th>Response Header</th><th>Value</th><th>Desc</th></tr></thead><tbody><tr><td>Content-type</td><td>application/json</td><td><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Content-Type" target="_blank" rel="noopener noreferrer">资源的MIME类型</a></td></tr><tr><td>Content-Disposition</td><td>attachment;filename=xxx.json</td><td><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Content-Disposition" target="_blank" rel="noopener noreferrer">展示形式</a></td></tr></tbody></table><ul><li>1.2 获取请求导出的资源并写入输出流</li></ul><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">response</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setCharacterEncoding</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"UTF-8"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">response</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setContentType</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"application/json"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">response</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">addHeader</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"Content-Disposition"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"attachment;filename=xxx.json"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">String</span><span class="token plain"> content </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 此处导出字符串</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">try</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">ServletOutputStream</span><span class="token plain"> outStr </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> response</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getOutputStream</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">BufferedOutputStream</span><span class="token plain"> buff </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">BufferedOutputStream</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">outStr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    buff</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">write</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">content</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getBytes</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">StandardCharsets</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">UTF_8</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    buff</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">flush</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Exception</span><span class="token plain"> e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    e</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">printStackTrace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2-导出文件并压缩">2 导出文件并压缩<a href="#2-导出文件并压缩" class="hash-link" aria-label="2 导出文件并压缩的直接链接" title="2 导出文件并压缩的直接链接">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="21-使用压缩工具apache-commons-compress">2.1 使用压缩工具<code>Apache Commons Compress</code><a href="#21-使用压缩工具apache-commons-compress" class="hash-link" aria-label="21-使用压缩工具apache-commons-compress的直接链接" title="21-使用压缩工具apache-commons-compress的直接链接">​</a></h3><ul><li>引入<code>POM</code>依赖</li></ul><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- https://mvnrepository.com/artifact/org.apache.commons/commons-compress --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.apache.commons</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">commons-compress</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">1.22</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>加入<code>Zip</code>压缩</li></ul><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token class-name">ZipArchiveOutputStream</span><span class="token plain"> zipOutput </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">ZipArchiveEntry</span><span class="token plain"> entry </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">ZipArchiveEntry</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">entry</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setSize</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">size</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">zipOutput</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">putArchiveEntry</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">entry</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">zipOutput</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">write</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">contentOfEntry</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">zipOutput</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">closeArchiveEntry</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>多个文件加入<code>Zip</code>压缩</li></ul><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">response</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setCharacterEncoding</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"UTF-8"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">response</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">addHeader</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"Content-Disposition"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"attachment;filename=xxx.zip"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">response</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setContentType</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"application/zip"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">List</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics">content</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> texts </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 此处导出字符串列表</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">try</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">ServletOutputStream</span><span class="token plain"> outStr </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> response</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getOutputStream</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">ZipArchiveOutputStream</span><span class="token plain"> zipOutput </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">ZipArchiveOutputStream</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">outStr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> texts</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">size</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i</span><span class="token operator" style="color:#393A34">++</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">byte</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> content </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> texts</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getBytes</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">StandardCharsets</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">UTF_8</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">String</span><span class="token plain"> entryName </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"xxx_"</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">".txt"</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">ZipArchiveEntry</span><span class="token plain"> entry </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">ZipArchiveEntry</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">entryName</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        entry</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setSize</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">content</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">length</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        zipOutput</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">putArchiveEntry</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">entry</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        zipOutput</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">write</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">content</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        zipOutput</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">closeArchiveEntry</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">IOException</span><span class="token plain"> e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     e</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">printStackTrace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="3-示例代码">3 示例代码<a href="#3-示例代码" class="hash-link" aria-label="3 示例代码的直接链接" title="3 示例代码的直接链接">​</a></h2><ul><li><a href="https://github.com/flankx/flankdemo" target="_blank" rel="noopener noreferrer">README</a></li></ul>]]></content>
        <author>
            <name>flankx</name>
            <email>137472591@qq.com</email>
            <uri>https://github.com/flankx</uri>
        </author>
        <category label="导出" term="导出"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[开源灵工系统]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/07/13/freelance</id>
        <link href="https://ahkevinxy.github.io/blog/2023/07/13/freelance"/>
        <updated>2023-07-13T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[功能齐全的灵活用户平台Sass 版本 如何搭建一个灵活用工系统 如何解决税务问题]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="项目背景">项目背景<a href="#项目背景" class="hash-link" aria-label="项目背景的直接链接" title="项目背景的直接链接">​</a></h2><p>灵活用工本质上是税筹的一种落地方式，而企业的税筹规划总是以节税为目的。</p><p>一般而言，企业用工形式，大致可以分为以下三类：</p><ul><li>标准劳动关系，即全日制用工，相关权益受《劳动法》和《劳动合同法》保护；</li><li>非标准的劳动关系，包括劳务派遣、非全日制用工（小时工等），相关权益受《劳动法》和《劳动合同法》保护；</li><li>第三类用工则不属于劳动关系，包括劳务关系、业务外包、实习、退休返聘、岗位外包、平台用工等，由《民法通则》和《合同法》予以约束。</li></ul><p><strong>灵活用工包含几个基本组成</strong>:</p><ol><li><p>用工企业：如上图所示的行业企业，一般存在短期、兼职或者其他形式的用工人员；</p></li><li><p>结算公司（税源地落户）：异地纳税、委托代征、核定征收，依托地方税务政策存在；</p></li><li><p>自由职业者：服务于用工企业，但是通过结算公司获取报酬。</p></li></ol><p><strong>灵活用工依据以及风险</strong>:</p><ol><li><p>首先需要明确的是，虽然“灵活用工”已被市场广泛应用，但它并非是一个法律概念，没有明确的法律法规来定义并解释这一概念，这也是目前灵活用工市场最大的不确定性所在，当然我们总是能从现行法律法规中找到支点。</p></li><li><p>《中华人民共和国税收征收管理法实施细则》第四十四条，明确了地方税务机关可以“委托有关单位和人员代征零星分散和异地缴纳的税收并发给委托代征证书”；</p></li><li><p>《委托代征管理办法》第五条，明确了“税务机关确定的代征人，应当与纳税人有下列关系之一：（二）与纳税人有经济往来关系”，第十条，明确了“税务机关应当与代征人签订《委托代征协议书》，明确委托代征相关事宜”；</p></li><li><p>《国家税务总局个体工商户个人所得税计税办法》第三条，明确了“所称个体工商户包括：（三）其他从事个体生产、经营的个人”；</p></li><li><p>《地方国家税务局关于调整个体工商户个人所得税附征率的公告》给出了税费自主调节的依据；</p></li></ol><p>灵活用工从税务上说，本质是将个人视作个体户，通过委托代征、个体户登记、个人临时性经营性所得登记等形式，以核定征收或个体户经营所得纳税取代个税申报的一种节税方式。</p><p>因此以委托代征为主要形式的灵活用工结算平台，其所谓的流程合规，一般会包括：</p><ol><li>委托代征资质；</li><li>个人与结算平台签订用工协议；</li><li>依据税收洼地政策，按照0%~1.5%核定征收；</li><li>出具税务机关汇总申报的个人完税证明。</li></ol><p><strong>灵活用工结算平台如何获利:</strong></p><ol><li><p>企业通过结算平台发生结算时，向平台额外支付6-8%的综合税费+服务费，而平台本身除正常人力支出外，财税成本主要在于开具6%专票费用以及代扣代缴个税的支出。</p></li><li><p>首先结算平台向企业开具6%的增值税发票后，即需缴纳6%的增值税以及0.72%的各种附加税，在不考虑抵扣自身成本的前提下，税费成本为6.72%。一般而言，增值税中央和地方的留存比例为50:50，而地方税务出具相应的税收优惠政策后，地方留存税费返还比例可达50~90%，以比较常见的70%计算，结算平台的实际开票成本可以做到：6.72%-6%<em>50%</em>70%=4.62%，需要注意的是，一般税收洼地的返还政策会在70%左右，部分税源地会给出更高的返税政策来吸引招商入驻，当然也会在税收优惠期结束后作出的调整。</p></li><li><p>代扣代缴个税方面，在当前核定征收政策下，根据行业不同，地方税务确定的征收税率可以是0%-1.5%。因此当返税比例为地方留存的70%（可能更高），且核定征收税率分别为0%、0.5%、1%、1.5%时，结算平台发生结算的综合成本即为4.62%、5.12%、5.62%以及6.12%。</p></li><li><p>根据上述计算，可以很显然的看出，地方核定征收及返税政策决定了一家结算平台的固定成本，这也是目前市场上结算平台报价混乱的根本原因，从5.0%~8.0%都有。</p></li><li><p>值得注意的是，较低的报价可以实现，但这是基于获取高比例地方留存返税以及降低个人核定征收比例实现的，这两者对于地方税务而言是不一定是正常或长久的，会随着地方税务的政策调整而变化，当然结算平台可以通过不断更换税源地来持续跟进更优惠的税收政策。</p></li></ol>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="开源" term="开源"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[线程池的使用]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/07/13/thread</id>
        <link href="https://ahkevinxy.github.io/blog/2023/07/13/thread"/>
        <updated>2023-07-13T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[进程和线程的区别 线程池的使用]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1进程和线程的区别">1、进程和线程的区别<a href="#1进程和线程的区别" class="hash-link" aria-label="1、进程和线程的区别的直接链接" title="1、进程和线程的区别的直接链接">​</a></h2><ul><li>进程：进程是资源(CPU、内存等)分配的基本单位，它是程序执行时的一个实例。</li><li>线程：线程是一条执行路径，是程序执行时的最小单位，它是进程的一个执行流，是CPU调度和分派的基本单位，一个进程可以由很多个线程组成，线程间共享进程的所有资源，每个线程有自己的堆栈和局部变量。</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2线程池threadpoolexecutor">2、线程池：ThreadPoolExecutor<a href="#2线程池threadpoolexecutor" class="hash-link" aria-label="2、线程池：ThreadPoolExecutor的直接链接" title="2、线程池：ThreadPoolExecutor的直接链接">​</a></h2><table><thead><tr><th>线程池参数</th><th>类型</th><th>参数理解</th></tr></thead><tbody><tr><td>corePoolSize</td><td>int</td><td>核心线程数线程数定义了最小可以同时运行的线程数量</td></tr><tr><td>maximumPoolSize</td><td>int</td><td>当队列中存放的任务达到队列容量的时候，当前可以同时运行的线程数量变为最大线程数。</td></tr><tr><td>workQueue</td><td>BlockingQueue<code>&lt;Runnable&gt;</code></td><td>当新任务来的时候会先判断当前运行的线程数量是否达到核心线程数，如果达到的话，新任务就会被存放在队列中。</td></tr><tr><td>keepAliveTime</td><td>long</td><td>当线程池中的线程数量大于&nbsp;corePoolSize&nbsp;的时候，如果这时没有新的任务提交，核心线程外的线程不会立即销毁，而是会等待，直到等待的时间超过了keepAliveTime才会被回收销毁。</td></tr><tr><td>unit</td><td>TimeUnit</td><td>keepAliveTime&nbsp;参数的时间单位。</td></tr><tr><td>threadFactory</td><td>ThreadFactory</td><td>executor 创建新线程的时候会用到。</td></tr><tr><td>handler</td><td>RejectedExecutionHandler</td><td>饱和策略。</td></tr></tbody></table><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="3线程池大小的确定">3、线程池大小的确定<a href="#3线程池大小的确定" class="hash-link" aria-label="3、线程池大小的确定的直接链接" title="3、线程池大小的确定的直接链接">​</a></h2><ul><li>有一个简单并且适用面比较广的公式：</li><li>CPU 密集型任务(N+1)：&nbsp;这种任务消耗的主要是 CPU 资源，可以将线程数设置为 N（CPU 核心数）+1，比 CPU 核心数多出来的一个线程是为了防止线程偶发的缺页中断，或者其它原因导致的任务暂停而带来的影响。一旦任务暂停，CPU 就会处于空闲状态，而在这种情况下多出来的一个线程就可以充分利用 CPU 的空闲时间。</li><li>I/O 密集型任务(2N)：&nbsp;这种任务应用起来，系统会用大部分的时间来处理 I/O 交互，而线程在处理 I/O 的时间段内不会占用 CPU 来处理，这时就可以将 CPU 交出给其它线程使用。因此在 I/O 密集型任务的应用中，我们可以多配置一些线程，具体的计算方法是 2N。</li></ul>]]></content>
        <author>
            <name>flankx</name>
            <email>137472591@qq.com</email>
            <uri>https://github.com/flankx</uri>
        </author>
        <category label="线程" term="线程"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Websocket使用]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/07/13/websocket-1</id>
        <link href="https://ahkevinxy.github.io/blog/2023/07/13/websocket-1"/>
        <updated>2023-07-13T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[如何使用 java Websocket 使用方式]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="方式1原生注解">方式1：原生注解<a href="#方式1原生注解" class="hash-link" aria-label="方式1：原生注解的直接链接" title="方式1：原生注解的直接链接">​</a></h2><ul><li>监听路径：<code>@ServerEndpoint</code></li><li>建立连接：<code>@OnOpen</code></li><li>接收消息：<code>@OnMessage</code></li><li>关闭连接：<code>@OnClose</code></li><li>连接错误：<code>@OnError</code></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1-引入pom依赖">1. 引入<code>POM</code>依赖<a href="#1-引入pom依赖" class="hash-link" aria-label="1-引入pom依赖的直接链接" title="1-引入pom依赖的直接链接">​</a></h3><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-websocket</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2-配置文件">2. 配置文件<a href="#2-配置文件" class="hash-link" aria-label="2. 配置文件的直接链接" title="2. 配置文件的直接链接">​</a></h3><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token annotation punctuation" style="color:#393A34">@Configuration</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token annotation punctuation" style="color:#393A34">@EnableWebSocket</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">WebSocketConfig</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token annotation punctuation" style="color:#393A34">@Bean</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token class-name">ServerEndpointExporter</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">serverEndpointExporter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">ServerEndpointExporter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="3-连接处理">3. 连接处理<a href="#3-连接处理" class="hash-link" aria-label="3. 连接处理的直接链接" title="3. 连接处理的直接链接">​</a></h3><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token annotation punctuation" style="color:#393A34">@Slf4j</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token annotation punctuation" style="color:#393A34">@ServerEndpoint</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"/ws-demo"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token annotation punctuation" style="color:#393A34">@Component</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">TestWSEndPoint</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token class-name">ConcurrentHashMap</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">String</span><span class="token generics punctuation" style="color:#393A34">,</span><span class="token generics"> </span><span class="token generics class-name">Session</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> map </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">ConcurrentHashMap</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token annotation punctuation" style="color:#393A34">@OnOpen</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">onOpen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Session</span><span class="token plain"> session</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"接受连接: "</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> session</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  map</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">put</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">session</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getId</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> session</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token annotation punctuation" style="color:#393A34">@OnMessage</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">onMessage</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Session</span><span class="token plain"> session</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">String</span><span class="token plain"> message</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">throws</span><span class="token plain"> </span><span class="token class-name">IOException</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  session</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getBasicRemote</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">sendText</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"返回响应："</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> message</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token annotation punctuation" style="color:#393A34">@OnClose</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">onClose</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Session</span><span class="token plain"> session</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"关闭连接: "</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> session</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  map</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">remove</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">session</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getId</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token annotation punctuation" style="color:#393A34">@OnError</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">onError</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Session</span><span class="token plain"> session</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">Throwable</span><span class="token plain"> throwable</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">throws</span><span class="token plain"> </span><span class="token class-name">Exception</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"错误连接: "</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> session </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"throwable : "</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> throwable</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getMessage</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="方式2使用spring封装">方式2：使用<code>Spring</code>封装<a href="#方式2使用spring封装" class="hash-link" aria-label="方式2使用spring封装的直接链接" title="方式2使用spring封装的直接链接">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1-引入pom依赖-1">1. 引入<code>POM</code>依赖<a href="#1-引入pom依赖-1" class="hash-link" aria-label="1-引入pom依赖-1的直接链接" title="1-引入pom依赖-1的直接链接">​</a></h3><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.springframework.boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-boot-starter-websocket</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2-编写处理器websockethandler">2. 编写处理器<code>WebsocketHandler</code><a href="#2-编写处理器websockethandler" class="hash-link" aria-label="2-编写处理器websockethandler的直接链接" title="2-编写处理器websockethandler的直接链接">​</a></h3><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token annotation punctuation" style="color:#393A34">@Component</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token annotation punctuation" style="color:#393A34">@Slf4j</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">WebsocketCustomHandler</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">implements</span><span class="token plain"> </span><span class="token class-name">WebSocketHandler</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token annotation punctuation" style="color:#393A34">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">afterConnectionEstablished</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">WebSocketSession</span><span class="token plain"> session</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">throws</span><span class="token plain"> </span><span class="token class-name">Exception</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"接收到新的连接"</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> session</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getId</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token annotation punctuation" style="color:#393A34">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">handleMessage</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">WebSocketSession</span><span class="token plain"> session</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">WebSocketMessage</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics operator" style="color:#393A34">?</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> message</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">throws</span><span class="token plain"> </span><span class="token class-name">Exception</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token class-name">String</span><span class="token plain"> text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"接收到消息："</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> message</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">toString</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"session = "</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> session</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getId</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  session</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">sendMessage</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">TextMessage</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// session.sendMessage(new</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// BinaryMessage(text.getBytes(StandardCharsets.UTF_8)));</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// session.sendMessage(new PingMessage());</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// session.sendMessage(new PongMessage());</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token annotation punctuation" style="color:#393A34">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">handleTransportError</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">WebSocketSession</span><span class="token plain"> session</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">Throwable</span><span class="token plain"> exception</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">throws</span><span class="token plain"> </span><span class="token class-name">Exception</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"连接错误"</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> exception </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"session ="</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> session</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getId</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token annotation punctuation" style="color:#393A34">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">afterConnectionClosed</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">WebSocketSession</span><span class="token plain"> session</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">CloseStatus</span><span class="token plain"> closeStatus</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">throws</span><span class="token plain"> </span><span class="token class-name">Exception</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"关闭连接 = "</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> closeStatus</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">toString</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"session ="</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> session</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getId</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token annotation punctuation" style="color:#393A34">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">boolean</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">supportsPartialMessages</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 支持分片</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="3-注册handler">3. 注册<code>Handler</code><a href="#3-注册handler" class="hash-link" aria-label="3-注册handler的直接链接" title="3-注册handler的直接链接">​</a></h3><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token annotation punctuation" style="color:#393A34">@Configuration</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token annotation punctuation" style="color:#393A34">@EnableWebSocket</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">SpringWebsocketCofig</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">implements</span><span class="token plain"> </span><span class="token class-name">WebSocketConfigurer</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token annotation punctuation" style="color:#393A34">@Autowired</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token class-name">WebsocketCustomHandler</span><span class="token plain"> websocketCustomHandler</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token annotation punctuation" style="color:#393A34">@Override</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">registerWebSocketHandlers</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">WebSocketHandlerRegistry</span><span class="token plain"> registry</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  registry</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">addHandler</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">websocketCustomHandler</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"/spring-ws"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setAllowedOrigins</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"*"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="方式3使用stomp">方式3：使用<code>STOMP</code><a href="#方式3使用stomp" class="hash-link" aria-label="方式3使用stomp的直接链接" title="方式3使用stomp的直接链接">​</a></h2><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="方式4使用netty-等其他方式">方式4：使用<code>Netty</code> 等其他方式<a href="#方式4使用netty-等其他方式" class="hash-link" aria-label="方式4使用netty-等其他方式的直接链接" title="方式4使用netty-等其他方式的直接链接">​</a></h2>]]></content>
        <author>
            <name>flankx</name>
            <email>137472591@qq.com</email>
            <uri>https://github.com/flankx</uri>
        </author>
        <category label="ws" term="ws"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[开源网络货运平台]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/07/11/opensource_network_freight</id>
        <link href="https://ahkevinxy.github.io/blog/2023/07/11/opensource_network_freight"/>
        <updated>2023-07-11T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[最全开源网络货运平台,无车承运平台,结算平台]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="平台端">平台端<a href="#平台端" class="hash-link" aria-label="平台端的直接链接" title="平台端的直接链接">​</a></h2><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="拖运端">拖运端<a href="#拖运端" class="hash-link" aria-label="拖运端的直接链接" title="拖运端的直接链接">​</a></h2><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="司机端">司机端<a href="#司机端" class="hash-link" aria-label="司机端的直接链接" title="司机端的直接链接">​</a></h2><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="车主端">车主端<a href="#车主端" class="hash-link" aria-label="车主端的直接链接" title="车主端的直接链接">​</a></h2>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="payment" term="payment"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[金融支付系统]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/07/10/payment</id>
        <link href="https://ahkevinxy.github.io/blog/2023/07/10/payment"/>
        <updated>2023-07-10T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[金融支付系统架构设计 如何对接银行 如何设计金融支付系统]]></summary>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="payment" term="payment"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[深入浅出 前端 layout]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/07/08/layout</id>
        <link href="https://ahkevinxy.github.io/blog/2023/07/08/layout"/>
        <updated>2023-07-08T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[如何解决 前端 layout 布局问题,深入剖析 前端布局问题]]></summary>
        <content type="html"><![CDATA[<p>站在一个后端开发者的角度,写css 其实是一个非常痛点的问题
如何更好的使用css 进行页面布局一直困扰着我
本篇文章主要从前端基本的layout 布局进行深入学习 css </p>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="css" term="css"/>
        <category label="前端" term="前端"/>
        <category label="基础知识" term="基础知识"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[初探 webvitals]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/07/08/webvitals</id>
        <link href="https://ahkevinxy.github.io/blog/2023/07/08/webvitals"/>
        <updated>2023-07-08T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[webvitals是什么 如何巧妙使用 webvitals]]></summary>
        <content type="html"><![CDATA[<p>web-vitals是Google发起的，旨在提供各种质量信号的统一指南，我们相信这些质量信号对提供出色的网络用户体验至关重要。多年来，Google 提供了许多性能测量和性能报告工具。一些开发者对这些工具的使用十分在行，而另一些开发者则发现大量的工具和指标令人应接不暇。</p><p>总之，Web Vitals则是希望提出一些标准，来帮助开发者去测量，优化页面，给到用户更好的体验。</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="简单介绍六个指标">简单介绍六个指标<a href="#简单介绍六个指标" class="hash-link" aria-label="简单介绍六个指标的直接链接" title="简单介绍六个指标的直接链接">​</a></h2><ol><li>FCP-反映的是从页面开始加载到页面视口上最大的图片或者文本块渲染的时间。</li><li>TTI-反映从页面加载开始到页面处于完全可交互状态所花费的时间。</li><li>Speed Index-页面内容可见填充的速度。</li><li>TBT-测量首次内容绘制 (FCP)首次内容绘制和 (TTI)之间的总时间，这期间，主线程被阻塞的时间过长，无法作出输入响应。</li><li>LCP-最大内容绘制，用于监控网页可视区内“绘制面积”最大的元素开始呈现在屏幕上的时间点。</li><li>CLS-反映网页布局在加载期间的偏移量。得分范围是 0–1，其中 0 表示没有偏移，1 表示最大偏移。</li></ol>]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Goland 使用技巧]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/07/06/goland</id>
        <link href="https://ahkevinxy.github.io/blog/2023/07/06/goland"/>
        <updated>2023-07-06T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Goland 最强实用技巧,goland 快捷键 goland 如何高效开发]]></summary>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="go" term="go"/>
        <category label="Goland" term="Goland"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[免费个人blog]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/07/05/blog</id>
        <link href="https://ahkevinxy.github.io/blog/2023/07/05/blog"/>
        <updated>2023-07-05T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[免费blog 清单 如何选择属于自己的blog blog如何搭建与选择]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="gatsby">Gatsby<a href="#gatsby" class="hash-link" aria-label="Gatsby的直接链接" title="Gatsby的直接链接">​</a></h2><p>Gatsby 包含了很多功能，有一个丰富的插件生态系统，并且能够做Docusaurus所做的一切。 当然，这带来了较陡的学习曲线。 Gatsby 在许多方面做得都很出色，适合构建许多类型的网站。 另一方面，Docusaurus 力图将一件事做到尽善尽美——成为最好的内容撰写与发布工具。</p><p>GraphQL 是 Gatsby 的核心，但搭建 Gatsby 网站不一定要用到它。 而在大多数静态网站中，你更不需要 GraphQL 所提供的灵活性。</p><p>Docusaurus 2 的许多方面都被 Gatsby 的出色之处所启发，这是一个优秀的替代品。</p><p>Docz 是一款用于构建文档网站的Gatsby主题。</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="nextjs">Next.js<a href="#nextjs" class="hash-link" aria-label="Next.js的直接链接" title="Next.js的直接链接">​</a></h2><p> 它可以帮助你构建出色的文档网站，但它并不着重于文档功能本身，而且需要你手动实现 Docusaurus 所自带的功能。</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="vuepress">VuePress<a href="#vuepress" class="hash-link" aria-label="VuePress的直接链接" title="VuePress的直接链接">​</a></h2><p>VuePress 是 Vue 驱动的，而 Docusaurus 则是 React 驱动的。 如果你想要一个基于 Vue 的解决方案，VuePress 是个不错的选择。</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="mkdocs">MkDocs<a href="#mkdocs" class="hash-link" aria-label="MkDocs的直接链接" title="MkDocs的直接链接">​</a></h2><p>MkDocs is a popular Python static site generator with value propositions similar to Docusaurus.</p><p>如果你不需要单页应用，也不打算利用 React 的话，这是个好选择。</p><p>Material for MkDocs is a beautiful theme.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="docsify">Docsify<a href="#docsify" class="hash-link" aria-label="Docsify的直接链接" title="Docsify的直接链接">​</a></h2><p>Docsify makes it easy to create a documentation website, but is not a static-site generator and is not SEO friendly.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="gitbook">Gitbook<a href="#gitbook" class="hash-link" aria-label="Gitbook的直接链接" title="Gitbook的直接链接">​</a></h2><p>GitBook has a very clean design and has been used by many open source projects. 但随着它把重点逐渐从开源工具转向商业产品，它不再符合开源项目文档网站的需要。 结果就是，许多项目转用了其他产品。 You may read about Redux's switch to Docusaurus here.</p><p>目前，GitBook 只对开源和非营利团队免费</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="jekyll">Jekyll<a href="#jekyll" class="hash-link" aria-label="Jekyll的直接链接" title="Jekyll的直接链接">​</a></h2><p>Jekyll is one of the most mature static site generators around and has been a great tool to use — in fact, before Docusaurus, most of Facebook's Open Source websites are/were built on Jekyll! 它的上手难度极低。 在静态网站构建方面，我们想要为你带来和 Jekyll 类似的开发者体验。</p>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="blog" term="blog"/>
        <category label="免费" term="免费"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[网络货运系统 搭建总结]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/07/05/network_freight</id>
        <link href="https://ahkevinxy.github.io/blog/2023/07/05/network_freight"/>
        <updated>2023-07-05T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[网络货运平台搭建开发 政策指导 网络货运平台如何搭建 网络货运平台如何申请 网络货运如何选择技术 网络货运是什么]]></summary>
        <content type="html"><![CDATA[<p>网络货运是在利用互联网技术开发的车货匹配平台的基础上发展起来的，通过互联网平台加数字化技术引用，在大数据的介入下，促使货运全网互联互通，借助智慧物流模式进行行业升级。</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="网络平台服务功能">网络平台服务功能<a href="#网络平台服务功能" class="hash-link" aria-label="网络平台服务功能的直接链接" title="网络平台服务功能的直接链接">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="线上服务能力要求">线上服务能力要求<a href="#线上服务能力要求" class="hash-link" aria-label="线上服务能力要求的直接链接" title="线上服务能力要求的直接链接">​</a></h3><ol><li>取得增值电信业务许可证(<strong>公司名称与网络货运经营申请人名称一致</strong>)</li><li>符合国家关于信息系统安全等级保护的要求(<strong>单位名称与网络货运经营申请人名称一致</strong>)</li><li>网络平台接入省级网络货运信息监测平台(答辩后进行接入)</li><li>满足功能要求</li></ol><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="功能要求">功能要求<a href="#功能要求" class="hash-link" aria-label="功能要求的直接链接" title="功能要求的直接链接">​</a></h3><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="信息发布">信息发布<a href="#信息发布" class="hash-link" aria-label="信息发布的直接链接" title="信息发布的直接链接">​</a></h4><p>网络货运经营者依托网络平台为托运人、实际承运人提供真实、有效的货源及运力信息，并对货源及车源信息进行管理，包括但不限于信息发布、筛选、修改、推送、撤回等功能</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="线上交易">线上交易<a href="#线上交易" class="hash-link" aria-label="线上交易的直接链接" title="线上交易的直接链接">​</a></h4><p>网络货运经营者应通过网络平台在线组织运力，进行货源、运力资源的有效整合，实现信息精准配置，生成电子运单，完成线上交易。</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="全程监控">全程监控<a href="#全程监控" class="hash-link" aria-label="全程监控的直接链接" title="全程监控的直接链接">​</a></h4><p>网络平台应自行或者使用第三方平台对运输地点、轨迹、状态进行动态监控，具备对装货、卸货、结算等进行有效管控的功能和物流信息全流程跟踪、记录、存储、分析能力；应记录含有时间和地理位置信息的实时行驶轨迹数据；宜实时展示实际承运驾驶员、车辆运输轨迹，并实现实际承运人相关资格证件到期预警提示、违规行为报警等功能。</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="金融支付">金融支付<a href="#金融支付" class="hash-link" aria-label="金融支付的直接链接" title="金融支付的直接链接">​</a></h4><p>网络平台应具备核销对账、交易明细查询、生成资金流水单等功能，宜具备在线支付功能。</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="咨询投诉">咨询投诉<a href="#咨询投诉" class="hash-link" aria-label="咨询投诉的直接链接" title="咨询投诉的直接链接">​</a></h4><p>网络平台应具备咨询、举报投诉、结果反馈等功能。</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="在线评价">在线评价<a href="#在线评价" class="hash-link" aria-label="在线评价的直接链接" title="在线评价的直接链接">​</a></h4><p>网络平台应具备对托运、实际承运人进行信用打分及评级的功能</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="查询统计">查询统计<a href="#查询统计" class="hash-link" aria-label="查询统计的直接链接" title="查询统计的直接链接">​</a></h4><p>网络平台应具备信息查询功能，包括运单、资金流水、运输轨迹、信用记录、投诉处理等信息分类分户查询以及数据统计分析的功能</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="数据调取">数据调取<a href="#数据调取" class="hash-link" aria-label="数据调取的直接链接" title="数据调取的直接链接">​</a></h4><p>网络平台应具备交通运输、税务等相关部门依法调取数据的条件</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="服务流程及要求">服务流程及要求<a href="#服务流程及要求" class="hash-link" aria-label="服务流程及要求的直接链接" title="服务流程及要求的直接链接">​</a></h3><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="信息审核">信息审核<a href="#信息审核" class="hash-link" aria-label="信息审核的直接链接" title="信息审核的直接链接">​</a></h4><h5 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="托运人信息">托运人信息<a href="#托运人信息" class="hash-link" aria-label="托运人信息的直接链接" title="托运人信息的直接链接">​</a></h5><p>网络货运经营者应在平台上登记并核对托运人信息：托运人为法人的，信息包括托运单位及法人代表名称、统一社会信用代码、联系人、联系方式、通信地址等基本信息，留存营业执照扫描件；托运人为自然人的，信息包括托运人姓名、有效证件号码、联系方式，留存有效证件扫描件。</p><h5 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="实际承运人信息">实际承运人信息<a href="#实际承运人信息" class="hash-link" aria-label="实际承运人信息的直接链接" title="实际承运人信息的直接链接">​</a></h5><p>网络货运经营者应要求实际承运人在网络平台注册登记并核对以下信息：实际承运人名称、道路运输经营许可证号、统一社会信用代码（或身份证号）等基本信息；驾驶员姓名、身份证号、联系方式、道路运输从业资格证号、机动车驾驶证号；车辆牌照号、车牌颜色、车辆道路运输证号、车辆行驶证档案编号、车辆总质量、核定载质量、外廓尺寸（4.5吨及以下普通道路货物运输车辆从事普通道路货物运输经营的，无需登记道路运输经营许可证号、道路运输证号、驾驶员从业资格证号）。</p><p>网络货运经营者应留存以下有效证件扫描件：实际承运人营业执照、身份证等扫描件；驾驶员身份证、机动车驾驶证、道路运输从业资格证；车辆行驶证、道路运输证（挂车、4.5吨及以下普通道路货物运输车辆从事普通道路货物运输经营的，无需上传道路运输经营许可证、道路运输证、驾驶员从业资格证）。</p><p>网络货运经营者应对实际承运人资质信息进行审核，通过审核后方能委托其承担运输业务。</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="签订合同">签订合同<a href="#签订合同" class="hash-link" aria-label="签订合同的直接链接" title="签订合同的直接链接">​</a></h4><p>网络货运经营者应按照《中华人民共和国合同法》的要求，分别与托运人和实际承运人签订运输合同，主要内容应包括但不限于：</p><ol><li>当事人信息：包括托运人、收货人、网络货运经营者、实际承运人的名称、联系方式</li><li>服务内容：包括货物信息、运输方式、起讫地、运输价格、时效要求等</li><li>当事人权利义务关系</li><li>合同保存时间自签订之日起不少于3年。</li></ol><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="运输过程监控">运输过程监控<a href="#运输过程监控" class="hash-link" aria-label="运输过程监控的直接链接" title="运输过程监控的直接链接">​</a></h4><p>网络货运经营者应在生成运单号码后，实时采集实际承运车辆运输轨迹的动态信息，并在货物起运和确认送达时，经驾驶员授权同意后，实时采集和上传驾驶员地理位置信息，实现交易、运输、结算等各环节全过程透明化动态管理。网络货运经营者使用12吨及以上的重型普通载货汽车和半挂牵引车承担运输任务时，应督促实际承运人保持车载卫星定位装置在线。</p><p>网络货运经营者应确保线上提供服务的车辆和驾驶员与线下实际提供服务的车辆和驾驶员一致。
网络货运经营者不得虚构运输交易相互委托运输服务。</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="交付验收">交付验收<a href="#交付验收" class="hash-link" aria-label="交付验收的直接链接" title="交付验收的直接链接">​</a></h4><h5 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="交接装货">交接装货<a href="#交接装货" class="hash-link" aria-label="交接装货的直接链接" title="交接装货的直接链接">​</a></h5><p>网络货运经营者应当在许可的经营范围内从事经营活动，不得违规承运危险货物</p><p>网络货运经营者从事零担货物运输的，应当按照《零担货物道路运输服务规范》的相关要求，对托运人身份进行查验登记，督促实际承运人对货物进行安全检查或者开封验视。</p><p>网络货运经营者接到实际承运人有关发现违禁物品、可疑物品或瞒报危险物品报告的，应向公安机关或有关部门及时报告。</p><h5 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="交付卸货">交付卸货<a href="#交付卸货" class="hash-link" aria-label="交付卸货的直接链接" title="交付卸货的直接链接">​</a></h5><p>收货人确认收货后，实际承运人应及时将交付信息上传至货运经营者网络平台。</p><p>货物交付时存在异议的，网络货运经营者应及时处理。</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="运费结算">运费结算<a href="#运费结算" class="hash-link" aria-label="运费结算的直接链接" title="运费结算的直接链接">​</a></h4><h5 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="结算流程">结算流程<a href="#结算流程" class="hash-link" aria-label="结算流程的直接链接" title="结算流程的直接链接">​</a></h5><p>网络货运经营者应按照合同约定及时向实际承运人支付运费</p><h5 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="支付方式">支付方式<a href="#支付方式" class="hash-link" aria-label="支付方式的直接链接" title="支付方式的直接链接">​</a></h5><p>网络货运经营者宜与银行等金融机构、第三方支付平台合作，通过电子支付实现交易留痕</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="信息上传">信息上传<a href="#信息上传" class="hash-link" aria-label="信息上传的直接链接" title="信息上传的直接链接">​</a></h4><p>网络货运经营者应按照《部网络货运信息交互系统接入指南》的要求，在收货人确认收货后，实时将运单数据上传至省级网络货运信息监测系统。</p><p>网络货运经营者应在结算完成后，实时将资金流水单信息上传至省级网络货运信息监测系统。</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="保险理赔">保险理赔<a href="#保险理赔" class="hash-link" aria-label="保险理赔的直接链接" title="保险理赔的直接链接">​</a></h4><p>鼓励网络货运经营者采用投保网络平台道路货物运输承运人责任险等措施，保障托运人合法权益。</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="投诉处理">投诉处理<a href="#投诉处理" class="hash-link" aria-label="投诉处理的直接链接" title="投诉处理的直接链接">​</a></h4><ol><li>网络货运经营者应建立便捷有效的投诉举报机制，公开投诉举报方式等信息，包括服务电话、投诉方式、处理流程等。鼓励网络货运经营者建立投诉举报在线解决机制。</li><li>网络货运经营者应在接到投诉举报后24小时内给予有效响应，及时处理并将结果告知投诉方。</li><li>网络货运经营者应加强对举报、投诉处理相关信息的汇总分析，在网络平台公示投诉处理满意率。及时查找管理不足和漏洞，制定改进措施，不断提高服务质量。</li></ol><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="信用评价">信用评价<a href="#信用评价" class="hash-link" aria-label="信用评价的直接链接" title="信用评价的直接链接">​</a></h4><p>网络货运经营者应建立对实际承运人公平公正的信用评价体系，围绕运输效率、运输安全、服务质量、客户满意度等方面进行综合考核评价，评价结果在网络平台上公示。根据信用评价结果建立<code>实际承运人退出机制</code></p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="安全及风险管控要求">安全及风险管控要求<a href="#安全及风险管控要求" class="hash-link" aria-label="安全及风险管控要求的直接链接" title="安全及风险管控要求的直接链接">​</a></h3><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="安全生产处理">安全生产处理<a href="#安全生产处理" class="hash-link" aria-label="安全生产处理的直接链接" title="安全生产处理的直接链接">​</a></h4><h5 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="安全生产管理制度">安全生产管理制度<a href="#安全生产管理制度" class="hash-link" aria-label="安全生产管理制度的直接链接" title="安全生产管理制度的直接链接">​</a></h5><p>网络货运经营者应建立健全适合网络货运经营特点的安全生产责任制度、安全生产业务操作规程、驾驶员和车辆资质登记查验制度、托运人身份查验登记制度等，设立相应的安全生产管理部门或者配备专职安全管理人员。</p><h5 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="应急管理">应急管理<a href="#应急管理" class="hash-link" aria-label="应急管理的直接链接" title="应急管理的直接链接">​</a></h5><p>网络货运经营者应制定安全生产事故应急救援预案。发生事故或不可抗力事件时，第一时间启动应急预案，组织实际承运人进行应急处置，并积极配合相关部门开展应急救援。</p><p>网络货运经营者应跟踪了解行业动态和各方诉求，及时化解和疏导矛盾，并向有关部门报告。</p><h5 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="安全人员考核">安全人员考核<a href="#安全人员考核" class="hash-link" aria-label="安全人员考核的直接链接" title="安全人员考核的直接链接">​</a></h5><p>网络货运经营者的主要负责人和安全生产管理人员应当由县级以上交通运输主管部门对其安全生产知识和管理能力考核合格</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="信息安全管理">信息安全管理<a href="#信息安全管理" class="hash-link" aria-label="信息安全管理的直接链接" title="信息安全管理的直接链接">​</a></h4><h5 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="建立信息安全管理制度">建立信息安全管理制度<a href="#建立信息安全管理制度" class="hash-link" aria-label="建立信息安全管理制度的直接链接" title="建立信息安全管理制度的直接链接">​</a></h5><p>网络货运经营者应按照《中华人民共和国网络安全法》等有关法律法规的要求，采取有效措施防病毒、防攻击、防泄密，落实网络安全管理责任。</p><h5 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="加强信息使用管理">加强信息使用管理<a href="#加强信息使用管理" class="hash-link" aria-label="加强信息使用管理的直接链接" title="加强信息使用管理的直接链接">​</a></h5><p>网络货运经营者应按照合法、正当、必要的原则，采集与网络货运经营相关的数据信息，采集的信息未经被采集者同意，不得用于网络货运以外的其他用途，不得转让给第三方。</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="司机权益保护">司机权益保护<a href="#司机权益保护" class="hash-link" aria-label="司机权益保护的直接链接" title="司机权益保护的直接链接">​</a></h4><p>网络货运经营者不得利用市场垄断地位排除、限制竞争，随意压低运价，损害货车司机权益；应按照合同约定及时支付运费，不得拖欠运费；不得提供虚假信息、扰乱市场秩序；应合理安排运输计划、保障货车司机合理休息，避免疲劳驾驶。</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="网络货运信息交互系统接入指南">网络货运信息交互系统接入指南<a href="#网络货运信息交互系统接入指南" class="hash-link" aria-label="网络货运信息交互系统接入指南的直接链接" title="网络货运信息交互系统接入指南的直接链接">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="接入要求">接入要求<a href="#接入要求" class="hash-link" aria-label="接入要求的直接链接" title="接入要求的直接链接">​</a></h3><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="数据加密要求">数据加密要求<a href="#数据加密要求" class="hash-link" aria-label="数据加密要求的直接链接" title="数据加密要求的直接链接">​</a></h4><p>根据《信息安全技术信息系统安全等级保护基本要求》（GB/T 22239）相关规定，各省交通运输主管部门应确保数据传输的安全性。部交互系统和省级监测系统之间进行数据交换，应通过国密加密算法对报文进行加密</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="时效质量要求">时效质量要求<a href="#时效质量要求" class="hash-link" aria-label="时效质量要求的直接链接" title="时效质量要求的直接链接">​</a></h4><p>网络货运经营者应在运单、资金流水单完成后实时上传数据至省级监测系统，省级监测系统应在接收网络货运经营者运单、资金流水单、车辆及驾驶员基本信息后，及时上传至部交互系统。省级监测系统应对网络货运经营者上传的单据格式进行校验，确保单据接入正常。</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="接口技术规范">接口技术规范<a href="#接口技术规范" class="hash-link" aria-label="接口技术规范的直接链接" title="接口技术规范的直接链接">​</a></h3><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="报文属性">报文属性<a href="#报文属性" class="hash-link" aria-label="报文属性的直接链接" title="报文属性的直接链接">​</a></h4><table><thead><tr><th>序号</th><th>属性名称</th><th>说明</th></tr></thead><tbody><tr><td>1</td><td>报文层</td><td>标识数据元在报文结构中的位置和层次关系</td></tr><tr><td>2</td><td>英文名称</td><td>数据元和段组的英文标记名,可用作为扩展标记语言(XML)</td></tr><tr><td>3</td><td>中文名称</td><td>对数据元的中文描述</td></tr><tr><td>4</td><td>约束/出现次数</td><td>数据元在报文中重复出现的次数 <br> 1. 0..1——数据元值域可填，且出现一次 <br> 2. 0..n——数据元值域可填，且可出现多次 <br> 3.  1..1——数据元值域必填，且出现一次 <br> 4. 1..n——数据元值域必填，且可出现多次</td></tr><tr><td>5</td><td>数据格式</td><td></td></tr><tr><td>6</td><td>引用文件</td><td>代码型数据元值域引用的标准。</td></tr><tr><td>7</td><td>说明</td><td>对数据元的简要解释和应用说明</td></tr><tr><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="网络货运单据报文格式">网络货运单据报文格式<a href="#网络货运单据报文格式" class="hash-link" aria-label="网络货运单据报文格式的直接链接" title="网络货运单据报文格式的直接链接">​</a></h4><p>省级监测系统上传单据接口报文格式如下：
表2.2 网络货运单据报文格式</p><table><thead><tr><th>序号</th><th>报文层</th><th>英文名称</th><th>中文名称</th><th>约束/出现次数</th><th>数据格式</th><th>说明</th></tr></thead><tbody><tr><td>1</td><td>1</td><td>Root</td><td>根</td><td>1..1</td><td></td><td></td></tr><tr><td>2</td><td>2</td><td>Header</td><td>报文头</td><td>1..1</td><td></td><td></td></tr><tr><td>3</td><td>3</td><td>MessageReferenceNumber</td><td>报文参考号</td><td>1..1</td><td>an..35</td><td>必填，报文的唯一标识符，由系统按GUID规则自动产生。</td></tr><tr><td>4</td><td>3</td><td>DocumentName</td><td>报文名称</td><td>1..1</td><td>an..35</td><td>必填，报文中文名称：电子运单、位置信息单、资金流水单、车辆信息单、驾驶员信息单。</td></tr><tr><td>5</td><td>3</td><td>DocumentVersionNumber</td><td>报文版本号</td><td>1..1</td><td>an..17</td><td></td></tr><tr><td>6</td><td>3</td><td>SenderCode</td><td>发送方代码</td><td>1..1</td><td>an..20</td><td>必填，省级监测系统交换代码。</td></tr><tr><td>7</td><td>3</td><td>MessageSendingDateTime</td><td>发送日期时间</td><td>1..1</td><td>n14	必填，报文发送的日期时间。YYYYMMDDhhmmss</td><td></td></tr><tr><td>8</td><td>3</td><td>IPCType</td><td>业务接口代码</td><td>1..1</td><td>an..16</td><td></td></tr><tr><td>9</td><td>3</td><td>Token</td><td>令牌</td><td>1..1</td><td>an..200</td><td></td></tr><tr><td>10</td><td>2</td><td>Body</td><td>报文体</td><td>1..1</td><td></td><td></td></tr><tr><td>11</td><td>3</td><td>EncryptedCode</td><td>对称密钥加密串</td><td>1..1</td><td>an..128</td><td>必填，用国密SM2加密随机生成KEY后的加密字符串。</td></tr><tr><td>12</td><td>3</td><td>EncryptedContent</td><td>运单内容加密串</td><td>1..1</td><td>an..8192</td><td>必填，采用国密SM4通过随机生成的KEY加密运单内容后的加密字符串。</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="上传运单接口">上传运单接口<a href="#上传运单接口" class="hash-link" aria-label="上传运单接口的直接链接" title="上传运单接口的直接链接">​</a></h4><p>业务接口代码：WLHY_YD1001，省级监测系统通过此接口向部交互系统上报企业的运单数据，运单报文格式如下：</p><h5 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="运单内容">运单内容<a href="#运单内容" class="hash-link" aria-label="运单内容的直接链接" title="运单内容的直接链接">​</a></h5><table><thead><tr><th>序号</th><th>报文层</th><th>英文名称</th><th>中文名称</th><th>约束/出现次数</th><th>数据格式</th><th>说明</th></tr></thead><tbody><tr><td>1</td><td>1</td><td>OriginalDocumentNumber</td><td>原始单号</td><td>1..1</td><td>an..35</td><td>必填，上游企业委托运输单号。</td></tr><tr><td>2</td><td>1</td><td>ShippingNoteNumber</td><td>托运单号</td><td>1..1</td><td>an..20</td><td>必填，本运单单号。</td></tr><tr><td>3</td><td></td><td>SendToProDateTime</td><td>运单上传时间</td><td>1..1</td><td>n14</td><td>必填，网络货运经营者上传运单到省级监测系统的时间。YYYYMMDDhhmmss</td></tr><tr><td>4</td><td>1</td><td>Carrier</td><td>网络货运经营者名称</td><td>1..1</td><td>an..512</td><td>必填。</td></tr><tr><td>5</td><td>1</td><td>UnifiedSocialCreditIdentifier</td><td>统一社会信用代码</td><td>1..1</td><td>an18</td><td>必填。</td></tr><tr><td>6</td><td>1</td><td>PermitNumber</td><td>道路运输经营许可证编号</td><td>1..1</td><td>an..50</td><td>必填，网络货运经营者的道路运输经营许可证编号，网络货运经营者整合车辆全部为总质量4.5吨及以下普通货运车辆的，可填“企业所在地行政区划代码+000000”。</td></tr><tr><td>7</td><td>1</td><td>ConsignmentDateTime</td><td>运单生成时间</td><td>1..1</td><td>n14</td><td></td></tr><tr><td>8</td><td>1</td><td>BusinessTypeCode</td><td>业务类型代码</td><td>1..1</td><td>an..7</td><td>必填，代码集参见wlhy.mot.gov.cn。</td></tr><tr><td>9</td><td>1</td><td>DespatchActualDateTime</td><td>发货日期时间</td><td>1..1</td><td>n14</td><td></td></tr><tr><td>10</td><td>1</td><td>GoodsReceiptDateTime</td><td>收货日期时间</td><td>1..1</td><td>n14</td><td>必填，货物运到后的签收时间。YYYYMMDDhhmmss</td></tr><tr><td>11</td><td>1</td><td>ConsignorInfo</td><td>托运人信息</td><td>1..1</td><td></td><td></td></tr><tr><td>12</td><td>2</td><td>Consignor</td><td>托运人名称</td><td>1..1</td><td>an..512</td><td>必填。</td></tr><tr><td>13</td><td>2</td><td>ConsignorID</td><td>托运人统一社会信用代码或个人证件号</td><td>1..1</td><td>an..35</td><td>必填。</td></tr><tr><td>14</td><td>2</td><td>PlaceOfLoading</td><td>装货地址</td><td>0..1</td><td>an..256</td><td>选填，实际装货的地点。</td></tr><tr><td>15</td><td>2</td><td>CountrySubdivisionCode</td><td>装货地点的国家行政区划代码</td><td>1..1</td><td>an..12</td><td>必填，参照最新版《中华人民共和国行政区划代码》（GB/T 2260-2017），精确到区县。</td></tr><tr><td>16</td><td>1</td><td>ConsigneeInfo</td><td>收货方信息</td><td>1..1</td><td></td><td></td></tr><tr><td>17</td><td>2</td><td>Consignee</td><td>收货方名称</td><td>1..1</td><td>an..512	必填。</td><td></td></tr><tr><td>18</td><td>2</td><td>ConsigneeID</td><td>收货方统一社会信用代码或个人证件号码</td><td>1..1</td><td>an..35</td><td>必填。</td></tr><tr><td>19</td><td>2</td><td>GoodsReceiptPlace</td><td>收货地址</td><td>0..1</td><td>an..256</td><td>选填。</td></tr><tr><td>20</td><td>2</td><td>CountrySubdivisionCode</td><td>收货地点的国家行政区划代码</td><td>1..1</td><td>an..12</td><td>必填，参照最新版《中华人民共和国行政区划代码》（GB/T 2260-2017），精确到区县。</td></tr><tr><td>21</td><td>1</td><td>TotalMonetaryAmount</td><td>运费金额</td><td>1..1</td><td>n..18,3</td><td>必填，托运人与网络货运经营者签订运输合同确定的运费金额，货币单位为人民币（元），保留3位小数，如整数的话，以.000填充。如是一笔业务分几辆车运，需将托运人针对这笔业务付给网络货运经营者的运输费用分摊到每辆车上。</td></tr><tr><td>22</td><td>1</td><td>VehicleInfo</td><td>车辆信息</td><td>1..1</td><td></td><td></td></tr><tr><td>23</td><td>2</td><td>VehiclePlateColorCode</td><td>车牌颜色代码</td><td>1..1</td><td>an..2</td><td>必填，代码集参见wlhy.mot.gov.cn。</td></tr><tr><td>24</td><td>2</td><td>VehicleNumber</td><td>车辆牌照号</td><td>1..1</td><td>an..35</td><td>必填。</td></tr><tr><td>25</td><td>2</td><td>Driver</td><td>驾驶员</td><td>1..n</td><td></td><td></td></tr><tr><td>26</td><td>3</td><td>DriverName</td><td>姓名</td><td>1..1</td><td>an..30</td><td>必填，驾驶员姓名。</td></tr><tr><td>27</td><td>3</td><td>DrivingLicense</td><td>机动车驾驶证编号</td><td>1..1</td><td>an..18</td><td>必填，根据机动车驾驶证填写。</td></tr><tr><td>28</td><td>2</td><td>GoodsInfo</td><td>货物信息</td><td>1..n</td><td></td><td>如一车货有不同货物，则可循环。</td></tr><tr><td>29</td><td>3</td><td>DescriptionOfGoods</td><td>货物名称</td><td>1..1</td><td>an..512</td><td>必填。</td></tr><tr><td>30</td><td>3</td><td>CargoTypeClassificationCode</td><td>货物类型 分类代码</td><td>1..1</td><td>an..3</td><td>必填，代码集参见wlhy.mot.gov.cn。</td></tr><tr><td>31</td><td>3</td><td>GoodsItemGrossWeight</td><td>货物项毛重</td><td>1..1</td><td>n..14,3</td><td>必填，重量单位以KGM千克填写数值，保留3位小数，如整数的话，以.000填充。小数点不计入总长。如是轻泡货等货物，请估算重量。如一笔业务分几辆车运，需报送每辆车实际运输的货物重量。</td></tr><tr><td>32</td><td>3</td><td>Cube</td><td>体积</td><td>0..1</td><td>n..9,4</td><td>选填，体积单位以DMQ立方米填写数值，保留4位小数，如整数的话，以.0000填充。小数点不计入总长。</td></tr><tr><td>33</td><td>3</td><td>TotalNumberOfPackages</td><td>总件数</td><td>0..1</td><td>n..8</td><td>选填。</td></tr><tr><td>34</td><td>1</td><td>ActualCarrierInfo</td><td>实际承运人信息</td><td></td><td>1</td><td></td></tr><tr><td>35</td><td>2</td><td>ActualCarrierName</td><td>实际承运人名称</td><td>1..1</td><td>an..256</td><td>必填，与网络货运经营者签订运输合同，实际完成运输的经营者。 取得道路运输经营许可证的个体运输业户，直接填写“许可证上的业户名称”； 其他情况填写“运输公司名称（实际承运驾驶员姓名）”。</td></tr><tr><td>36</td><td>2</td><td>ActualCarrierBusinessLicense</td><td>实际承运人道路运输经营许可证号</td><td>1..1</td><td>an..50</td><td>必填，实际承运人的道路运输经营许可证编号，网络货运经营者整合车辆全部为总质量4.5吨及以下普通货运车辆的，可填“车籍地6位行政区域代码+000000”。</td></tr><tr><td>37</td><td>2</td><td>ActualCarrierID</td><td>实际承运人统一社会信用代码或证件号码</td><td>1..1</td><td>an..50</td><td>必填。</td></tr><tr><td>38</td><td>1</td><td>InsuranceInformation</td><td>保险信息</td><td>1..1</td><td></td><td>必填。</td></tr><tr><td>39</td><td>2</td><td>PolicyNumber</td><td>保险单号</td><td>1..1</td><td>an..30</td><td>必填，未投保的，可填none。</td></tr><tr><td>40</td><td>2</td><td>InsuranceCompany</td><td>保险公司 名称</td><td>1..1</td><td>an..30</td><td>必填，代码集参见wlhy.mot.gov.cn。未投保的，可填“无”。</td></tr><tr><td>41</td><td>1</td><td>Remark</td><td>备注</td><td>0..1</td><td>an..256</td><td>选填。</td></tr></tbody></table>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="网络货运" term="网络货运"/>
        <category label="知识" term="知识"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Saas IaaS Paas 区别]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/07/04/saas</id>
        <link href="https://ahkevinxy.github.io/blog/2023/07/04/saas"/>
        <updated>2023-07-04T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Saas IaaS Paas 区别 与介绍 什么是Saas 系统 如何搭建属于企业的Saas系统]]></summary>
        <content type="html"><![CDATA[<h1>Saas IaaS Paas 区别</h1><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="saas-软件即服务">Saas (软件即服务)<a href="#saas-软件即服务" class="hash-link" aria-label="Saas (软件即服务)的直接链接" title="Saas (软件即服务)的直接链接">​</a></h2><blockquote><p>SaaS提供商为企业搭建信息化所需要的所有网络基础设施及软件、硬件运作平台，并负责所有前期的实施、后期的维护等一系列服务，企业无需购买软硬件、建设机房、招聘IT人员，即可通过互联网使用信息系统</p></blockquote><p>钉钉，企业微信</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="iaas-基础架构即服务">Iaas (基础架构即服务)<a href="#iaas-基础架构即服务" class="hash-link" aria-label="Iaas (基础架构即服务)的直接链接" title="Iaas (基础架构即服务)的直接链接">​</a></h2><blockquote><p>基于云的服务，按需付费，用于存储，网络和虚拟化等服务</p></blockquote><p>AWS 阿里云 腾讯云 等</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="paas-平台即服务">Paas (平台即服务)<a href="#paas-平台即服务" class="hash-link" aria-label="Paas (平台即服务)的直接链接" title="Paas (平台即服务)的直接链接">​</a></h2><blockquote><p>Internet上可用的硬件和软件工具</p></blockquote><p>Microsoft Windows Azure，百度BAE、新浪SAE、京东云擎JAE</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="iaaspaas和saas之间有什么区别">IaaS，PaaS和SaaS之间有什么区别？<a href="#iaaspaas和saas之间有什么区别" class="hash-link" aria-label="IaaS，PaaS和SaaS之间有什么区别？的直接链接" title="IaaS，PaaS和SaaS之间有什么区别？的直接链接">​</a></h2><p>在托管定制应用程序时，IaaS可以为您提供最大程度的灵活性，并为数据存储提供通用数据中心。</p><p>PaaS通常建立在IaaS平台之上，以减少系统管理的需求。它使您可以专注于应用程序开发，而不是基础架构管理。</p><p>SaaS提供满足特定业务需求的即用型解决方案。大多数现代SaaS平台都建立在IaaS或PaaS平台上。</p><p>您可能选择从一种云计算服务模型开始，或者找到对这三种模型的需求：这取决于业务的规模和复杂性</p>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="saas" term="saas"/>
        <category label="知识" term="知识"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[命令行常用快捷键及汇总]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/06/27/terminal_command</id>
        <link href="https://ahkevinxy.github.io/blog/2023/06/27/terminal_command"/>
        <updated>2023-06-27T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[命令行常用终端快捷键及汇总 控制面板快捷操作 终端快捷操作 终端快捷键  如何快速使用命令行终端 命令行终端快捷键操作]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="常用快捷键">常用快捷键<a href="#常用快捷键" class="hash-link" aria-label="常用快捷键的直接链接" title="常用快捷键的直接链接">​</a></h2><ul><li><code>tab</code> 命令补全 文件名补全</li><li><code>ctrl + c </code> 取消当前命令 </li><li><code>ctrl + z</code> 后端运行</li><li><code>ctrl + s</code> 暂停当前终端</li><li><code>ctrl + q</code> 恢复当前终端</li><li><code>ctrl + a </code> 光标移动到行首</li><li><code>ctrl + e</code> 光标移动到行尾</li><li><code>ctrl + f</code> 光标移动向前 下个单词</li><li><code>ctrl + b</code> 光标返回 移动前一个单词</li><li><code>ctrl + u</code> 删除光标所在位置左边与行首之间的所有字符</li><li><code>ctrl + k</code> 删除光标所在位置与行尾所有字段</li><li><code>ctrl + w</code> 删除光标所在位置前任意个空格及其前的一个单词，或光标所在位置左边至所在单词首的所有字符。</li><li><code>alt + d</code> 删除光标所在位置后任意个空格及其后的一个单词，或光标所在位置至所在单词尾的所有字符</li><li><code>ctrl + y </code> 复制你上一次删除或剪切的条目</li><li><code>alt +u</code> 转换光标所在位置后的一个单词为大写，或光标所在单词位置至此单词尾的字母为大写</li><li><code>alt +i </code> 转换光标所在位置后的一个单词为小写，或光标所在单词位置至此单词尾的字母为小写</li><li><code>alt + .</code> 在光标处输入最近历史命令的最后一个字符串，如果此命令只有单个字符串，则输入此字符串。可持续使用以持续切换为更前的命令</li><li><code>ctrl + r </code> 依据用户在：提示符后的输入字符串匹配查找 history 记录中命令条目</li><li><code>ctrl + g</code>   从历史搜索模式（Ctrl + r）退出</li><li><code>!num</code> 执行 history 记录中第 num 条命令条目，num 正整数时，为正序；负数时，为反序</li><li><code>!string:p</code>  输出最近的以 string 开头的命令条目。等同 !?string?</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="使用技巧">使用技巧<a href="#使用技巧" class="hash-link" aria-label="使用技巧的直接链接" title="使用技巧的直接链接">​</a></h3><ul><li><code>!!</code> 输出并执行最近已执行过的一条命令</li><li><code>!num:p</code>  输出第 num 条命令条目，不执行</li><li><code>!num:gs/str1/str2/ </code> 将第 num 条命令条目中的 str1 字符串替换为str2，（若不加 g，则仅替换第一个匹配）</li><li><code>!string </code> 输出最近已执行过的以 string 开头的命令条目。等同 !?string?</li><li><code>!?string? </code>  输出最近已执行过的以 string 开头的命令条目。等同 !string</li><li><code>!string:p</code> 输出最近已执行过的以 string 开头的命令条目</li><li><code>^abc</code> 删除最近已执行过的命令中的 abc 字符串，并执行</li><li><code>\^foo\^bar</code>  将最近已执行过的命令中的 foo 字符串替换为 bar，并执行</li><li><code>!$</code> 执行最近已执行过的命令中的最后一个参数</li><li><code>!*</code> 执行最近已执行过的命令中的所有参数</li><li><code>!*:p</code> 输出最近已执行过的命令中的所有参数</li></ul>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="cmd" term="cmd"/>
        <category label="基础知识" term="基础知识"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[github workflows]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/06/09/github-workflows</id>
        <link href="https://ahkevinxy.github.io/blog/2023/06/09/github-workflows"/>
        <updated>2023-06-09T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[github workflows  发布 如何使用 github workflows 一键部署 一键发布]]></summary>
        <content type="html"><![CDATA[<p>工作流是一个可配置的自动化过程，将运行一个或多个作业。工作流是由签入到存储库中的YAML文件定义的，当存储库中的事件触发工作流时，工作流就会运行，也可以手动触发工作流，或者按照已定义的时间表触发工作流。</p><p>工作流定义在存储库的.github/ Workflows目录中，并且存储库可以有多个工作流，每个工作流可以执行一组不同的任务。例如，您可以有一个工作流来构建和测试拉取请求，另一个工作流在每次创建发布时部署您的应用程序，还有另一个工作流在每次有人打开新问题时添加标签。</p><p><a href="https://docs.github.com/zh/actions/using-workflows/about-workflows" target="_blank" rel="noopener noreferrer">官方文档</a></p><h1>玩转github 之 workflows</h1><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="workflows-能做哪些">workflows 能做哪些<a href="#workflows-能做哪些" class="hash-link" aria-label="workflows 能做哪些的直接链接" title="workflows 能做哪些的直接链接">​</a></h2><p>GitHub Actions 是一种持续集成和持续交付 (CI/CD) 平台，可用于自动执行生成、测试和部署管道。 您可以创建工作流程来构建和测试存储库的每个拉取请求，或将合并的拉取请求部署到生产环境。</p><p>GitHub Actions 不仅仅是 DevOps，还允许您在存储库中发生其他事件时运行工作流程。 例如，您可以运行工作流程，以便在有人在您的存储库中创建新问题时自动添加相应的标签。</p><p>GitHub 提供 Linux、Windows 和 macOS 虚拟机来运行工作流程，或者您可以在自己的数据中心或云基础架构中托管自己的自托管运行器。</p><p>作业是工作流中在同一运行器上执行的一组步骤。 每个步骤要么是一个将要执行的 shell 脚本，要么是一个将要运行的动作。 步骤按顺序执行，并且相互依赖。 由于每个步骤都在同一运行器上执行，因此您可以将数据从一个步骤共享到另一个步骤。 例如，可以有一个生成应用程序的步骤，后跟一个测试已生成应用程序的步骤。</p><p>您可以配置作业与其他作业的依赖关系；默认情况下，作业没有依赖关系，并且彼此并行运行。 当一个作业依赖于另一个作业时，它将等待从属作业完成，然后才能运行。 例如，对于没有依赖关系的不同体系结构，您可能有多个生成作业，以及一个依赖于这些作业的打包作业。 生成作业将并行运行，当它们全部成功完成后，打包作业将运行。</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="如何使用-workflows">如何使用 workflows<a href="#如何使用-workflows" class="hash-link" aria-label="如何使用 workflows的直接链接" title="如何使用 workflows的直接链接">​</a></h2><ol><li><p>在存储库中，创建 <code>.github/workflows/</code> 目录来存储工作流文件。</p></li><li><p>在 <code>.github/workflows/ </code> 目录中，创建一个名为 learn-github-actions.yml 的新文件并添加以下代码。</p></li><li><p>提交这些更改并将其推送到您的 GitHub 仓库。</p></li></ol><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="了解-workflows-的文件">了解 workflows 的文件<a href="#了解-workflows-的文件" class="hash-link" aria-label="了解 workflows 的文件的直接链接" title="了解 workflows 的文件的直接链接">​</a></h2><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">''</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># 可选 - 工作流的名称，它将显示在 GitHub 存储库的“操作”选项卡中。</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">run-name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">''</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># 可选 - 从工作流生成的工作流运行的名称，该名称将显示在存储库的“操作”选项卡上的工作流运行列表中。此示例使用包含 github 上下文的表达式来显示触发了工作流运行的参与者的用户名。 有关详细信息</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">on</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">''</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># 指定此工作流程的触发器。 此示例使用 push 事件，因此每当有人将更改推送到存储库或合并拉取请求时都会触发工作流运行。 这是由到每个分支的推送触发的</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">jobs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">''</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># 工作流中运行的所有作业组合在一起</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">check-bats-version</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">''</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">#  check-bats-version: 定义一个名为 check-bats-version 作业。 子键将定义作业的属性</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">runs-on</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">''</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># 将作业配置为在最新版本的 Ubuntu Linux 运行器上运行。 这意味着该作业将在 GitHub 托管的新虚拟机上执行</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">steps</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># 将在 check-bats-version 作业中运行的所有步骤组合在一起。 此部分下嵌套的每项都是一个单独的操作或 shell 脚本</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">uses</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">''</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># uses 关键字指定此步骤将运行 actions/checkout 操作的 v3。 这是一个将存储库签出到运行器上的操作，允许您对代码（如生成和测试工具）运行脚本或其他操作。 每当工作流程将针对存储库的代码运行时，都应使用签出操作。</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">with</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">''</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># 此步骤使用 actions/setup-node@v3 操作安装指定的 Node.js 版本（本示例使用 v14）。 这会将 node 和 npm 命令都放在 PATH 中</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">run</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">''</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">#       run 关键字指示作业在运行器上执行命令。 在这种情况下，你使用 npm 来安装 bats 软件测试包</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="如何发布blog-通过workflows">如何发布blog 通过workflows<a href="#如何发布blog-通过workflows" class="hash-link" aria-label="如何发布blog 通过workflows的直接链接" title="如何发布blog 通过workflows的直接链接">​</a></h2><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="发布自己的-workflows">发布自己的 workflows<a href="#发布自己的-workflows" class="hash-link" aria-label="发布自己的 workflows的直接链接" title="发布自己的 workflows的直接链接">​</a></h2><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="总结">总结<a href="#总结" class="hash-link" aria-label="总结的直接链接" title="总结的直接链接">​</a></h2>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="github" term="github"/>
        <category label="知识" term="知识"/>
        <category label="玩转github" term="玩转github"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[github .github 目录介绍]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/06/05/github</id>
        <link href="https://ahkevinxy.github.io/blog/2023/06/05/github"/>
        <updated>2023-06-05T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[github .github目录介绍 github 你不知道的秘密]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="github-介绍">github 介绍<a href="#github-介绍" class="hash-link" aria-label="github 介绍的直接链接" title="github 介绍的直接链接">​</a></h2><p>GitHub 是一个用于版本控制和协作的代码托管平台。 它允许您和其他人随时随地协同处理项目。</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="设置-git">设置 git<a href="#设置-git" class="hash-link" aria-label="设置 git的直接链接" title="设置 git的直接链接">​</a></h2><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="创建仓库">创建仓库<a href="#创建仓库" class="hash-link" aria-label="创建仓库的直接链接" title="创建仓库的直接链接">​</a></h2><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="创建仓库分支">创建仓库分支<a href="#创建仓库分支" class="hash-link" aria-label="创建仓库分支的直接链接" title="创建仓库分支的直接链接">​</a></h2><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="参与项目">参与项目<a href="#参与项目" class="hash-link" aria-label="参与项目的直接链接" title="参与项目的直接链接">​</a></h2><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="社交化">社交化<a href="#社交化" class="hash-link" aria-label="社交化的直接链接" title="社交化的直接链接">​</a></h2><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="github-通信">github 通信<a href="#github-通信" class="hash-link" aria-label="github 通信的直接链接" title="github 通信的直接链接">​</a></h2><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="github-词汇表">github 词汇表<a href="#github-词汇表" class="hash-link" aria-label="github 词汇表的直接链接" title="github 词汇表的直接链接">​</a></h2><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="git-备忘清单">git 备忘清单<a href="#git-备忘清单" class="hash-link" aria-label="git 备忘清单的直接链接" title="git 备忘清单的直接链接">​</a></h2><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="学习资源">学习资源<a href="#学习资源" class="hash-link" aria-label="学习资源的直接链接" title="学习资源的直接链接">​</a></h2>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="github" term="github"/>
        <category label="知识" term="知识"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[显卡参数介绍]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/06/02/graphics_card</id>
        <link href="https://ahkevinxy.github.io/blog/2023/06/02/graphics_card"/>
        <updated>2023-06-02T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[高端显卡介绍,任何选择显卡,显卡你需要懂的知识]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="独立显卡">独立显卡<a href="#独立显卡" class="hash-link" aria-label="独立显卡的直接链接" title="独立显卡的直接链接">​</a></h2><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="集成显卡">集成显卡<a href="#集成显卡" class="hash-link" aria-label="集成显卡的直接链接" title="集成显卡的直接链接">​</a></h2>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="知识" term="知识"/>
        <category label="百科" term="百科"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[docusaurus bing SEO 优化]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/05/31/bing</id>
        <link href="https://ahkevinxy.github.io/blog/2023/05/31/bing"/>
        <updated>2023-05-31T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[bing docusaurus seo 优化 细则 搜索引擎优化]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="docusaurus-seo">docusaurus seo<a href="#docusaurus-seo" class="hash-link" aria-label="docusaurus seo的直接链接" title="docusaurus seo的直接链接">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="page-metadata">page metadata<a href="#page-metadata" class="hash-link" aria-label="page metadata的直接链接" title="page metadata的直接链接">​</a></h3><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">meta</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag attr-value" style="color:#e3116c">keywords</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">content</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag attr-value" style="color:#e3116c">cooking, blog</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">head</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="头部进行配置">头部进行配置<a href="#头部进行配置" class="hash-link" aria-label="头部进行配置的直接链接" title="头部进行配置的直接链接">​</a></h3><div class="language-markdown codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-markdown codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token front-matter-block punctuation" style="color:#393A34">---</span><span class="token front-matter-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token front-matter-block"></span><span class="token front-matter-block front-matter yaml language-yaml key atrule" style="color:#00a4db">title</span><span class="token front-matter-block front-matter yaml language-yaml punctuation" style="color:#393A34">:</span><span class="token front-matter-block front-matter yaml language-yaml"> 给搜索引擎看的标题；可能和正文标题不一样</span><br></span><span class="token-line" style="color:#393A34"><span class="token front-matter-block front-matter yaml language-yaml"></span><span class="token front-matter-block front-matter yaml language-yaml key atrule" style="color:#00a4db">description</span><span class="token front-matter-block front-matter yaml language-yaml punctuation" style="color:#393A34">:</span><span class="token front-matter-block front-matter yaml language-yaml"> 关于此页的简短描述</span><br></span><span class="token-line" style="color:#393A34"><span class="token front-matter-block front-matter yaml language-yaml"></span><span class="token front-matter-block front-matter yaml language-yaml key atrule" style="color:#00a4db">image</span><span class="token front-matter-block front-matter yaml language-yaml punctuation" style="color:#393A34">:</span><span class="token front-matter-block front-matter yaml language-yaml"> 在社交媒体卡片中显示的缩略图</span><br></span><span class="token-line" style="color:#393A34"><span class="token front-matter-block front-matter yaml language-yaml"></span><span class="token front-matter-block front-matter yaml language-yaml key atrule" style="color:#00a4db">keywords</span><span class="token front-matter-block front-matter yaml language-yaml punctuation" style="color:#393A34">:</span><span class="token front-matter-block front-matter yaml language-yaml"> </span><span class="token front-matter-block front-matter yaml language-yaml punctuation" style="color:#393A34">[</span><span class="token front-matter-block front-matter yaml language-yaml">描述</span><span class="token front-matter-block front-matter yaml language-yaml punctuation" style="color:#393A34">,</span><span class="token front-matter-block front-matter yaml language-yaml"> 中心的</span><span class="token front-matter-block front-matter yaml language-yaml punctuation" style="color:#393A34">,</span><span class="token front-matter-block front-matter yaml language-yaml"> 关键词</span><span class="token front-matter-block front-matter yaml language-yaml punctuation" style="color:#393A34">]</span><span class="token front-matter-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token front-matter-block"></span><span class="token front-matter-block punctuation" style="color:#393A34">---</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="在layout-组件添加head-元素-component">在layout 组件添加<code>&lt;Head&gt;</code> 元素 component.<a href="#在layout-组件添加head-元素-component" class="hash-link" aria-label="在layout-组件添加head-元素-component的直接链接" title="在layout-组件添加head-元素-component的直接链接">​</a></h3><div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> React </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'react'</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> Layout </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'@theme/Layout'</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> Head </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'@docusaurus/Head'</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">default</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">page</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">Layout title</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">"Page"</span><span class="token plain"> description</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">"A React page demo"</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">Head</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">meta property</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">"og:image"</span><span class="token plain"> content</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">"image.png"</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">Head</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token comment" style="color:#999988;font-style:italic">/* ... */</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">Layout</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="结构化目录">结构化目录<a href="#结构化目录" class="hash-link" aria-label="结构化目录的直接链接" title="结构化目录的直接链接">​</a></h3><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">aside</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">aside</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">nav</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">nav</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">main</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">main</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="sitemap-file">Sitemap file<a href="#sitemap-file" class="hash-link" aria-label="Sitemap file的直接链接" title="Sitemap file的直接链接">​</a></h3><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Docusaurus provides the @docusaurus/plugin-sitemap plugin, which is shipped with preset-classic by default. It autogenerates a sitemap.xml file which will be available at https://example.com/[baseUrl]/sitemap.xml after the production build. 站点地图信息可以帮助搜索引擎爬虫更准确地爬取你的网站。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="bing-seo">bing SEO<a href="#bing-seo" class="hash-link" aria-label="bing SEO的直接链接" title="bing SEO的直接链接">​</a></h2><p>将页面源代码的 <code>&lt;meta description&gt;</code> 标记中的描述长度更改为介于 25 到 160 个字符之间。</p>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="bing" term="bing"/>
        <category label="seo" term="seo"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Hugo  stack  主题安装与部署]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/05/31/hugo</id>
        <link href="https://ahkevinxy.github.io/blog/2023/05/31/hugo"/>
        <updated>2023-05-31T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Hugo  stack  主题安装与部署 搭建属于自己的blog]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="创建github-账户">创建github 账户<a href="#创建github-账户" class="hash-link" aria-label="创建github 账户的直接链接" title="创建github 账户的直接链接">​</a></h2><p><a href="https://ahkevinxy.github.io/blog/2023/05/29/vercel" target="_blank" rel="noopener noreferrer">如何创建github 并创建 github pages</a></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="git-基础知识">git 基础知识<a href="#git-基础知识" class="hash-link" aria-label="git 基础知识的直接链接" title="git 基础知识的直接链接">​</a></h2><p><a href="https://ahkevinxy.github.io/docs/backend/git/base" target="_blank" rel="noopener noreferrer">简单的git 使用技巧</a></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 初始git 项目</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> init </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 添加项目</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"> </span><span class="token builtin class-name">.</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># .表示所有 也可以指定文件添加</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 添加提交说明</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> commit -m</span><span class="token string" style="color:#e3116c">''</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># '' 加入说明介绍</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 提交 代码</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">git</span><span class="token plain">  push </span><span class="token comment" style="color:#999988;font-style:italic"># 如果第一次 可能会提示 git push --set-upstream origin master</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="使用--主题工具">使用  主题工具<a href="#使用--主题工具" class="hash-link" aria-label="使用  主题工具的直接链接" title="使用  主题工具的直接链接">​</a></h2><p><a href="https://github.com/CaiJimmy/hugo-theme-stack-starter" target="_blank" rel="noopener noreferrer">打开主题脚手架</a></p><p>点击 <code>use this template</code> 选择 Create a new repository 创建属于自己的 github pages</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="打开自己创建的项目">打开自己创建的项目<a href="#打开自己创建的项目" class="hash-link" aria-label="打开自己创建的项目的直接链接" title="打开自己创建的项目的直接链接">​</a></h2><p>点击 code  选择 code spaces </p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="下载-hugo">下载 hugo<a href="#下载-hugo" class="hash-link" aria-label="下载 hugo的直接链接" title="下载 hugo的直接链接">​</a></h2><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>信息</div><div class="admonitionContent_S0QG"><p>选择对应的 hugo 版本 <code>0.111.3</code></p><p><a href="https://github.com/gohugoio/hugo/releases/tag/v0.111.3" target="_blank" rel="noopener noreferrer">下载地址</a></p><p>选择 hugo_extended 开头下载</p></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="修改-github-workflows-文件">修改 github workflows 文件<a href="#修改-github-workflows-文件" class="hash-link" aria-label="修改 github workflows 文件的直接链接" title="修改 github workflows 文件的直接链接">​</a></h2><ul><li>deploy.yml</li></ul><div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Deploy to Github Pages</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">on</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">push</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">branches</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">master</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">pull_request</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">branches</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">master</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">jobs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">build</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">runs-on</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ubuntu</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">steps</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">uses</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> actions/checkout@v2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Cache Hugo resources</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">uses</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> actions/cache@v2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">env</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">cache-name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> cache</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">hugo</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">resources</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">with</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">path</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> resources</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">key</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> env.cache</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">name </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">uses</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> actions/setup</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">go@v2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">with</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">go-version</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"^1.17.0"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">run</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> go version</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Cache Go Modules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">uses</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> actions/cache@v2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">with</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">path</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token scalar string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">            ~/.cache/go-build</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">            ~/go/pkg/mod</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">key</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> runner.os </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">go</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">$</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> hashFiles('</span><span class="token important">**/go.sum')</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">restore-keys</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token scalar string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">            ${{ runner.os }}-go-</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Setup Hugo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">uses</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> peaceiris/actions</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">hugo@v2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">with</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">hugo-version</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"0.111.3"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">extended</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">run</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> hugo </span><span class="token punctuation" style="color:#393A34">-</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">minify </span><span class="token punctuation" style="color:#393A34">-</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">gc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Deploy 🚀</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">uses</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> JamesIves/github</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">pages</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">deploy</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">action@v4.4.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">with</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">branch</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> gh</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">pages</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">folder</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> public</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">clean</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">single-commit</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>变更
hugo-version: "latest" ==&gt; hugo-version: "0.111.3"</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="设置-项目--settings">设置 项目  settings<a href="#设置-项目--settings" class="hash-link" aria-label="设置 项目  settings的直接链接" title="设置 项目  settings的直接链接">​</a></h2><ol><li>点击 Actions </li><li>选择 General </li><li>选择 <code>Workflow permissions</code> </li><li>选择 <code> Read and write permissions</code> </li></ol><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="创建新的页面">创建新的页面<a href="#创建新的页面" class="hash-link" aria-label="创建新的页面的直接链接" title="创建新的页面的直接链接">​</a></h2><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> hugo new post/2023/05/31/new.md</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>信息</div><div class="admonitionContent_S0QG"><p>需要改 文件头</p><div class="language-markdown codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-markdown codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token front-matter-block punctuation" style="color:#393A34">---</span><span class="token front-matter-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token front-matter-block"></span><span class="token front-matter-block front-matter yaml language-yaml key atrule" style="color:#00a4db">title</span><span class="token front-matter-block front-matter yaml language-yaml punctuation" style="color:#393A34">:</span><span class="token front-matter-block front-matter yaml language-yaml"> </span><span class="token front-matter-block front-matter yaml language-yaml string" style="color:#e3116c">"Hugo"</span><span class="token front-matter-block front-matter yaml language-yaml"></span><br></span><span class="token-line" style="color:#393A34"><span class="token front-matter-block front-matter yaml language-yaml"></span><span class="token front-matter-block front-matter yaml language-yaml key atrule" style="color:#00a4db">description</span><span class="token front-matter-block front-matter yaml language-yaml punctuation" style="color:#393A34">:</span><span class="token front-matter-block front-matter yaml language-yaml"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token front-matter-block front-matter yaml language-yaml"></span><span class="token front-matter-block front-matter yaml language-yaml key atrule" style="color:#00a4db">date</span><span class="token front-matter-block front-matter yaml language-yaml punctuation" style="color:#393A34">:</span><span class="token front-matter-block front-matter yaml language-yaml"> </span><span class="token front-matter-block front-matter yaml language-yaml datetime number" style="color:#36acaa">2023-05-31T08:42:48Z</span><span class="token front-matter-block front-matter yaml language-yaml"></span><br></span><span class="token-line" style="color:#393A34"><span class="token front-matter-block front-matter yaml language-yaml"></span><span class="token front-matter-block front-matter yaml language-yaml key atrule" style="color:#00a4db">image</span><span class="token front-matter-block front-matter yaml language-yaml punctuation" style="color:#393A34">:</span><span class="token front-matter-block front-matter yaml language-yaml"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token front-matter-block front-matter yaml language-yaml"></span><span class="token front-matter-block front-matter yaml language-yaml key atrule" style="color:#00a4db">math</span><span class="token front-matter-block front-matter yaml language-yaml punctuation" style="color:#393A34">:</span><span class="token front-matter-block front-matter yaml language-yaml"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token front-matter-block front-matter yaml language-yaml"></span><span class="token front-matter-block front-matter yaml language-yaml key atrule" style="color:#00a4db">license</span><span class="token front-matter-block front-matter yaml language-yaml punctuation" style="color:#393A34">:</span><span class="token front-matter-block front-matter yaml language-yaml"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token front-matter-block front-matter yaml language-yaml"></span><span class="token front-matter-block front-matter yaml language-yaml key atrule" style="color:#00a4db">hidden</span><span class="token front-matter-block front-matter yaml language-yaml punctuation" style="color:#393A34">:</span><span class="token front-matter-block front-matter yaml language-yaml"> </span><span class="token front-matter-block front-matter yaml language-yaml boolean important" style="color:#36acaa">false</span><span class="token front-matter-block front-matter yaml language-yaml"></span><br></span><span class="token-line" style="color:#393A34"><span class="token front-matter-block front-matter yaml language-yaml"></span><span class="token front-matter-block front-matter yaml language-yaml key atrule" style="color:#00a4db">comments</span><span class="token front-matter-block front-matter yaml language-yaml punctuation" style="color:#393A34">:</span><span class="token front-matter-block front-matter yaml language-yaml"> </span><span class="token front-matter-block front-matter yaml language-yaml boolean important" style="color:#36acaa">true</span><span class="token front-matter-block front-matter yaml language-yaml"></span><br></span><span class="token-line" style="color:#393A34"><span class="token front-matter-block front-matter yaml language-yaml"></span><span class="token front-matter-block front-matter yaml language-yaml key atrule" style="color:#00a4db">draft</span><span class="token front-matter-block front-matter yaml language-yaml punctuation" style="color:#393A34">:</span><span class="token front-matter-block front-matter yaml language-yaml"> </span><span class="token front-matter-block front-matter yaml language-yaml boolean important" style="color:#36acaa">true</span><span class="token front-matter-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token front-matter-block"></span><span class="token front-matter-block punctuation" style="color:#393A34">---</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>需要将 <code>draft</code>: <code>true</code> 删除 </p></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="提交对应代码">提交对应代码<a href="#提交对应代码" class="hash-link" aria-label="提交对应代码的直接链接" title="提交对应代码的直接链接">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="命令行提交">命令行提交<a href="#命令行提交" class="hash-link" aria-label="命令行提交的直接链接" title="命令行提交的直接链接">​</a></h3><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">git</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"> </span><span class="token builtin class-name">.</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> commit -m</span><span class="token string" style="color:#e3116c">'test'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> push </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="githubdesktop">githubDesktop<a href="#githubdesktop" class="hash-link" aria-label="githubDesktop的直接链接" title="githubDesktop的直接链接">​</a></h3>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="hugo" term="hugo"/>
        <category label="blog" term="blog"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[vercel免费blog 搭建教程]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/05/29/vercel</id>
        <link href="https://ahkevinxy.github.io/blog/2023/05/29/vercel"/>
        <updated>2023-05-29T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[vercel 免费blog 搭建 个人免费blog 如何搭建个人blog 一键式blog搭建]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="注册-github">注册 github<a href="#注册-github" class="hash-link" aria-label="注册 github的直接链接" title="注册 github的直接链接">​</a></h2><blockquote><p>注册地址 <a href="https://github.com/signup?source=login" target="_blank" rel="noopener noreferrer">https://github.com/signup?source=login</a></p></blockquote><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="创建属于-github-pages-项目-httpsgithubcomnew">创建属于 github pages 项目 <a href="https://github.com/new" target="_blank" rel="noopener noreferrer">https://github.com/new</a><a href="#创建属于-github-pages-项目-httpsgithubcomnew" class="hash-link" aria-label="创建属于-github-pages-项目-httpsgithubcomnew的直接链接" title="创建属于-github-pages-项目-httpsgithubcomnew的直接链接">​</a></h2><p>规则 名字 + github.io</p><p><a target="_blank" href="/assets/files/blog_vercel_01-6bd707605454587a2489b2888d70516e.png"><img loading="lazy" alt="注册 github pages" src="/assets/images/blog_vercel_01-6bd707605454587a2489b2888d70516e.png" width="1388" height="844" class="img_ev3q"></a></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="上传代码">上传代码<a href="#上传代码" class="hash-link" aria-label="上传代码的直接链接" title="上传代码的直接链接">​</a></h2><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># git 未设置 email 或者username 需要设置一下</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> config --global user.name </span><span class="token string" style="color:#e3116c">"Your Name"</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># 自己github名称</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> config --global user.email </span><span class="token string" style="color:#e3116c">"youremail@yourdomain.com"</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># 自己github 注册邮箱</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 查看是否生效</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> config --list</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"# Libxy.github.io"</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token plain"> README.md</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> init</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"> README.md</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> commit -m </span><span class="token string" style="color:#e3116c">"first commit"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> branch -M main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> remote </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"> origin https://github.com/Libxy/Libxy.github.io.git</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> push -u origin main</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="注册-verce">注册 verce<a href="#注册-verce" class="hash-link" aria-label="注册 verce的直接链接" title="注册 verce的直接链接">​</a></h2><blockquote><p><a href="https://vercel.com/" target="_blank" rel="noopener noreferrer">https://vercel.com/</a></p></blockquote><p>使用github 快捷登录</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="创建项目">创建项目<a href="#创建项目" class="hash-link" aria-label="创建项目的直接链接" title="创建项目的直接链接">​</a></h3><blockquote><p><a href="https://vercel.com/new" target="_blank" rel="noopener noreferrer">https://vercel.com/new</a></p></blockquote><p>选择 github 项目  <a href="https://github.com/Libxy/Libxy.github.io.git" target="_blank" rel="noopener noreferrer">https://github.com/Libxy/Libxy.github.io.git</a></p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="导入项目">导入项目<a href="#导入项目" class="hash-link" aria-label="导入项目的直接链接" title="导入项目的直接链接">​</a></h3><p><a target="_blank" href="/assets/files/blog_vercel_02-946eceda662514fc5f726786c0801662.png"><img loading="lazy" alt="导入项目" src="/assets/images/blog_vercel_02-946eceda662514fc5f726786c0801662.png" width="910" height="700" class="img_ev3q"></a></p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="发布项目">发布项目<a href="#发布项目" class="hash-link" aria-label="发布项目的直接链接" title="发布项目的直接链接">​</a></h3><p><a target="_blank" href="/assets/files/blog_vercel_03-8b81dbfa8a5371cecbef3dd06995b108.png"><img loading="lazy" alt="发布项目" src="/assets/images/blog_vercel_03-8b81dbfa8a5371cecbef3dd06995b108.png" width="1526" height="1008" class="img_ev3q"></a></p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="添加-domain-映射">添加 domain 映射<a href="#添加-domain-映射" class="hash-link" aria-label="添加 domain 映射的直接链接" title="添加 domain 映射的直接链接">​</a></h3><p><a target="_blank" href="/assets/files/blog_vercel_05-0540e57db8e808748ed3b0989457fe90.png"><img loading="lazy" alt="发布项目" src="/assets/images/blog_vercel_05-0540e57db8e808748ed3b0989457fe90.png" width="1362" height="855" class="img_ev3q"></a></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="访问自己的映射的网站">访问自己的映射的网站<a href="#访问自己的映射的网站" class="hash-link" aria-label="访问自己的映射的网站的直接链接" title="访问自己的映射的网站的直接链接">​</a></h2>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="vercel" term="vercel"/>
        <category label="blog" term="blog"/>
        <category label="免费" term="免费"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[招商银行银企直联 go sdk]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/05/25/go-cmb</id>
        <link href="https://ahkevinxy.github.io/blog/2023/05/25/go-cmb"/>
        <updated>2023-05-25T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[招商银行银企直联 招商银行银企直联代发  招商银行企业直联代扣 代发代扣 代发工资 灵活用工代发代扣 招商工资卡办理 工资卡办理]]></summary>
        <content type="html"><![CDATA[<p><a target="_blank" href="/assets/files/cmb_logo-68457137dfd9694992a692db9e0d05c8.jpeg"><img loading="lazy" alt="招商银行logo" src="/assets/images/cmb_logo-68457137dfd9694992a692db9e0d05c8.jpeg" width="1996" height="969" class="img_ev3q"></a></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="介绍">介绍<a href="#介绍" class="hash-link" aria-label="介绍的直接链接" title="介绍的直接链接">​</a></h2><p>招商银行银企直联服务</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="招商银行文档-官网">招商银行文档 <a href="https://openbiz.cmbchina.com/developer/UI/business/Index.aspx" target="_blank" rel="noopener noreferrer">官网</a><a href="#招商银行文档-官网" class="hash-link" aria-label="招商银行文档-官网的直接链接" title="招商银行文档-官网的直接链接">​</a></h2><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="使用">使用<a href="#使用" class="hash-link" aria-label="使用的直接链接" title="使用的直接链接">​</a></h2><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">go get -u github.com/ahKevinXy/go-cmb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="todo">TODO<a href="#todo" class="hash-link" aria-label="TODO的直接链接" title="TODO的直接链接">​</a></h2><ul class="contains-task-list containsTaskList_mC6p"><li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->更新 models 为 proto 兼容其他语言</li><li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->优化请求参数</li><li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->完善功能</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="目录说明">目录说明<a href="#目录说明" class="hash-link" aria-label="目录说明的直接链接" title="目录说明的直接链接">​</a></h2><ul><li><code>cmb_error</code> 错误参数</li><li><code>config</code>  配置文件</li><li><code>constants</code> 常量文件</li><li><code>docs</code> 文档文件</li><li><code>handler</code> 业务处理<ul><li><code>account</code> 账户处理</li><li><code>notice</code> 通知</li><li><code>payment</code> 支付</li><li><code>payroll</code> 代发</li><li><code>payrool_old</code> 代发(旧)</li><li><code>unit_manager</code> 交易管家</li></ul></li><li><code>help</code> 工具类函数</li><li><code>models</code> 实例</li><li><code>pkg</code> 第三方包</li><li><code>testdata</code> 本地测试数据</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="账务管理">账务管理<a href="#账务管理" class="hash-link" aria-label="账务管理的直接链接" title="账务管理的直接链接">​</a></h3><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="交易管家">交易管家<a href="#交易管家" class="hash-link" aria-label="交易管家的直接链接" title="交易管家的直接链接">​</a></h3><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="代发代扣">代发代扣<a href="#代发代扣" class="hash-link" aria-label="代发代扣的直接链接" title="代发代扣的直接链接">​</a></h3><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="交易流水">交易流水<a href="#交易流水" class="hash-link" aria-label="交易流水的直接链接" title="交易流水的直接链接">​</a></h3><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="开发调试">开发调试<a href="#开发调试" class="hash-link" aria-label="开发调试的直接链接" title="开发调试的直接链接">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="生成-testdata-参数数据">生成 testdata 参数数据<a href="#生成-testdata-参数数据" class="hash-link" aria-label="生成 testdata 参数数据的直接链接" title="生成 testdata 参数数据的直接链接">​</a></h3><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 创建 testdata目录</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token function" style="color:#d73a49">mkdir</span><span class="token plain"> testdata</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 生成 testdata.go 文件</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token function" style="color:#d73a49">cp</span><span class="token plain"> -rf  testdata.go.template  testdata/testdata.go</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="录入本地测试数据">录入本地测试数据<a href="#录入本地测试数据" class="hash-link" aria-label="录入本地测试数据的直接链接" title="录入本地测试数据的直接链接">​</a></h3><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">package</span><span class="token plain"> testdata</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 商户配置</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    UserId     </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">""</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 用户ID</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Account    </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">""</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">//账户</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    UserKey    </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">""</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 用户秘钥</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    AseKey     </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">""</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 对称秘钥</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    BankLinkNo </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">""</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 分行号</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Sass平台配置</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    CmbSassName       </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">""</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Sass 名称</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    CmbSassPrivateKey </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">""</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 平台私钥</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    CmbSigdatDefault  </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">""</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 默认值</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    CmbUrl            </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">""</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 银企直联地址</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="微信交流">微信交流<a href="#微信交流" class="hash-link" aria-label="微信交流的直接链接" title="微信交流的直接链接">​</a></h2><p><a href="https://img.opencodes.top/blog/cmb/wx.png" target="_blank" rel="noopener noreferrer"><img loading="lazy" src="https://img.opencodes.top/blog/cmb/wx.png" alt="上海招商银行客户经理微信" title="wx" class="img_ev3q"></a></p>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="go" term="go"/>
        <category label="招商银行" term="招商银行"/>
        <category label="sdk" term="sdk"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[MySQL中DATE_FORMAT()函数的说明和简介]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/05/23/mysql</id>
        <link href="https://ahkevinxy.github.io/blog/2023/05/23/mysql"/>
        <updated>2023-05-23T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[MYSQL 时间函数处理 MYSQL 时间管理]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="获取时间">获取时间<a href="#获取时间" class="hash-link" aria-label="获取时间的直接链接" title="获取时间的直接链接">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="now-获取当前时间">NOW() 获取当前时间<a href="#now-获取当前时间" class="hash-link" aria-label="NOW() 获取当前时间的直接链接" title="NOW() 获取当前时间的直接链接">​</a></h3><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">NOW</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">-- 2023-05-25 13:17:50</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="curdate-获取当前日期">curdate 获取当前日期<a href="#curdate-获取当前日期" class="hash-link" aria-label="curdate 获取当前日期的直接链接" title="curdate 获取当前日期的直接链接">​</a></h3><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> CURDATE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">--2023-05-25</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="curtime-获取当前时间">CURTIME() 获取当前时间<a href="#curtime-获取当前时间" class="hash-link" aria-label="CURTIME() 获取当前时间的直接链接" title="CURTIME() 获取当前时间的直接链接">​</a></h3><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> CURTIME</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">--  13:17:50</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="获取年月日">获取年月日<a href="#获取年月日" class="hash-link" aria-label="获取年月日的直接链接" title="获取年月日的直接链接">​</a></h3><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> EXTRACT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">YEAR</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">NOW</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">-- 获取年 2023</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> EXTRACT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">MONTH</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">NOW</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">-- 获取月 5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> EXTRACT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">DAY</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">NOW</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">-- 日 25</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> EXTRACT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">HOUR</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">NOW</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">-- 获取时间 13</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> EXTRACT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">MINUTE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">NOW</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">-- 17</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> EXTRACT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">SECOND</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">NOW</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">-- 秒29</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">--  或者从日期格式字符串中获取</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> EXTRACT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">SECOND</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'2023-05-25 13:17:50'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">-- 14</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="时间处理">时间处理<a href="#时间处理" class="hash-link" aria-label="时间处理的直接链接" title="时间处理的直接链接">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="日期增加-减少">日期增加 减少<a href="#日期增加-减少" class="hash-link" aria-label="日期增加 减少的直接链接" title="日期增加 减少的直接链接">​</a></h3><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">-- 时间减少一个小时</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> date_sub</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">now</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">INTERVAL</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">hour</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 时间加一天 </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> date_add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">now</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">INTERVAL</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">day</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 其他间隔</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">INTERVAL</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">YEAR</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">INTERVAL</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">MONTH</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">INTERVAL</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">DAY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">INTERVAL</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">HOUR</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">INTERVAL</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">MINUTE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">INTERVAL</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">SECOND</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="日期格式化字符串转日期">日期格式化、字符串转日期<a href="#日期格式化字符串转日期" class="hash-link" aria-label="日期格式化、字符串转日期的直接链接" title="日期格式化、字符串转日期的直接链接">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="date_format">DATE_FORMAT<a href="#date_format" class="hash-link" aria-label="DATE_FORMAT的直接链接" title="DATE_FORMAT的直接链接">​</a></h3><p>格式化 datetime timestamp</p><ul><li>date 是要格式化的有效日期</li><li>format 预定义的说明符</li></ul><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">-- 格式化参考：</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> DATE_FORMAT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">now</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">'%Y-%m-%d %H:%i:%s'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> DATE_FORMAT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">now</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">'%Y-%m-%d %H:00:00'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 字符串转日期</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> str_to_date</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'2023-05-25 13:17:50'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'%Y-%m-%d %H:%i:%s'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">-- 2023-05-25 13:17:50</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="其它参考">其它参考<a href="#其它参考" class="hash-link" aria-label="其它参考的直接链接" title="其它参考的直接链接">​</a></h2><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">-- MySQL日期时间处理函数</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 当前日期：2017-05-12（突然发现今天512，是不是会拉防空警报）</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">NOW</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> DUAL</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 当前日期时间：2017-05-12 11:41:47</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 在MySQL里也存在和Oracle里类似的dual虚拟表：官方声明纯粹是为了满足select ... from...这一习惯问题，mysql会忽略对该表的引用。</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 那么MySQL中就不用DUAL了吧。</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">NOW</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 当前日期时间：2017-05-12 11:41:55</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 除了 now() 函数能获得当前的日期时间外，MySQL 中还有下面的函数：</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">CURRENT_TIMESTAMP</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 2017-05-15 10:19:31</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">CURRENT_TIMESTAMP</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 2017-05-15 10:19:51</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> LOCALTIME</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 2017-05-15 10:20:00</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> LOCALTIME</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 2017-05-15 10:20:10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> LOCALTIMESTAMP</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 2017-05-15 10:20:21(v4.0.6)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> LOCALTIMESTAMP</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 2017-05-15 10:20:30(v4.0.6)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 这些日期时间函数，都等同于 now()。鉴于 now() 函数简短易记，建议总是使用 now()来替代上面列出的函数。</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> SYSDATE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 当前日期时间：2017-05-12 11:42:03</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- sysdate() 日期时间函数跟 now() 类似，</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 不同之处在于：now() 在执行开始时值就得到了;sysdate() 在函数执行时动态得到值。</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 看下面的例子就明白了：</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">NOW</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> SLEEP</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">NOW</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> SYSDATE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> SLEEP</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> SYSDATE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> CURDATE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 当前日期：2017-05-12</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">CURRENT_DATE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 当前日期：等同于 CURDATE()</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">CURRENT_DATE</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 当前日期：等同于 CURDATE()</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> CURTIME</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 当前时间：11:42:47</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">CURRENT_TIME</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 当前时间：等同于 CURTIME()</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">CURRENT_TIME</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 当前时间：等同于 CURTIME()</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 获得当前 UTC 日期时间函数</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> UTC_TIMESTAMP</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> UTC_DATE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> UTC_TIME</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- MySQL 获得当前时间戳函数：current_timestamp, current_timestamp()</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">CURRENT_TIMESTAMP</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">CURRENT_TIMESTAMP</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 2017-05-15 10:32:21 | 2017-05-15 10:32:21</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- MySQL 日期时间 Extract（选取） 函数</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SET</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">@dt</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">DATE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">@dt</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 获取日期：2017-05-15</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">TIME</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 获取时间：10:37:14.123456</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">YEAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 获取年份</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">MONTH</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 获取月份</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">DAY</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 获取日</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">HOUR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 获取时</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">MINUTE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 获取分</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">SECOND</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 获取秒</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> MICROSECOND</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 获取毫秒</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> QUARTER</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 获取季度</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> WEEK</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 20 (获取周)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> WEEK</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">7</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- ****** 测试此函数在MySQL5.6下无效</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> WEEKOFYEAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 同week()</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> DAYOFYEAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 135 (日期在年度中第几天)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> DAYOFMONTH</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 5 (日期在月度中第几天)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> DAYOFWEEK</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 2 (日期在周中第几天；周日为第一天)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> WEEKDAY</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> WEEKDAY</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'2017-05-21 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 6(与dayofweek()都表示日期在周的第几天，只是参考标准不同，weekday()周一为第0天，周日为第6天)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> YEARWEEK</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 201720(年和周)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> EXTRACT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">YEAR</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> EXTRACT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">MONTH</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> EXTRACT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">DAY</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> EXTRACT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">HOUR</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> EXTRACT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">MINUTE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> EXTRACT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">SECOND</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> EXTRACT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">MICROSECOND </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> EXTRACT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">QUARTER </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> EXTRACT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">WEEK </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> EXTRACT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">YEAR_MONTH </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> EXTRACT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">DAY_HOUR </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> EXTRACT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">DAY_MINUTE </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 151037(日时分)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> EXTRACT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">DAY_SECOND </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 15103714(日时分秒)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> EXTRACT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">DAY_MICROSECOND </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 15103714123456(日时分秒毫秒)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> EXTRACT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">HOUR_MINUTE </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 1037(时分)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> EXTRACT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">HOUR_SECOND </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 103714(时分秒)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> EXTRACT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">HOUR_MICROSECOND </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 103714123456(日时分秒毫秒)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> EXTRACT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">MINUTE_SECOND </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 3714(分秒)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> EXTRACT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">MINUTE_MICROSECOND </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 3714123456(分秒毫秒)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> EXTRACT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">SECOND_MICROSECOND </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 14123456(秒毫秒)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- MySQL Extract() 函数除了没有date(),time() 的功能外，其他功能一应具全。</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 并且还具有选取‘day_microsecond' 等功能。</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 注意这里不是只选取 day 和 microsecond，而是从日期的 day 部分一直选取到 microsecond 部分。</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> DAYNAME</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- Monday(返回英文星期)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> MONTHNAME</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- May(返回英文月份)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> LAST_DAY</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'2016-02-01'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 2016-02-29 (返回月份中最后一天)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> LAST_DAY</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'2016-05-01'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 2016-05-31</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- DATE_ADD(date,INTERVAL expr type) 从日期加上指定的时间间隔</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- type参数可参考：http://www.w3school.com.cn/sql/func_date_sub.asp</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> DATE_ADD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token keyword" style="color:#00009f">INTERVAL</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">YEAR</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 表示：2018-05-15 10:37:14.123456</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> DATE_ADD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token keyword" style="color:#00009f">INTERVAL</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> QUARTER</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 表示：2017-08-15 10:37:14.123456</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> DATE_ADD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token keyword" style="color:#00009f">INTERVAL</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">MONTH</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 表示：2017-06-15 10:37:14.123456</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> DATE_ADD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token keyword" style="color:#00009f">INTERVAL</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> WEEK</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 表示：2017-05-22 10:37:14.123456</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> DATE_ADD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token keyword" style="color:#00009f">INTERVAL</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">DAY</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 表示：2017-05-16 10:37:14.123456</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> DATE_ADD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token keyword" style="color:#00009f">INTERVAL</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">HOUR</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 表示：2017-05-15 11:37:14.123456</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> DATE_ADD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token keyword" style="color:#00009f">INTERVAL</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">MINUTE</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 表示：2017-05-15 10:38:14.123456</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> DATE_ADD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token keyword" style="color:#00009f">INTERVAL</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">SECOND</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 表示：2017-05-15 10:37:15.123456</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> DATE_ADD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token keyword" style="color:#00009f">INTERVAL</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> MICROSECOND</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 表示：2017-05-15 10:37:14.123457</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- DATE_SUB(date,INTERVAL expr type) 从日期减去指定的时间间隔</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> DATE_SUB</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token keyword" style="color:#00009f">INTERVAL</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">YEAR</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 表示：2016-05-15 10:37:14.123456</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> DATE_SUB</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token keyword" style="color:#00009f">INTERVAL</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> QUARTER</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 表示：2017-02-15 10:37:14.123456</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> DATE_SUB</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token keyword" style="color:#00009f">INTERVAL</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">MONTH</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 表示：2017-04-15 10:37:14.123456</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> DATE_SUB</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token keyword" style="color:#00009f">INTERVAL</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> WEEK</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 表示：2017-05-08 10:37:14.123456</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> DATE_SUB</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token keyword" style="color:#00009f">INTERVAL</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">DAY</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 表示：2017-05-14 10:37:14.123456</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> DATE_SUB</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token keyword" style="color:#00009f">INTERVAL</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">HOUR</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 表示：2017-05-15 09:37:14.123456</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> DATE_SUB</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token keyword" style="color:#00009f">INTERVAL</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">MINUTE</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 表示：2017-05-15 10:36:14.123456</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> DATE_SUB</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token keyword" style="color:#00009f">INTERVAL</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">SECOND</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 表示：2017-05-15 10:37:13.123456</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> DATE_SUB</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14.123456'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token keyword" style="color:#00009f">INTERVAL</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> MICROSECOND</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 表示：2017-05-15 10:37:14.123455</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 经特殊日期测试，DATE_SUB(date,INTERVAL expr type)可放心使用</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> DATE_SUB</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">CURDATE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token keyword" style="color:#00009f">INTERVAL</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">DAY</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 前一天：2017-05-11</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> DATE_SUB</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">CURDATE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token keyword" style="color:#00009f">INTERVAL</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">DAY</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 后一天：2017-05-13</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> DATE_SUB</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">CURDATE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token keyword" style="color:#00009f">INTERVAL</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">MONTH</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 一个月前日期：2017-04-12</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> DATE_SUB</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">CURDATE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token keyword" style="color:#00009f">INTERVAL</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">MONTH</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 一个月后日期：2017-06-12</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> DATE_SUB</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">CURDATE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token keyword" style="color:#00009f">INTERVAL</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">YEAR</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 一年前日期：2016-05-12</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> DATE_SUB</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">CURDATE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token keyword" style="color:#00009f">INTERVAL</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">YEAR</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 一年后日期：20178-06-12</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- MySQL date_sub() 日期时间函数 和 date_add() 用法一致，并且可以用INTERNAL -1 xxx的形式互换使用；</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 另外，MySQL 中还有两个函数 subdate(), subtime()，建议，用 date_sub() 来替代。</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- MySQL 另类日期函数：period_add(P,N), period_diff(P1,P2)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 函数参数“P” 的格式为“YYYYMM” 或者 “YYMM”，第二个参数“N” 表示增加或减去 N month（月）。</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- MySQL period_add(P,N)：日期加/减去N月。</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> PERIOD_ADD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">201705</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> PERIOD_ADD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">201705</span><span class="token punctuation" style="color:#393A34">,</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 201707  20170503</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- period_diff(P1,P2)：日期 P1-P2，返回 N 个月。</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> PERIOD_DIFF</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">201706</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">201703</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- datediff(date1,date2)：两个日期相减 date1 - date2，返回天数</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> DATEDIFF</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'2017-06-05'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">'2017-05-29'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 7</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- TIMEDIFF(time1,time2)：两个日期相减 time1 - time2，返回 TIME 差值</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> TIMEDIFF</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'2017-06-05 19:28:37'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'2017-06-05 17:00:00'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 02:28:37</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- MySQL日期转换函数</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> TIME_TO_SEC</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'01:00:05'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">-- 3605</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> SEC_TO_TIME</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">3605</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 01:00:05</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- MySQL （日期、天数）转换函数：to_days(date), from_days(days)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> TO_DAYS</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'0000-00-00'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">-- NULL </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> TO_DAYS</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'2017-06-05'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">-- 736850</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> FROM_DAYS</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">           </span><span class="token comment" style="color:#999988;font-style:italic">-- '0000-00-00' </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> FROM_DAYS</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">736850</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">-- '2017-06-05'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- MySQL Str to Date （字符串转换为日期）函数：str_to_date(str, format)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> STR_TO_DATE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'06.05.2017 19:40:30'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'%m.%d.%Y %H:%i:%s'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 2017-06-05 19:40:30</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> STR_TO_DATE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'06/05/2017'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'%m/%d/%Y'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">                  </span><span class="token comment" style="color:#999988;font-style:italic">-- 2017-06-05</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> STR_TO_DATE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'2017/12/3'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">'%Y/%m/%d'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">             </span><span class="token comment" style="color:#999988;font-style:italic">-- 2017-12-03</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> STR_TO_DATE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'20:09:30'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'%h:%i:%s'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">             </span><span class="token comment" style="color:#999988;font-style:italic">-- NULL(超过12时的小时用小写h，得到的结果为NULL)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 日期时间格式化</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> DATE_FORMAT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'2017-05-12 17:03:51'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'%Y年%m月%d日 %H时%i分%s秒'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 2017年05月12日 17时03分51秒(具体需要什么格式的数据根据实际情况来;小写h为12小时制;)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> TIME_FORMAT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'2017-05-12 17:03:51'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'%Y年%m月%d日 %H时%i分%s秒'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 0000年00月00日 17时03分51秒(time_format()只能用于时间的格式化)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- STR_TO_DATE()和DATE_FORMATE()为互逆操作</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- MySQL 获得国家地区时间格式函数：get_format()</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- MySQL get_format() 语法：get_format(date|time|datetime, 'eur'|'usa'|'jis'|'iso'|'internal'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- MySQL get_format() 用法的全部示例：</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> GET_FORMAT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">DATE</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">'usa'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">-- '%m.%d.%Y' </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> GET_FORMAT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">DATE</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">'jis'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">-- '%Y-%m-%d' </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> GET_FORMAT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">DATE</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">'iso'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">-- '%Y-%m-%d' </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> GET_FORMAT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">DATE</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">'eur'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">-- '%d.%m.%Y' </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> GET_FORMAT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">DATE</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">'internal'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">     </span><span class="token comment" style="color:#999988;font-style:italic">-- '%Y%m%d' </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> GET_FORMAT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">DATETIME</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">'usa'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">-- '%Y-%m-%d %H.%i.%s' </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> GET_FORMAT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">DATETIME</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">'jis'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">-- '%Y-%m-%d %H:%i:%s' </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> GET_FORMAT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">DATETIME</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">'iso'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">-- '%Y-%m-%d %H:%i:%s' </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> GET_FORMAT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">DATETIME</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">'eur'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">-- '%Y-%m-%d %H.%i.%s' </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> GET_FORMAT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">DATETIME</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">'internal'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">-- '%Y%m%d%H%i%s' </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> GET_FORMAT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">TIME</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">'usa'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">-- '%h:%i:%s %p' </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> GET_FORMAT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">TIME</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">'jis'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">-- '%H:%i:%s' </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> GET_FORMAT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">TIME</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">'iso'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">-- '%H:%i:%s' </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> GET_FORMAT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">TIME</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">'eur'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">-- '%H.%i.%s' </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> GET_FORMAT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">TIME</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">'internal'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">     </span><span class="token comment" style="color:#999988;font-style:italic">-- '%H%i%s'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- MySQL 拼凑日期、时间函数：makdedate(year,dayofyear), maketime(hour,minute,second)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> MAKEDATE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2017</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">31</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic">-- '2017-01-31' </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> MAKEDATE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2017</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">32</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic">-- '2017-02-01'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> MAKETIME</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">19</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">52</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">35</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">-- '19:52:35'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- MySQL 时区（timezone）转换函数：convert_tz(dt,from_tz,to_tz)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> CONVERT_TZ</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'2017-06-05 19:54:12'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'+08:00'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'+00:00'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">-- 2017-06-05 11:54:12</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- MySQL （Unix 时间戳、日期）转换函数</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- unix_timestamp(), unix_timestamp(date), from_unixtime(unix_timestamp), from_unixtime(unix_timestamp,format)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 将具体时间时间转为timestamp</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> UNIX_TIMESTAMP</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 当前时间的时间戳：1494815779</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> UNIX_TIMESTAMP</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'2017-05-15'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 指定日期的时间戳：1494777600</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> UNIX_TIMESTAMP</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'2017-05-15 10:37:14'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 指定日期时间的时间戳：1494815834</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- 将时间戳转为具体时间</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> FROM_UNIXTIME</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1494815834</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 2017-05-15 10:37:14</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> FROM_UNIXTIME</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1494815834</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'%Y年%m月%d日 %h时%分:%s秒'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 获取时间戳对应的格式化日期时间</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- MySQL 时间戳（timestamp）转换、增、减函数</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">TIMESTAMP</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'2017-05-15'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 2017-05-15 00:00:00</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">TIMESTAMP</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'2017-05-15 08:12:25'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'01:01:01'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 2017-05-15 09:13:26</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> DATE_ADD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'2017-05-15 08:12:25'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">INTERVAL</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">DAY</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 2017-05-16 08:12:25</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> TIMESTAMPADD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">DAY</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'2017-05-15 08:12:25'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- 2017-05-16 08:12:25; MySQL timestampadd() 函数类似于 date_add()。</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> TIMESTAMPDIFF</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">YEAR</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'2017-06-01'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'2016-05-15'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- -1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> TIMESTAMPDIFF</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">MONTH</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'2017-06-01'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'2016-06-15'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- -11</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> TIMESTAMPDIFF</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">DAY</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'2017-06-01'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'2016-06-15'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- -351</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> TIMESTAMPDIFF</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">HOUR</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'2017-06-01 08:12:25'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'2016-06-15 00:00:00'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- -8432</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> TIMESTAMPDIFF</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">MINUTE</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'2017-06-01 08:12:25'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'2016-06-15 00:00:00'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- -505932</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> TIMESTAMPDIFF</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">SECOND</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'2017-06-01 08:12:25'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'2016-06-15 00:00:00'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">-- -30355945</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="格式化参数">格式化参数<a href="#格式化参数" class="hash-link" aria-label="格式化参数的直接链接" title="格式化参数的直接链接">​</a></h2><blockquote><p>例子格式化 基于 2023-05-25 13:54:00</p></blockquote><table><thead><tr><th align="center">格式</th><th align="left">描述</th></tr></thead><tbody><tr><td align="center">%a</td><td align="left">缩写星期名  eg:(Thu)</td></tr><tr><td align="center">%b</td><td align="left">缩写月名   eg:(May)</td></tr><tr><td align="center">%c</td><td align="left">月 数字     eg:(5)</td></tr><tr><td align="center">%D</td><td align="left">带有英文前缀的月中的天  eg:(25th)</td></tr><tr><td align="center">%d</td><td align="left">月的天(00-31)  eg:(25)</td></tr><tr><td align="center">%e</td><td align="left">月的天 (0-31)</td></tr><tr><td align="center">%f</td><td align="left">微秒   eg:(000000)</td></tr><tr><td align="center">%H</td><td align="left">小时(00-23)  eg:(13)</td></tr><tr><td align="center">%h</td><td align="left">小时(01-12)  eg:(01)</td></tr><tr><td align="center">%I</td><td align="left">小时(01-12)  eg:(01)</td></tr><tr><td align="center">%i</td><td align="left">分钟(0-59)    eg:(55)</td></tr><tr><td align="center">%j</td><td align="left">年的天数(001-366) eg:(145)</td></tr><tr><td align="center">%k</td><td align="left">小时(0-23 )     eg:(13)</td></tr><tr><td align="center">%l</td><td align="left">小时(1-12)       eg:(1)</td></tr><tr><td align="center">%M</td><td align="left">月名           eg:(May)</td></tr><tr><td align="center">%m</td><td align="left">月，数值(00-12)       eg:(05)</td></tr><tr><td align="center">%p</td><td align="left">AM 或 PM  eg:(PM)</td></tr><tr><td align="center">%r</td><td align="left">时间，12-小时（hh:mm:ss AM 或 PM） eg:01:50:07 PM</td></tr><tr><td align="center">%S</td><td align="left">秒(00-59)          eg:(14)</td></tr><tr><td align="center">%s</td><td align="left">秒(00-59)            eg:(29)</td></tr><tr><td align="center">%T</td><td align="left">时间, 24-小时 (hh:mm:ss)  eg:(13:58:25)</td></tr><tr><td align="center">%U</td><td align="left">周 (00-53) 星期日是一周的第一天   eg:(21)</td></tr><tr><td align="center">%u</td><td align="left">周 (00-53) 星期一是一周的第一天  eg:(21)</td></tr><tr><td align="center">%V</td><td align="left">周(01-53) 星期天是一周的第一天,与%X使用   eg:(21)</td></tr><tr><td align="center">%v</td><td align="left">周(01-53) 星期一是一周的第一天,与%x使用   eg:(21)</td></tr><tr><td align="center">%W</td><td align="left">星期名           eg:(Thursday)</td></tr><tr><td align="center">%w</td><td align="left">周的天            eg:(4)</td></tr><tr><td align="center">%X</td><td align="left">年其中的星期日是周的第一天,4位 与%V使用   eg:(202321)</td></tr><tr><td align="center">%x</td><td align="left">年 其中的星期一是周的一天,4位与%v使用    eg:(202321)</td></tr><tr><td align="center">%Y</td><td align="left">年,4位            eg:(2023)</td></tr><tr><td align="center">%t</td><td align="left">年,2位             eg:(23)</td></tr></tbody></table>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="mysql" term="mysql"/>
        <category label="基础知识" term="基础知识"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[CPU 详解]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/05/18/cpu</id>
        <link href="https://ahkevinxy.github.io/blog/2023/05/18/cpu"/>
        <updated>2023-05-18T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[介绍]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="介绍">介绍<a href="#介绍" class="hash-link" aria-label="介绍的直接链接" title="介绍的直接链接">​</a></h2><p>中央处理器,简称 CPU( Center Processing Unit )</p><p>主要包括两个部分 <code>控制器</code> <code>运算器</code>,其中还包括 高速缓冲 存储器及实现它们之间联系的数据,控制的总线.电子计算机的三大核心部件(CPU,内存存储器,输入\输出设备).</p><p>中央处理器主要为处理指令,执行操作,控制时间,处理数据.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="i7">i7<a href="#i7" class="hash-link" aria-label="i7的直接链接" title="i7的直接链接">​</a></h2><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="i5">i5<a href="#i5" class="hash-link" aria-label="i5的直接链接" title="i5的直接链接">​</a></h2><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="i3">i3<a href="#i3" class="hash-link" aria-label="i3的直接链接" title="i3的直接链接">​</a></h2>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="CPU" term="CPU"/>
        <category label="基础知识" term="基础知识"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[git  tag]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/05/14/git</id>
        <link href="https://ahkevinxy.github.io/blog/2023/05/14/git"/>
        <updated>2023-05-14T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[获取git tag 列表]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="获取git-tag-列表">获取git tag 列表<a href="#获取git-tag-列表" class="hash-link" aria-label="获取git tag 列表的直接链接" title="获取git tag 列表的直接链接">​</a></h2><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">git</span><span class="token plain"> tag</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="创建标签">创建标签<a href="#创建标签" class="hash-link" aria-label="创建标签的直接链接" title="创建标签的直接链接">​</a></h2><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">git</span><span class="token plain"> tag -a v1.0.3 -m</span><span class="token string" style="color:#e3116c">"tag 备注"</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="查看备注">查看备注<a href="#查看备注" class="hash-link" aria-label="查看备注的直接链接" title="查看备注的直接链接">​</a></h2><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">git</span><span class="token plain">  show v1.0.3</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="对历史进行标签">对历史进行标签<a href="#对历史进行标签" class="hash-link" aria-label="对历史进行标签的直接链接" title="对历史进行标签的直接链接">​</a></h2><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">git</span><span class="token plain"> log --pretty</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">oneline</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> tag -a v1.0.3 0d52aaab44</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="提交tag">提交tag<a href="#提交tag" class="hash-link" aria-label="提交tag的直接链接" title="提交tag的直接链接">​</a></h2><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> push origin --tags</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="删除标签">删除标签<a href="#删除标签" class="hash-link" aria-label="删除标签的直接链接" title="删除标签的直接链接">​</a></h2><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">git</span><span class="token plain"> tag -d v1.0.3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> push origin --delete </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">tagname</span><span class="token operator" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="git" term="git"/>
        <category label="command" term="command"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[samba修改密码]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/05/04/samb</id>
        <link href="https://ahkevinxy.github.io/blog/2023/05/04/samb"/>
        <updated>2023-05-04T00:00:00.000Z</updated>
        <content type="html"><![CDATA[<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> smbpasswd -a </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">username</span><span class="token operator" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="samba" term="samba"/>
        <category label="群机器人" term="群机器人"/>
        <category label="go" term="go"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[go 企业微信机器人实例]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/05/04/webchat</id>
        <link href="https://ahkevinxy.github.io/blog/2023/05/04/webchat"/>
        <updated>2023-05-04T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[在终端某个群组添加机器人之后，创建者可以在机器人详情页看的该机器人特有的webhookurl。开发者可以按以下说明向这个地址发起HTTP POST 请求，即可实现给该群组发送消息]]></summary>
        <content type="html"><![CDATA[<blockquote><p>在终端某个群组添加机器人之后，创建者可以在机器人详情页看的该机器人特有的webhookurl。开发者可以按以下说明向这个地址发起HTTP POST 请求，即可实现给该群组发送消息
go 语言实现机器人推送消息</p></blockquote><ul><li>使用curl 工具</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=693axxx6-7aoc-4bc4-97a0-0ec2sifa5aaa'</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   -H </span><span class="token string" style="color:#e3116c">'Content-Type: application/json'</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   -d </span><span class="token string" style="color:#e3116c">'</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">   {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">     "msgtype": "text",</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">     "text": {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">         "content": "hello world"</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">     }</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">   }'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><p>当前自定义机器人支持文本（text）、markdown（markdown）、图片（image）、图文（news）四种消息类型</p></li><li><p>机器人的text/markdown类型消息支持在content中使用&lt;@userid&gt;扩展语法来@群成员</p></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="go-语言实现">go 语言实现<a href="#go-语言实现" class="hash-link" aria-label="go 语言实现的直接链接" title="go 语言实现的直接链接">​</a></h2><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">package</span><span class="token plain"> helps</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token string" style="color:#e3116c">"bytes"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token string" style="color:#e3116c">"encoding/json"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token string" style="color:#e3116c">"errors"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token string" style="color:#e3116c">"io"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token string" style="color:#e3116c">"fmt"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token string" style="color:#e3116c">"io/ioutil"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token string" style="color:#e3116c">"net/http"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token string" style="color:#e3116c">"net/http/cookiejar"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token string" style="color:#e3116c">"strings"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// PushMessageToQwx</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//  @Description:   推送消息到企业微信</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//  @Author  ahKevinXy</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//  @Date 2023-04-12 10:32:59</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">PushMessageToQwx</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mp </span><span class="token keyword" style="color:#00009f">map</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">]</span><span class="token keyword" style="color:#00009f">interface</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> noticeUrl </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> request</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">MakeHttpRequest</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"POST"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> noticeUrl</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> mp</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">request</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"处理结果"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> POST  </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"POST"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> GET   </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"GET"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> PUT   </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"PUT"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> PATCH </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"PATCH"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// MakeHttpRequest</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// @Description: HTTP请求</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// @Author ahKevinXy</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// @Date 2022-11-08 16:49:40</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">MakeHttpRequest</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">method</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> url </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> entity </span><span class="token keyword" style="color:#00009f">map</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">]</span><span class="token keyword" style="color:#00009f">interface</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> jar </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">cookiejar</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Jar</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> body io</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Reader</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> err </span><span class="token builtin">error</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> entity </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">switch</span><span class="token plain"> method </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> POST</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> PUT</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> PATCH</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   b</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> json</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Marshal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">entity</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">""</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   b </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> bytes</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Replace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">b</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token function" style="color:#d73a49">byte</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"\\u003c"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token function" style="color:#d73a49">byte</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"&lt;"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   b </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> bytes</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Replace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">b</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token function" style="color:#d73a49">byte</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"\\u003e"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token function" style="color:#d73a49">byte</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"&gt;"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   b </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> bytes</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Replace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">b</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token function" style="color:#d73a49">byte</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"\\u0026"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token function" style="color:#d73a49">byte</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"&amp;"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   body </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> bytes</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">NewBuffer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">b</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> GET</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">entity</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    params </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">make</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">entity</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    index </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> k</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> v </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">range</span><span class="token plain"> entity </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     _v </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Sprintf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"%v"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> v</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     params</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">index</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Sprintf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"%s=%v"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> k</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> _v</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     index</span><span class="token operator" style="color:#393A34">++</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    queryStr </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> strings</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">params</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"&amp;"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    url </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Sprintf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"%s?%s"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> url</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> queryStr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> req</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> http</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">NewRequest</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">method</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> url</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> body</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">""</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> entity </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">method </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> POST </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> method </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> PUT </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> method </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> PATCH</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  req</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Header</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Set</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"Content-Type"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"application/json;charset=utf-8"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  req</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Header</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Set</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"Accept"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"application/json"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> req</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Header</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"Connection"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"close"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> req</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Header</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Set</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"User-Agent"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"Mozilla/5.0 (X11; Linux i686; U;) Gecko/20070322 Kazehakase/0.4.5"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> client </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> http</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DefaultClient</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> jar </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  client </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">http</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Client</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Jar</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> jar</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> res</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> client</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Do</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">req</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">""</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">defer</span><span class="token plain"> res</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Body</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> res</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">StatusCode </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> http</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">StatusOK </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> res</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">StatusCode </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> http</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">StatusCreated </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> res</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">StatusCode </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> http</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">StatusNoContent </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">""</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> errors</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">New</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"http request failed to call"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> resBody</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> ioutil</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">ReadAll</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">res</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Body</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">""</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> errors</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">New</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"the response could not be read"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">string</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">resBody</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> res</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">StatusCode</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="企业微信" term="企业微信"/>
        <category label="群机器人" term="群机器人"/>
        <category label="go" term="go"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[常用MySQL 信息查询]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/04/18/mysql</id>
        <link href="https://ahkevinxy.github.io/blog/2023/04/18/mysql"/>
        <updated>2023-04-18T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[查询所有空间]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="查询所有空间">查询所有空间<a href="#查询所有空间" class="hash-link" aria-label="查询所有空间的直接链接" title="查询所有空间的直接链接">​</a></h2><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">select</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">table_schema </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'数据库'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">table_rows</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'记录数'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">truncate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data_length</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'数据容量(MB)'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">truncate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">index_length</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'索引容量(MB)'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> information_schema</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">tables</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">group</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">by</span><span class="token plain"> table_schema</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">order</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">by</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data_length</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">desc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">index_length</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">desc</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="查询空间">查询空间<a href="#查询空间" class="hash-link" aria-label="查询空间的直接链接" title="查询空间的直接链接">​</a></h2><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">select</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">table_schema </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'数据库'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">table_name </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'表名'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">table_rows </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'记录数'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">truncate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data_length</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'数据容量(MB)'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">truncate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">index_length</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'索引容量(MB)'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> information_schema</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">tables</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">order</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">by</span><span class="token plain"> data_length </span><span class="token keyword" style="color:#00009f">desc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> index_length </span><span class="token keyword" style="color:#00009f">desc</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="查看指定数据库容量大小">查看指定数据库容量大小<a href="#查看指定数据库容量大小" class="hash-link" aria-label="查看指定数据库容量大小的直接链接" title="查看指定数据库容量大小的直接链接">​</a></h2><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">select</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">table_schema </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'数据库'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">table_rows</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'记录数'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">truncate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data_length</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'数据容量(MB)'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">truncate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">index_length</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'索引容量(MB)'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> information_schema</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">tables</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">where</span><span class="token plain"> table_schema</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">'mysql'</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="查看指定数据库各表容量大小">查看指定数据库各表容量大小<a href="#查看指定数据库各表容量大小" class="hash-link" aria-label="查看指定数据库各表容量大小的直接链接" title="查看指定数据库各表容量大小的直接链接">​</a></h2><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">select</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">table_schema </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'数据库'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">table_name </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'表名'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">table_rows </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'记录数'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">truncate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data_length</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'数据容量(MB)'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">truncate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">index_length</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'索引容量(MB)'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> information_schema</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">tables</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">where</span><span class="token plain"> table_schema</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">'mysql'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">order</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">by</span><span class="token plain"> data_length </span><span class="token keyword" style="color:#00009f">desc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> index_length </span><span class="token keyword" style="color:#00009f">desc</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="mysql" term="mysql"/>
        <category label="工具" term="工具"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Go 中的sync poll]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/03/15/sync_poll</id>
        <link href="https://ahkevinxy.github.io/blog/2023/03/15/sync_poll"/>
        <updated>2023-03-15T23:07:03.000Z</updated>
        <summary type="html"><![CDATA[Go 中的waitgroup]]></summary>
        <content type="html"><![CDATA[<blockquote><p>使用场景：频繁构造结构体，分配内存，可以考虑对象池.</p></blockquote><p><a href="https://juejin.cn/post/7209625823580520504" target="_blank" rel="noopener noreferrer">from</a></p>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="Go" term="Go"/>
        <category label="Go基础知识" term="Go基础知识"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[博客]]></title>
        <id>https://ahkevinxy.github.io/blog/index</id>
        <link href="https://ahkevinxy.github.io/blog/index"/>
        <updated>2023-03-07T13:09:13.000Z</updated>
        <summary type="html"><![CDATA[典型的博客结合了文字、图像、其他博客或网站的链接及其它与主题相关的媒体，能够让读者以互动的方式留下意见，是许多博客的重要要素。大部分的博客内容以文字为主]]></summary>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
    </entry>
    <entry>
        <title type="html"><![CDATA[专业英语翻译]]></title>
        <id>https://ahkevinxy.github.io/blog/english</id>
        <link href="https://ahkevinxy.github.io/blog/english"/>
        <updated>2023-03-07T13:09:13.000Z</updated>
        <summary type="html"><![CDATA[专业英语翻译]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="微服务-microservice">微服务 Microservice<a href="#微服务-microservice" class="hash-link" aria-label="微服务 Microservice的直接链接" title="微服务 Microservice的直接链接">​</a></h2><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="栈stack">(栈)Stack<a href="#栈stack" class="hash-link" aria-label="(栈)Stack的直接链接" title="(栈)Stack的直接链接">​</a></h2><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="案例-case">案例 case<a href="#案例-case" class="hash-link" aria-label="案例 case的直接链接" title="案例 case的直接链接">​</a></h2><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="例子-example">例子 example<a href="#例子-example" class="hash-link" aria-label="例子 example的直接链接" title="例子 example的直接链接">​</a></h2><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="自由职业者-freelancer------work-工作">自由职业者 freelancer  --  work （工作）<a href="#自由职业者-freelancer------work-工作" class="hash-link" aria-label="自由职业者 freelancer  --  work （工作）的直接链接" title="自由职业者 freelancer  --  work （工作）的直接链接">​</a></h2><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="硬件-hardware">硬件 hardware<a href="#硬件-hardware" class="hash-link" aria-label="硬件 hardware的直接链接" title="硬件 hardware的直接链接">​</a></h2><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="意见反馈-feedback">意见反馈 feedback<a href="#意见反馈-feedback" class="hash-link" aria-label="意见反馈 feedback的直接链接" title="意见反馈 feedback的直接链接">​</a></h2><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="概要-summary">概要 summary<a href="#概要-summary" class="hash-link" aria-label="概要 summary的直接链接" title="概要 summary的直接链接">​</a></h2>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
    </entry>
    <entry>
        <title type="html"><![CDATA[letcode 打卡]]></title>
        <id>https://ahkevinxy.github.io/blog/letcode</id>
        <link href="https://ahkevinxy.github.io/blog/letcode"/>
        <updated>2023-03-07T13:09:13.000Z</updated>
        <summary type="html"><![CDATA[letcode 个人学习]]></summary>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="letcode" term="letcode"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[优质开源软件]]></title>
        <id>https://ahkevinxy.github.io/blog/source</id>
        <link href="https://ahkevinxy.github.io/blog/source"/>
        <updated>2023-03-07T13:09:13.000Z</updated>
        <summary type="html"><![CDATA[开源软件]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="gihub-掘金计划"><a href="https://www.zhihu.com/people/github-stars" target="_blank" rel="noopener noreferrer">Gihub 掘金计划</a><a href="#gihub-掘金计划" class="hash-link" aria-label="gihub-掘金计划的直接链接" title="gihub-掘金计划的直接链接">​</a></h2><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="开源大屏展示"><a href="https://zhuanlan.zhihu.com/p/384830720" target="_blank" rel="noopener noreferrer">开源大屏展示</a><a href="#开源大屏展示" class="hash-link" aria-label="开源大屏展示的直接链接" title="开源大屏展示的直接链接">​</a></h2><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="sns">SNS<a href="#sns" class="hash-link" aria-label="SNS的直接链接" title="SNS的直接链接">​</a></h2><ul><li><a href="https://github.com/slimkit/plus" target="_blank" rel="noopener noreferrer">ThinkSNS</a></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="笔记">笔记<a href="#笔记" class="hash-link" aria-label="笔记的直接链接" title="笔记的直接链接">​</a></h2><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>信息</div><div class="admonitionContent_S0QG"><p>An open source, markdown-based, self-hosted note taking webapp.</p></div></div><ul><li><p><a href="https://github.com/batnoter/batnoter.git" target="_blank" rel="noopener noreferrer">batnoter</a></p></li><li><p><a href="https://www.topgoer.com/" target="_blank" rel="noopener noreferrer">topgoer</a></p></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="go-学习资料全">go 学习资料(全)<a href="#go-学习资料全" class="hash-link" aria-label="go 学习资料(全)的直接链接" title="go 学习资料(全)的直接链接">​</a></h2>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="letcode" term="letcode"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[优秀博客]]></title>
        <id>https://ahkevinxy.github.io/blog/stars</id>
        <link href="https://ahkevinxy.github.io/blog/stars"/>
        <updated>2023-03-07T13:09:13.000Z</updated>
        <summary type="html"><![CDATA[开源软件]]></summary>
        <content type="html"><![CDATA[<p><a href="https://github.com/balloonwj/CppGuide" target="_blank" rel="noopener noreferrer">CppGuide</a></p><p><a href="https://csdiy.wiki/" target="_blank" rel="noopener noreferrer">陈天奇,cs入门一条龙服务</a></p>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
    </entry>
    <entry>
        <title type="html"><![CDATA[TODO]]></title>
        <id>https://ahkevinxy.github.io/blog/todos</id>
        <link href="https://ahkevinxy.github.io/blog/todos"/>
        <updated>2023-03-07T13:09:13.000Z</updated>
        <summary type="html"><![CDATA[* go unsafe 2023-3-15 2326]]></summary>
        <content type="html"><![CDATA[<ul><li>go unsafe 2023-3-15 23:22:26</li><li>Go异步任务处理解决方案：Asynq 2023-3-15 23:21:25</li><li>go 测试 testing 2023-3-15 23:21:30</li><li>go 1.18后泛型学习 2023-3-15 23:21:35</li><li><a href="https://www.cloudwego.io/zh/" target="_blank" rel="noopener noreferrer">CloudWeGo</a> 学习 2023-3-15 23:19:41</li><li>gin通过embed 打包静态文件 2023-3-15 23:18:05</li></ul>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
    </entry>
    <entry>
        <title type="html"><![CDATA[Go defer 详解]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/03/07/index</id>
        <link href="https://ahkevinxy.github.io/blog/2023/03/07/index"/>
        <updated>2023-03-07T13:09:13.000Z</updated>
        <summary type="html"><![CDATA[Go defer 详解]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="基本功能介绍">基本功能介绍<a href="#基本功能介绍" class="hash-link" aria-label="基本功能介绍的直接链接" title="基本功能介绍的直接链接">​</a></h2><ol><li>defer是一种延迟处理机制，是在函数进行return之前进行执行。</li><li>defer是采用栈的方式执行，也就是说先定义的defer后执行，后定义的defer最先被执行。</li></ol><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="扩展">扩展<a href="#扩展" class="hash-link" aria-label="扩展的直接链接" title="扩展的直接链接">​</a></h2><ol><li>defer 执行顺序 . 采用栈的方式执行,先定义先执行</li><li>defer 与 return 谁先谁执行 return 之后的语句先执行，defer 后的语句后执行。</li><li>函数的返回值初始化与 defer 间接影响。defer中修改了返回值，实际返回的值是按照defer修改后的值进行返回</li><li>defer 遇见 panic。按照defer的栈顺序，输出panic触发之前定义好的defer</li><li>defer 中包含 panic。按照defer的栈顺序，输出panic触发之前的defer。并且defer中会接收到panic信息。</li><li>defer 下的函数参数包含子函数。会先进行子函数的结果值，然后在按照栈的顺序进行输出</li></ol><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="defer-与panic">defer 与panic<a href="#defer-与panic" class="hash-link" aria-label="defer 与panic的直接链接" title="defer 与panic的直接链接">​</a></h2><p>panic是Go语言中的一种异常现象，它会中断程序的执行，并抛出具体的异常信息</p><p>当函数中发生了panic异常，会马上中止当前函数的执行，panic之前定义的defer都会被执行，所有的 defer 语句都会保证执行并把控制权交还给接收到 panic 的函数调用者。这样向上冒泡直到最顶层，并执行（每层的） defer，在栈顶处程序崩溃，并在命令行中用传给 panic 的值报告错误情况：这个终止过程就是 panicking。</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="defer中包含panic">defer中包含panic<a href="#defer中包含panic" class="hash-link" aria-label="defer中包含panic的直接链接" title="defer中包含panic的直接链接">​</a></h2><p>程序中虽然发生了panic，但是在panic之前定义的defer语句，还是会被执行。要想在defer中获取到具体的panic信息，需要使用 recover() 进行获取。</p><p>这个（recover）内建函数被用于从 panic 或 错误场景中恢复：让程序可以从 panicking 重新获得控制权，停止终止过程进而恢复正常执行。</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="defer下的函数参数包含子函数">defer下的函数参数包含子函数<a href="#defer下的函数参数包含子函数" class="hash-link" aria-label="defer下的函数参数包含子函数的直接链接" title="defer下的函数参数包含子函数的直接链接">​</a></h2><ol><li>执行第1个defer时，压入defer栈中，该defer会执行一个function的函数，在函数返回之前执行</li><li>因为该函数中又包含了一个函数(子函数)，Go语言处理的机制是，先执行该子函数。</li><li>执行完子函数，接着再执行第2个defer语句。此时，第2个defer中也有一个子函数，按照第2点的逻辑，这个子函数会被直接执行</li><li>定义完defer语句之后，此时结束该函数的调用。所有被定义的defer语句，按照栈顺序进行输出</li></ol><p>当defer中存在子函数时，子函数会按照defer定义的语句顺序，优先执行。defer最外层的逻辑，则按照栈的顺序执行。</p>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="Go" term="Go"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Go语言实现十大排序算法]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/03/07/sort_go</id>
        <link href="https://ahkevinxy.github.io/blog/2023/03/07/sort_go"/>
        <updated>2023-03-07T13:09:13.000Z</updated>
        <summary type="html"><![CDATA[Go defer 详解]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="冒泡排序">冒泡排序<a href="#冒泡排序" class="hash-link" aria-label="冒泡排序的直接链接" title="冒泡排序的直接链接">​</a></h2><blockquote><p>原理</p></blockquote><p>从左到右遍历数组，相邻元素两两进行比较。每次比较完一轮，就会找到数组中最大的一个或最小的一个。这个数就会从序列的最右边冒出来</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="选择排序">选择排序<a href="#选择排序" class="hash-link" aria-label="选择排序的直接链接" title="选择排序的直接链接">​</a></h2><blockquote><p>原理</p></blockquote><p>首先在开始的时候遍历整个数组，找到序列中的最小元素，然后将这个元素与第一个元素交换，这样最小的元素就放到了它的最终位置上了,然后，从第二个元素开始遍历，找到剩下的n-1个元素中的最小元素，再与第二个元素进行交换。以此类推，直到最后一个元素放到了最终位</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="插入排序">插入排序<a href="#插入排序" class="hash-link" aria-label="插入排序的直接链接" title="插入排序的直接链接">​</a></h2><blockquote><p>原理</p></blockquote><p>将一个记录插入到已经排好序的有序表中，从而一个新的、记录数增1的有序表,在其实现过程使用双层循环，外层循环对除了第一个元素之外的所有元素，内层循环对当前元素前面的有序表进行待插入位置查找，并进行移动</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="快速排序">快速排序<a href="#快速排序" class="hash-link" aria-label="快速排序的直接链接" title="快速排序的直接链接">​</a></h2><blockquote><p>原理</p></blockquote><p>快速排序要求我们选择一个基准，根据这个基准为原数组分组，比基准大的一组，比基准小的一组，再重复递归地进行快速排序，重新合并每组排序后的序列，即为排好序的序列</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="归并排序">归并排序<a href="#归并排序" class="hash-link" aria-label="归并排序的直接链接" title="归并排序的直接链接">​</a></h2><blockquote><p>原理</p></blockquote><p>归并排序是采用分治法的一个典型的排序算法，将已有序的子序列合并为一个完全有序的序列。</p><p>归并排序的过程是：首先将序列拆分成子序列，然后对子序列进行排序，最后将排序好的子序列合并，就得到了一个有序的序列。</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="堆排序">堆排序<a href="#堆排序" class="hash-link" aria-label="堆排序的直接链接" title="堆排序的直接链接">​</a></h2><blockquote><p>原理</p></blockquote><p>先来介绍一下什么是堆？堆是一种近似完全二叉树的数据结构，可以分为大根堆，小根堆。</p><p>接着我们来看一下堆排序的过程：</p><ol><li>将待排序序列构造成一个大根堆，此时，整个数组的最大值就是堆结构顶端的根节点。</li><li>将堆根节点的数与末尾的数交换，此时，末尾的数为最大值，剩余待排序序列个数为n-1。</li><li>将剩余的n-1个数再构造成一个大根堆，再将顶端数与n-1位置的数交换，如此反复执行，便能得到有序数组。</li></ol><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="希尔排序">希尔排序<a href="#希尔排序" class="hash-link" aria-label="希尔排序的直接链接" title="希尔排序的直接链接">​</a></h2><blockquote><p>原理</p></blockquote><p>希尔排序是把记录按下标的一定增量分组，对每组使用直接插入排序算法排序；随着增量逐渐减少，每组包含的关键词越来越多，当增量减至1时，整个文件恰被分成一组，算法便终止。</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="计数排序">计数排序<a href="#计数排序" class="hash-link" aria-label="计数排序的直接链接" title="计数排序的直接链接">​</a></h2><blockquote><p>原理</p></blockquote><p>计数排序是一种通过计数而不是比较进行排序的算法，适用于范围较小的整数序列。
它的优势在于在对一定范围内的整数排序时，时间复杂度为Ο(n+k)（其中k是整数的范围），快于任何比较排序算法。</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="桶排序">桶排序<a href="#桶排序" class="hash-link" aria-label="桶排序的直接链接" title="桶排序的直接链接">​</a></h2><blockquote><p>原理</p></blockquote><p>将数组按照元素所属范围分到有限数量的桶里，再单独对每个桶排序（可以使用别的排序算法或是以递归方式继续使用桶排序进行排序），最后依次把各个桶中的记录列出来记得到有序序列。</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="基数排序">基数排序<a href="#基数排序" class="hash-link" aria-label="基数排序的直接链接" title="基数排序的直接链接">​</a></h2><blockquote><p>原理</p></blockquote><p>依次按照个位、十位、百位...的顺序对待排序数组分组，然后将每一次的分组按照索引大小重新组成新的数组。最后一轮的新数组即为排好序的数组</p><ol><li>我们按照个位将待排序数组分组。</li><li>我们按照十位将待排序数组分组</li><li>我们按照百位将待排序数组分组。</li></ol>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="Go" term="Go"/>
        <category label="算法" term="算法"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Go语言 三剑客]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/03/07/three_tools</id>
        <link href="https://ahkevinxy.github.io/blog/2023/03/07/three_tools"/>
        <updated>2023-03-07T13:09:13.000Z</updated>
        <summary type="html"><![CDATA[Go语言 三剑客]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="viper"><a href="https://github.com/spf13/viper" target="_blank" rel="noopener noreferrer">viper</a><a href="#viper" class="hash-link" aria-label="viper的直接链接" title="viper的直接链接">​</a></h2><p>Go configuration with fangs</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="cobra"><a href="https://github.com/spf13/cobra" target="_blank" rel="noopener noreferrer">Cobra</a><a href="#cobra" class="hash-link" aria-label="cobra的直接链接" title="cobra的直接链接">​</a></h2><p>A Commander for modern Go CLI interactions</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="pflag"><a href="https://github.com/spf13/pflag" target="_blank" rel="noopener noreferrer">Pflag</a><a href="#pflag" class="hash-link" aria-label="pflag的直接链接" title="pflag的直接链接">​</a></h2><p>Drop-in replacement for Go's flag package, implementing POSIX/GNU-style --flags.</p>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="Go" term="Go"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Go 中的waitgroup]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/03/15/wait_group</id>
        <link href="https://ahkevinxy.github.io/blog/2023/03/15/wait_group"/>
        <updated>2023-03-07T13:09:13.000Z</updated>
        <summary type="html"><![CDATA[Go 中的waitgroup]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="什么是waitgroup">什么是WaitGroup<a href="#什么是waitgroup" class="hash-link" aria-label="什么是WaitGroup的直接链接" title="什么是WaitGroup的直接链接">​</a></h2><p><code>WaitGroup</code> 是同步goroutines的一种有效方式，</p><p><code>WaitGroup</code> 是通过调用标准库<code>sync</code> 包</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> wg sync</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">WaitGroup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>WaitGroup 有三个重要的方法</p><ol><li>Add: 添加到你需要等待的goroutines的总量上</li><li>Done: 从你需要等待的goroutines上减除1</li><li>Wait: 阻止代码进行进行下去，直到所有的goroutines全部执行完成</li></ol>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="Go" term="Go"/>
        <category label="Go基础知识" term="Go基础知识"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[资源汇集地]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/07/16/awesome</id>
        <link href="https://ahkevinxy.github.io/blog/2023/07/16/awesome"/>
        <updated>2023-03-07T13:09:13.000Z</updated>
        <summary type="html"><![CDATA[资源汇集地]]></summary>
        <content type="html"><![CDATA[<p><a href="https://github.com/topics/awesome" target="_blank" rel="noopener noreferrer">github</a></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="后端资源">后端资源<a href="#后端资源" class="hash-link" aria-label="后端资源的直接链接" title="后端资源的直接链接">​</a></h2><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="go-资源网站导航"><a href="https://hao.studygolang.com/" target="_blank" rel="noopener noreferrer">Go 资源网站导航</a><a href="#go-资源网站导航" class="hash-link" aria-label="go-资源网站导航的直接链接" title="go-资源网站导航的直接链接">​</a></h2><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="前端资源">前端资源<a href="#前端资源" class="hash-link" aria-label="前端资源的直接链接" title="前端资源的直接链接">​</a></h2><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="java-资源">Java 资源<a href="#java-资源" class="hash-link" aria-label="Java 资源的直接链接" title="Java 资源的直接链接">​</a></h2><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="php-资源">php 资源<a href="#php-资源" class="hash-link" aria-label="php 资源的直接链接" title="php 资源的直接链接">​</a></h2>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
    </entry>
    <entry>
        <title type="html"><![CDATA[白嫖的工具]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/07/16/free</id>
        <link href="https://ahkevinxy.github.io/blog/2023/07/16/free"/>
        <updated>2023-03-07T13:09:13.000Z</updated>
        <summary type="html"><![CDATA[白嫖工具 如何使用网上免费开源的资源]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="开放-图片生成器-any-idea-you-can-imagine-and-create">开放 图片生成器 any idea you can imagine and create<a href="#开放-图片生成器-any-idea-you-can-imagine-and-create" class="hash-link" aria-label="开放 图片生成器 any idea you can imagine and create的直接链接" title="开放 图片生成器 any idea you can imagine and create的直接链接">​</a></h2><p><a href="https://undraw.co/" target="_blank" rel="noopener noreferrer">undraw</a></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="托管平台-几乎无限制使用">托管平台 (几乎无限制使用)<a href="#托管平台-几乎无限制使用" class="hash-link" aria-label="托管平台 (几乎无限制使用)的直接链接" title="托管平台 (几乎无限制使用)的直接链接">​</a></h2><p><a href="https://codeup.aliyun.com/" target="_blank" rel="noopener noreferrer">阿里codeup</a></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="远程编辑器">远程编辑器<a href="#远程编辑器" class="hash-link" aria-label="远程编辑器的直接链接" title="远程编辑器的直接链接">​</a></h2><p><a href="https://ide.aliyun.com/" target="_blank" rel="noopener noreferrer">阿里ide</a></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="插画工具">插画工具<a href="#插画工具" class="hash-link" aria-label="插画工具的直接链接" title="插画工具的直接链接">​</a></h2><ul><li><a href="https://storyset.com/" target="_blank" rel="noopener noreferrer">storyset</a></li><li><a href="https://undraw.co/illustrations" target="_blank" rel="noopener noreferrer">undraw</a></li></ul>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="免费" term="免费"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[高性能协程池ants源码剖析]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/03/06/ants</id>
        <link href="https://ahkevinxy.github.io/blog/2023/03/06/ants"/>
        <updated>2023-03-06T15:17:31.000Z</updated>
        <summary type="html"><![CDATA[高性能协程池ants源码剖析 ants是一个高性能的 goroutine 池，实现了对大规模 goroutine 的调度管理]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="简介">简介<a href="#简介" class="hash-link" aria-label="简介的直接链接" title="简介的直接链接">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ants是什么">ants是什么<a href="#ants是什么" class="hash-link" aria-label="ants是什么的直接链接" title="ants是什么的直接链接">​</a></h3><p>ants是一个高性能的 goroutine 池，实现了对大规模 goroutine 的调度管理、goroutine 复用，允许使用者在开发并发程序的时候限制 goroutine 数量，复用资源，达到更高效执行任务的效果。</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="功能特点">功能特点<a href="#功能特点" class="hash-link" aria-label="功能特点的直接链接" title="功能特点的直接链接">​</a></h3><ul><li>自动调度海量的 goroutines，复用 goroutines</li><li>定期清理过期的 goroutines，进一步节省资源</li><li>提供了大量有用的接口：任务提交、获取运行中的 goroutine 数量、动态调整 Pool 大小、释放 Pool、重启 Pool</li><li>优雅处理 panic，防止程序崩溃</li><li>资源复用，极大节省内存使用量；在大规模批量并发任务场景下比原生 goroutine 并发具有更高的性能</li><li>非阻塞机制</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ants核心概念">ants核心概念<a href="#ants核心概念" class="hash-link" aria-label="ants核心概念的直接链接" title="ants核心概念的直接链接">​</a></h3><ul><li>Pool ：协程池</li><li>WorkerArray：Pool池中的worker队列，存放所有的goWorker</li><li>goWorker：运行任务的实际执行者，它启动一个 goroutine 来接受任务并执行函数调用。</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="pool协程池">Pool协程池<a href="#pool协程池" class="hash-link" aria-label="Pool协程池的直接链接" title="Pool协程池的直接链接">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="pool结构">Pool结构<a href="#pool结构" class="hash-link" aria-label="Pool结构的直接链接" title="Pool结构的直接链接">​</a></h3><blockquote><p>Ants 提供了两种Pool结构：Pool和PoolWithFunc ；但两者逻辑大致一样，本文着重介绍Pool的结构</p></blockquote><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Pool accepts the tasks from client, it limits the total of goroutines to a given number by recycling goroutines.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> Pool </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// capacity of the pool, a negative value means that the capacity of pool is limitless, an infinite pool is used to</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// avoid potential issue of endless blocking caused by nested usage of a pool: submitting a task to pool</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// which submits a new task to the same pool.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 协程池的容量</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> capacity </span><span class="token builtin">int32</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// running is the number of the currently running goroutines.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 正在运行的goroutines的数量</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> running </span><span class="token builtin">int32</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// lock for protecting the worker queue.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 锁，自旋锁，保护队列</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> lock sync</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Locker</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// workers is a slice that store the available workers.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 存放池中所有的worker,workerArray包含可用workers队列和过期workers队列，只会从可用workers队列中取可用worker</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> workers workerArray</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// state is used to notice the pool to closed itself.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 记录池子的状态 （关闭、开启）</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> state </span><span class="token builtin">int32</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// cond for waiting to get an idle worker.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 条件变量</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> cond </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">sync</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Cond</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// workerCache speeds up the obtainment of a usable worker in function:retrieveWorker.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// worker 对象池</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> workerCache sync</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Pool</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// waiting is the number of goroutines already been blocked on pool.Submit(), protected by pool.lock</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">//阻塞等待的任务量</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> waiting </span><span class="token builtin">int32</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 清道夫，定时清理workerarray 队列中过期的worker</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> purgeDone </span><span class="token builtin">int32</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> stopPurge context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">CancelFunc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 定时器 更新pool中now的字段</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ticktockDone </span><span class="token builtin">int32</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> stopTicktock context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">CancelFunc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> now atomic</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Value</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 需要自定义加载的配置</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> options </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">Options</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="pool创建">Pool创建<a href="#pool创建" class="hash-link" aria-label="Pool创建的直接链接" title="Pool创建的直接链接">​</a></h3><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// NewPool generates an instance of ants pool.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">NewPool</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">size </span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> options </span><span class="token operator" style="color:#393A34">...</span><span class="token plain">Option</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">Pool</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> opts </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">loadOptions</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">options</span><span class="token operator" style="color:#393A34">...</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 加载自定义的options中的配置</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> size </span><span class="token operator" style="color:#393A34">&lt;=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  size </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!</span><span class="token plain">opts</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DisablePurge </span><span class="token punctuation" style="color:#393A34">{</span><span class="token comment" style="color:#999988;font-style:italic">// 当 DisablePurge 为 true 时，worker 不会被清除并且是驻留的。</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> expiry </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> opts</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ExpiryDuration</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> expiry </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ErrInvalidPoolExpiry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> expiry </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   opts</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ExpiryDuration </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> DefaultCleanIntervalTime </span><span class="token comment" style="color:#999988;font-style:italic">// 默认间隔时间1s</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> opts</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Logger </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  opts</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Logger </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> defaultLogger</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> p </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">Pool</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  capacity</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">int32</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">size</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  lock</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">     syncx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">NewSpinLock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token comment" style="color:#999988;font-style:italic">//自旋锁</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  options</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  opts</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">workerCache</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">New </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">func</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">interface</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">//sync.pool 初始化</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">goWorker</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   pool</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> p</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   task</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">make</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">chan</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">func</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> workerChanCap</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">PreAlloc </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> size </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ErrInvalidPreAllocSize</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">workers </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">newWorkerArray</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">loopQueueType</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> size</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">//循环队列</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">workers </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">newWorkerArray</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">stackType</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">//数组</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cond </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> sync</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">NewCond</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">lock</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// sync.cond初始化</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">goPurge</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">goTicktock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> p</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="自旋锁spinlock重点">自旋锁SpinLock(重点)<a href="#自旋锁spinlock重点" class="hash-link" aria-label="自旋锁SpinLock(重点)的直接链接" title="自旋锁SpinLock(重点)的直接链接">​</a></h3><blockquote><p>思考：如何设计一种自旋锁，设计自旋锁时需要注意什么？</p></blockquote><p>spinLock是基于CAS机制和指数退避算法实现的一种自旋锁</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">package</span><span class="token plain"> sync</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token string" style="color:#e3116c">"runtime"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token string" style="color:#e3116c">"sync"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token string" style="color:#e3116c">"sync/atomic"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> spinLock </span><span class="token builtin">uint32</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 实现sync.Locker接口</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> maxBackoff </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">16</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">//最大的回避次数</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sl </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">spinLock</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Lock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> backoff </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 基于CAS机制，尝试获取锁，且使用指数退避算法来提供获取锁的成功率</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!</span><span class="token plain">atomic</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">CompareAndSwapUint32</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token builtin">uint32</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sl</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Leverage the exponential backoff algorithm, see https://en.wikipedia.org/wiki/Exponential_backoff.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> backoff</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i</span><span class="token operator" style="color:#393A34">++</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token comment" style="color:#999988;font-style:italic">//runtime.Gosched()函数功能：使当前goroutine让出CPU时间片（“回避”），让其他的goroutine获得执行的机会。当前的goroutine会在未来的某个时间点继续运行。</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//注意：当一个goroutine发生阻塞，Go会自动地把与该goroutine处于同一系统线程的其他goroutines转移到另一个系统线程上去，以使这些goroutines不阻塞（从GMP模型角度来说，就是当与P绑定的M发生阻塞，P就与其解绑，然后与另一个空闲的M进行绑定 或者 去创建一个M进行绑定）。</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   runtime</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Gosched</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> backoff </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> maxBackoff </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   backoff </span><span class="token operator" style="color:#393A34">&lt;&lt;=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sl </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">spinLock</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Unlock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">//原子操作，并发安全</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> atomic</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">StoreUint32</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token builtin">uint32</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sl</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// NewSpinLock instantiates a spin-lock.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">NewSpinLock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> sync</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Locker </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">new</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">spinLock</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>sync.Locker</p><blockquote><p>设计锁时必须实现该接口中的方法</p></blockquote><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// A Locker represents an object that can be locked and unlocked.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> Locker </span><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token function" style="color:#d73a49">Lock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token function" style="color:#d73a49">Unlock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="关键知识点">关键知识点<a href="#关键知识点" class="hash-link" aria-label="关键知识点的直接链接" title="关键知识点的直接链接">​</a></h3><ul><li>sync.Locker接口</li><li>指数退避算法</li><li>atomic 原子包中的方法了解</li><li>runtime.Gosched()</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="任务执行">任务执行<a href="#任务执行" class="hash-link" aria-label="任务执行的直接链接" title="任务执行的直接链接">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="goworker的结构">goWorker的结构<a href="#goworker的结构" class="hash-link" aria-label="goWorker的结构的直接链接" title="goWorker的结构的直接链接">​</a></h3><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// goWorker is the actual executor who runs the tasks,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// it starts a goroutine that accepts tasks and</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// performs function calls.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//goWorker 是运行任务的实际执行者，它启动一个 goroutine 来接受任务并执行函数调用。</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> goWorker </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// pool who owns this worker.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> pool </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">Pool </span><span class="token comment" style="color:#999988;font-style:italic">// 拥有worker的协议池</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// task is a job should be done.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> task </span><span class="token keyword" style="color:#00009f">chan</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">func</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 需要执行的任务，注意：该chan 可能是缓存区或者非缓存区，如果是多核的话，缓存区的大小是1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// recycleTime will be updated when putting a worker back into queue.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> recycleTime time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Time </span><span class="token comment" style="color:#999988;font-style:italic">// 回收时间</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="gowoker的初始化">goWoker的初始化<a href="#gowoker的初始化" class="hash-link" aria-label="goWoker的初始化的直接链接" title="goWoker的初始化的直接链接">​</a></h3><blockquote><p>goWorker 是sync.pool 对象池创建的；初始化在Pool创建时</p></blockquote><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">workerCache</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">New </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">func</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">interface</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">goWorker</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   pool</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> p</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   task</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">make</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">chan</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">func</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> workerChanCap</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="workerchancap的值">workerChanCap的值<a href="#workerchancap的值" class="hash-link" aria-label="workerChanCap的值的直接链接" title="workerChanCap的值的直接链接">​</a></h3><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// workerChanCap determines whether the channel of a worker should be a buffered channel</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// to get the best performance. Inspired by fasthttp at</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// https://github.com/valyala/fasthttp/blob/master/workerpool.go#L139</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> workerChanCap </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">func</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Use blocking channel if GOMAXPROCS=1.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// This switches context from sender to receiver immediately,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// which results in higher performance (under go1.5 at least).</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> runtime</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">GOMAXPROCS</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Use non-blocking workerChan if GOMAXPROCS&gt;1,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// since otherwise the sender might be dragged down if the receiver is CPU-bound.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="task-任务提交">Task 任务提交<a href="#task-任务提交" class="hash-link" aria-label="Task 任务提交的直接链接" title="Task 任务提交的直接链接">​</a></h3><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">p </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">Pool</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Submit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">task </span><span class="token keyword" style="color:#00009f">func</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">IsClosed</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 前置检查 协程池是否关闭</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> ErrPoolClosed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> w </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">goWorker</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> w </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">retrieveWorker</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> w </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">//获取一个可用的worker取执行任务</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> ErrPoolOverload</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> w</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">task </span><span class="token operator" style="color:#393A34">&lt;-</span><span class="token plain"> task</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="retrieveworker-可用worker获取">retrieveWorker （可用worker获取）<a href="#retrieveworker-可用worker获取" class="hash-link" aria-label="retrieveWorker （可用worker获取）的直接链接" title="retrieveWorker （可用worker获取）的直接链接">​</a></h3><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// retrieveWorker returns an available worker to run the tasks.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">p </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">Pool</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">retrieveWorker</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">w </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">goWorker</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> spawnWorker </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">func</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 使用sync.pool 创建worker</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  w </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">workerCache</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">goWorker</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  w</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">lock</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Lock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 自旋锁 加锁</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> w </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">workers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">detach</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 尝试从worker池子中获取可用的worker，注：任务执行完后，会回收worker 以便下次使用</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> w </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// first try to fetch the worker from the queue  获取到返回</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">lock</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Unlock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> capacity </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Cap</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> capacity </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> capacity </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Running</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 判断正在运行的worker 是否超过 pool协程词设置的容量大小，注 capacity=-1 表示池子容量无限大</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// if the worker queue is empty and we don't run out of the pool capacity,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// then just spawn a new worker goroutine.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">lock</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Unlock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">spawnWorker</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 创建worker</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// otherwise, we'll have to keep them blocked and wait for at least one worker to be put back into pool.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Nonblocking </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 判断协程池是否 是非阻塞模式 ，如果是非阻塞模式下就直接返回</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">lock</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Unlock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> retry</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 阻塞模式下的逻辑</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 判断阻塞的任务数量是否超过了设置的最大阈值，如果超过直接返回</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">MaxBlockingTasks </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Waiting</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;=</span><span class="token plain"> p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">MaxBlockingTasks </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">lock</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Unlock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">addWaiting</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 阻塞任务数量加1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cond</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Wait</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// block and wait for an available worker</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">addWaiting</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 获取到可用的worker后，阻塞数量减一</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">IsClosed</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// check pool池是否关闭</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">lock</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Unlock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> nw </span><span class="token builtin">int</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> nw </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Running</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> nw </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 如果正在执行的worker数量为0时，需要重新创建woker</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">lock</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Unlock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token function" style="color:#d73a49">spawnWorker</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> w </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">workers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">detach</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> w </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">//从workerArray中获取可用的worker</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> nw </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Cap</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 获取不到，判断正在运行的goroutines的数量是否超过协层池的容量，没有就创建</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">lock</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Unlock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">spawnWorker</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token keyword" style="color:#00009f">goto</span><span class="token plain"> retry </span><span class="token comment" style="color:#999988;font-style:italic">// goto 重试阻塞模式下获取可用worker的逻辑</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">lock</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Unlock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="workerarray-工作池的结构">WorkerArray 工作池的结构<a href="#workerarray-工作池的结构" class="hash-link" aria-label="WorkerArray 工作池的结构的直接链接" title="WorkerArray 工作池的结构的直接链接">​</a></h3><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> workerArray </span><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token function" style="color:#d73a49">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 长度</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token function" style="color:#d73a49">isEmpty</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin">bool</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 是否为空</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token function" style="color:#d73a49">insert</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">worker </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">goWorker</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 插入</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token function" style="color:#d73a49">detach</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">goWorker </span><span class="token comment" style="color:#999988;font-style:italic">// 从WorkerArray获取可用的worker</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token function" style="color:#d73a49">retrieveExpiry</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">duration time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Duration</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">goWorker  </span><span class="token comment" style="color:#999988;font-style:italic">//清道夫调用pool.worker中的此方法来清理pool.workers中的过期worker</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token function" style="color:#d73a49">reset</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 重置，清空WorkerArray中所有的Worker</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>workerArray 接口的实现workerStack 和loopQueue</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="任务执行-1">任务执行<a href="#任务执行-1" class="hash-link" aria-label="任务执行的直接链接" title="任务执行的直接链接">​</a></h3><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// run starts a goroutine to repeat the process</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// that performs the function calls.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">w </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">goWorker</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   w</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pool</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">addRunning</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// pool的running 加 一</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token keyword" style="color:#00009f">go</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">func</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">defer</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">func</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         w</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pool</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">addRunning</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         w</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pool</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">workerCache</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Put</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">w</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> p </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">recover</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> p </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> ph </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> w</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pool</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">PanicHandler</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> ph </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               </span><span class="token function" style="color:#d73a49">ph</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">p</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               w</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pool</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Logger</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"worker exits from a panic: %v\n"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> p</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> buf </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">4096</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">byte</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               n </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> runtime</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Stack</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">buf</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               w</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pool</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Logger</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"worker exits from panic: %s\n"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">string</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">buf</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">n</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token comment" style="color:#999988;font-style:italic">// Call Signal() here in case there are goroutines waiting for available workers.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         w</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pool</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cond</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Signal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> f </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">range</span><span class="token plain"> w</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">task </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> f </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token function" style="color:#d73a49">f</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 任务执行</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> ok </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> w</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pool</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">revertWorker</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">w</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!</span><span class="token plain">ok </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 回收woker</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>revertWorker</code>worker回收</p><blockquote><p>逻辑简单：1、往workerArray 队列中插入；2、通知正在阻塞获取worker的goroutines</p></blockquote><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// revertWorker puts a worker back into free pool, recycling the goroutines.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">p </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">Pool</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">revertWorker</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">worker </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">goWorker</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin">bool</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> capacity </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Cap</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">capacity </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Running</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> capacity</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">IsClosed</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cond</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Broadcast</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> worker</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">recycleTime </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">nowTime</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">lock</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Lock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// To avoid memory leaks, add a double check in the lock scope.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Issue: https://github.com/panjf2000/ants/issues/113</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">IsClosed</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">lock</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Unlock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> err </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">workers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">insert</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">worker</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">lock</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Unlock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Notify the invoker stuck in 'retrieveWorker()' of there is an available worker in the worker queue.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cond</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Signal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">lock</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Unlock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="定时清理过期的worker">定时清理过期的worker<a href="#定时清理过期的worker" class="hash-link" aria-label="定时清理过期的worker的直接链接" title="定时清理过期的worker的直接链接">​</a></h3><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">p </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">Pool</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">goPurge</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DisablePurge </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Start a goroutine to clean up expired workers periodically.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> ctx context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Context</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ctx</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">stopPurge </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">WithCancel</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Background</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">go</span><span class="token plain"> p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">purgeStaleWorkers</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// purgeStaleWorkers clears stale workers periodically, it runs in an individual goroutine, as a scavenger.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">p </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">Pool</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">purgeStaleWorkers</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ctx context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Context</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ticker </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">NewTicker</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ExpiryDuration</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">defer</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">func</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ticker</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Stop</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  atomic</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">StoreInt32</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">purgeDone</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;-</span><span class="token plain">ctx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Done</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;-</span><span class="token plain">ticker</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">C</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">IsClosed</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token keyword" style="color:#00009f">break</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">lock</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Lock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  expiredWorkers </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">workers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">retrieveExpiry</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ExpiryDuration</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">lock</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Unlock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Notify obsolete workers to stop.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// This notification must be outside the p.lock, since w.task</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// may be blocking and may consume a lot of time if many workers</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// are located on non-local CPUs.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">range</span><span class="token plain"> expiredWorkers </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   expiredWorkers</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">task </span><span class="token operator" style="color:#393A34">&lt;-</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   expiredWorkers</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// There might be a situation where all workers have been cleaned up(no worker is running),</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// or another case where the pool capacity has been Tuned up,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// while some invokers still get stuck in "p.cond.Wait()",</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// then it ought to wake all those invokers.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Running</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Waiting</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Free</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cond</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Broadcast</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>ants源码 自旋锁的设计、sync.cond 条件变量 、sync.pool 对象池，原子操作，channel通信等</p>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="Go" term="Go"/>
        <category label="ants" term="ants"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Go的内存对齐机制]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/03/06/memory_struct</id>
        <link href="https://ahkevinxy.github.io/blog/2023/03/06/memory_struct"/>
        <updated>2023-03-06T15:17:31.000Z</updated>
        <summary type="html"><![CDATA[Go的结构体内存对齐机制]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="什么是内存对齐">什么是内存对齐<a href="#什么是内存对齐" class="hash-link" aria-label="什么是内存对齐的直接链接" title="什么是内存对齐的直接链接">​</a></h2><p>为了能让CPU可以更快的存取到各个字段，Go编译器会帮你把<code>struct结构体</code>做数据的对齐。所谓的数据对齐，是指内存地址是所存储数据的大小（按字节为单位）的整数倍，以便CU可以一次将该数据从内存中读取出来。编译器通过在结构体的各个字段之间填充一些空白已达到对齐的目的。</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="对齐系数">对齐系数<a href="#对齐系数" class="hash-link" aria-label="对齐系数的直接链接" title="对齐系数的直接链接">​</a></h2><p>不同硬件平台占用的大小和对齐值都可能是不一样的，每个特定平台上的编译器都有自己的默认"对齐系数"，32位系统对齐系数是4，64位系统对齐系数是8</p><p>不同类型的对齐系数也可能不一样，使用Go语言中的<code>unsafe.Alignof</code>函数可以返回相应类型的对齐系数，对齐系数都符合2^n这个规律，最大也不会超过8</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">package</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">"fmt"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">"unsafe"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"bool alignof is %d\n"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> unsafe</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Alignof</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">bool</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"string alignof is %d\n"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> unsafe</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Alignof</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">string</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"a"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"int alignof is %d\n"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> unsafe</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Alignof</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">int</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"float alignof is %d\n"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> unsafe</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Alignof</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">float64</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"int32 alignof is %d\n"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> unsafe</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Alignof</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">int32</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"float32 alignof is %d\n"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> unsafe</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Alignof</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">float32</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>可以查看到各种类型在Windows 64位上的对齐系数如下：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">bool alignof is </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">string alignof is </span><span class="token number" style="color:#36acaa">8</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">int alignof is </span><span class="token number" style="color:#36acaa">8</span><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">float alignof is </span><span class="token number" style="color:#36acaa">8</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">int32 alignof is </span><span class="token number" style="color:#36acaa">4</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">float32 alignof is </span><span class="token number" style="color:#36acaa">4</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="缺点">缺点<a href="#缺点" class="hash-link" aria-label="缺点的直接链接" title="缺点的直接链接">​</a></h2><p>存在内存空间的浪费，实际上是空间换时间。</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="优点">优点<a href="#优点" class="hash-link" aria-label="优点的直接链接" title="优点的直接链接">​</a></h2><ol><li>提高可移植性，有些CPU可以访问任意地址上的任意数据，而有些CPU只能在特定地址访问数据，因此不同硬件平台具有差异性，这样的代码就不具有移植性，如果在编译时，将分配的内存进行对齐，这就具有平台可以移植性了</li><li>提高内存的访问效率，32位CPU下一次可以从内存中读取32位（4个字节）的数据，64位CPU下一次可以从内存中读取64位（8个字节）的数据，这个长度也称为CPU的字长。CPU一次可以读取1个字长的数据到内存中，如果所需要读取的数据正好跨了1个字长，那就得花两个CPU周期的时间去读取了。因此在内存中存放数据时进行对齐，可以提高内存访问效率。</li></ol><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="结构体对齐原则">结构体对齐原则<a href="#结构体对齐原则" class="hash-link" aria-label="结构体对齐原则的直接链接" title="结构体对齐原则的直接链接">​</a></h2><p>对齐原则：</p><ol><li>第一个成员在结构体变量偏移处为0的地址处</li><li>其他成员要对齐到某个数字(对齐数)的整数倍的地址处。对齐数=编译器默认的一个对齐数与该成员大小的较小值。每个特定平台上的编译器都有自己的默认"对齐系数"，32位系统对齐系数是4，64位系统对齐系数是8。</li><li>结构体总大小为最大对齐数的整数倍</li><li>如果嵌套了结构体的情况，嵌套的结构体对齐到自己的最大对齐数的整数倍处，结构体整体就是所有最大对齐数的整数倍。</li></ol><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> T1 </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    i16  </span><span class="token builtin">int16</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 2 byte</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">bool</span><span class="token plain"> </span><span class="token builtin">bool</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 1 byte</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> T2 </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    i8  </span><span class="token builtin">int8</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 1 byte</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    i64 </span><span class="token builtin">int64</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 8 byte</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    i32 </span><span class="token builtin">int32</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 4 byte</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> T3 </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    i8  </span><span class="token builtin">int8</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 1 byte</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    i32 </span><span class="token builtin">int32</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 4 byte</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    i64 </span><span class="token builtin">int64</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 8 byte</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">runtime</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">GOARCH</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// amd64</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    t1 </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> T1</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">unsafe</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Sizeof</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">t1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 4 bytes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    t2 </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> T2</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">unsafe</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Sizeof</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">t2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 24 bytes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    t3 </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> T3</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">unsafe</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Sizeof</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">t3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 16 bytes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>以T1 结构
i16并没有直接放在bool的后面，而是在bool中填充了一个空白后，放到了偏移量为2的位置上。如果i16从偏移量为1的位置开始占用2个字节，根据对齐原则2：构体变量中成员的偏移量必须是成员大小的整数倍，套用公式 1 % 2 = 1，就不满足对齐的要求，所以i16从偏移量为2的位置开始</p>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="Go" term="Go"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[懂秒杀系统]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/03/06/ms</id>
        <link href="https://ahkevinxy.github.io/blog/2023/03/06/ms"/>
        <updated>2023-03-06T15:17:31.000Z</updated>
        <summary type="html"><![CDATA[懂秒杀系统]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="知识点详解">知识点详解<a href="#知识点详解" class="hash-link" aria-label="知识点详解的直接链接" title="知识点详解的直接链接">​</a></h2>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="Go" term="Go"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[记 IM 即时通信开发]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/03/06/im</id>
        <link href="https://ahkevinxy.github.io/blog/2023/03/06/im"/>
        <updated>2023-03-06T14:10:16.000Z</updated>
        <summary type="html"><![CDATA[IM 即时通信开发]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="基础知识">基础知识<a href="#基础知识" class="hash-link" aria-label="基础知识的直接链接" title="基础知识的直接链接">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="什么是网络">什么是网络<a href="#什么是网络" class="hash-link" aria-label="什么是网络的直接链接" title="什么是网络的直接链接">​</a></h3><ul><li>在计算机领域中，网络是信息传输，接收，共享的虚拟平台</li><li>通过把各个点，面，体的信息联系到一起，从而实现这些资源的共享</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="什么是网络编程">什么是网络编程<a href="#什么是网络编程" class="hash-link" aria-label="什么是网络编程的直接链接" title="什么是网络编程的直接链接">​</a></h3><ul><li>网络编程从大的方面说就是对信息的发送到接收</li><li>通过操作相对应api调度计算机硬件资源，并利用传输管道进行数据交换的过程</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="7-层网络模型-osi">7 层网络模型 OSI<a href="#7-层网络模型-osi" class="hash-link" aria-label="7 层网络模型 OSI的直接链接" title="7 层网络模型 OSI的直接链接">​</a></h3><ul><li>基础层： 物理层（physical）,数据链路层(datalink),网络层(network)</li><li>传输层(Tramsport) :TCP-UDP 协议层，Socket</li><li>高级层： 会话层（session）,表示层(presentation),应用层(Application)</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="socket的作用与组成">Socket的作用与组成<a href="#socket的作用与组成" class="hash-link" aria-label="Socket的作用与组成的直接链接" title="Socket的作用与组成的直接链接">​</a></h3><ul><li>在网络传输中用于唯一标示两个端点之间的链接</li><li>端点: 包括（ip+port)</li><li>4个要素</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="报文段">报文段<a href="#报文段" class="hash-link" aria-label="报文段的直接链接" title="报文段的直接链接">​</a></h3><ul><li>报文段是指TCP/IP 协议网络传输过程中，起到路由导航的作用</li><li>用以查询各个网络路由网段，IP地址，交换协议等IP数据包</li><li>报文段充当整个TCP/IP协议数据包的导航路由功能</li><li>报文在传输过程中不断地封装成分组，包，帧来传输</li><li>封装方式就是添加一些控制信息组成的首部，即报文头</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="传输协议">传输协议<a href="#传输协议" class="hash-link" aria-label="传输协议的直接链接" title="传输协议的直接链接">​</a></h3><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="mac地址">Mac地址<a href="#mac地址" class="hash-link" aria-label="Mac地址的直接链接" title="Mac地址的直接链接">​</a></h3><ul><li>Media Access Control</li><li>媒体访问控制，或物理地址 硬件地址</li><li>用来定义网络设备的位置</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="端口">端口<a href="#端口" class="hash-link" aria-label="端口的直接链接" title="端口的直接链接">​</a></h3><ul><li>端口相当于窗口 0-1023 号端口  以及1024-49151 号端口都是特殊端口</li><li>49142-65525动态端口</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="udp">UDP<a href="#udp" class="hash-link" aria-label="UDP的直接链接" title="UDP的直接链接">​</a></h3><ul><li>User Datagram Protocol</li><li>用户数据协议，又称用户数据报文协议</li><li>是一个简单的面向数据报的传输层协议，正式规范为RFC 768</li><li>用户数据协议，非连接协议</li><li>一旦把应用程序发给网络层的数据发送出去，就不保留数据备份</li><li>udp 在IP数据的报的头部仅仅加入了复用和数据校验</li><li>发送端生产数据，接收端从网络中抓取数据</li><li>结构简单，无校验，速度快，容易丢包，可广播</li><li>udp 包最大长度 65535 2^16-1 自身协议占用 32+32 = 64 位=8字节  65535-8=65527</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="udp-核心api">UDP 核心API<a href="#udp-核心api" class="hash-link" aria-label="UDP 核心API的直接链接" title="UDP 核心API的直接链接">​</a></h3>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="im" term="im"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[如何写好一份技术文档]]></title>
        <id>https://ahkevinxy.github.io/blog/2022/11/28/index</id>
        <link href="https://ahkevinxy.github.io/blog/2022/11/28/index"/>
        <updated>2023-03-06T13:46:13.000Z</updated>
        <summary type="html"><![CDATA[如何写好一份技术文档]]></summary>
        <content type="html"><![CDATA[<blockquote><p>参考 <a href="https://juejin.cn/post/6854573217747894279" target="_blank" rel="noopener noreferrer">飞享-即时聊天系统技术文档</a></p></blockquote><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>信息</div><div class="admonitionContent_S0QG"><p>三部曲:</p><ol><li>概述</li><li>系统架构</li><li>系统流程图</li><li>系统关键介绍(登录设计,......)</li><li>系统接口文档</li></ol></div></div>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="文档" term="文档"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Go 源码学习 --- chan]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/03/06/go_chan</id>
        <link href="https://ahkevinxy.github.io/blog/2023/03/06/go_chan"/>
        <updated>2023-03-06T00:00:00.000Z</updated>
        <content type="html"><![CDATA[<h1>hchan</h1><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> hchan </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> qcount   </span><span class="token builtin">uint</span><span class="token plain">           </span><span class="token comment" style="color:#999988;font-style:italic">// 通道中的总数据 total data in the queue</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> dataqsiz </span><span class="token builtin">uint</span><span class="token plain">           </span><span class="token comment" style="color:#999988;font-style:italic">// 循环队列的大小 size of the circular queue</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> buf      unsafe</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Pointer </span><span class="token comment" style="color:#999988;font-style:italic">// 指向dataqsiz元素数组  points to an array of dataqsiz elements</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> elemsize </span><span class="token builtin">uint16</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 大小</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> closed   </span><span class="token builtin">uint32</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 是否关闭</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> elemtype </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">_type </span><span class="token comment" style="color:#999988;font-style:italic">// 节点类型 element type</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> sendx    </span><span class="token builtin">uint</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic">// 发送数据 send index</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> recvx    </span><span class="token builtin">uint</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic">// 接受 receive index</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> recvq    waitq  </span><span class="token comment" style="color:#999988;font-style:italic">// 等待接受 list of recv waiters</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> sendq    waitq  </span><span class="token comment" style="color:#999988;font-style:italic">//  等待发送 list of send waiters</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// lock protects all fields in hchan, as well as several</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// fields in sudogs blocked on this channel.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Do not change another G's status while holding this lock</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// (in particular, do not ready a G), as this can deadlock</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// with stack shrinking.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> lock mutex </span><span class="token comment" style="color:#999988;font-style:italic">// 锁</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> waitq </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> first </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">sudog </span><span class="token comment" style="color:#999988;font-style:italic">// 第一个</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> last  </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">sudog </span><span class="token comment" style="color:#999988;font-style:italic">// 最后一个</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> sudog </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// The following fields are protected by the hchan.lock of the</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// channel this sudog is blocking on. shrinkstack depends on</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// this for sudogs involved in channel ops.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> g </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">g</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> next </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">sudog </span><span class="token comment" style="color:#999988;font-style:italic">// 下一个</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> prev </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">sudog </span><span class="token comment" style="color:#999988;font-style:italic">// 上一个</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> elem unsafe</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Pointer </span><span class="token comment" style="color:#999988;font-style:italic">// 数据元素(可能指向堆栈)  data element (may point to stack)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// The following fields are never accessed concurrently.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// For channels, waitlink is only accessed by g.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// For semaphores, all fields (including the ones above)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// are only accessed when holding a semaRoot lock.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> acquiretime </span><span class="token builtin">int64</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> releasetime </span><span class="token builtin">int64</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ticket      </span><span class="token builtin">uint32</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// isSelect indicates g is participating in a select, so</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// g.selectDone must be CAS'd to win the wake-up race.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> isSelect </span><span class="token builtin">bool</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// success indicates whether communication over channel c</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// succeeded. It is true if the goroutine was awoken because a</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// value was delivered over channel c, and false if awoken</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// because c was closed.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> success </span><span class="token builtin">bool</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">//是否成功</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> parent   </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">sudog </span><span class="token comment" style="color:#999988;font-style:italic">// semaRoot二叉树  semaRoot binary tree</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> waitlink </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">sudog </span><span class="token comment" style="color:#999988;font-style:italic">// g.等待列表或semaRoot  g.waiting list or semaRoot</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> waittail </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">sudog </span><span class="token comment" style="color:#999988;font-style:italic">// 等待 semaRoot</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c        </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">hchan </span><span class="token comment" style="color:#999988;font-style:italic">// 通道 channel</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="源码" term="源码"/>
        <category label="Go" term="Go"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[源码 上解读 GMP模型]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/03/06/go_gmp</id>
        <link href="https://ahkevinxy.github.io/blog/2023/03/06/go_gmp"/>
        <updated>2023-03-06T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[path : src/runtime/runtime1.go]]></summary>
        <content type="html"><![CDATA[<blockquote><p>path : src/runtime/runtime1.go</p></blockquote><blockquote><p>go  version 1.16.1</p></blockquote><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="g">G<a href="#g" class="hash-link" aria-label="G的直接链接" title="G的直接链接">​</a></h2><div class="language-Go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-Go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">type g struct {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> // Stack (栈)parameters(参数).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> // stack describes the actual stack memory: [stack.lo, stack.hi).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> // stackguard0 is the stack pointer compared in the Go stack growth prologue.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//stackguard0是在Go堆栈增长序言中比较的堆栈指针</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> // It is stack.lo+StackGuard normally, but can be StackPreempt to trigger a preemption.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//lo+StackGuard正常，但可以是StackPreempt触发抢占</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> // stackguard1 is the stack pointer compared in the C stack growth prologue.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//stackguard1是在C堆栈增长序言中比较的堆栈指针</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> // It is stack.lo+StackGuard on g0 and gsignal stacks.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> // It is ~0 on other goroutine stacks, to trigger a call to morestackc (and crash).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> stack       stack   // offset known to runtime/cgo 已知的偏移量为runtime/cgo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> stackguard0 uintptr // offset known to liblink 已知liblink的偏移量</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> stackguard1 uintptr // offset known to liblink</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> _panic       *_panic // innermost panic - offset known to liblink</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> _defer       *_defer // innermost defer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> m            *m      // current m; offset known to arm liblink</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> sched        gobuf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> syscallsp    uintptr        // if status==Gsyscall, syscallsp = sched.sp to use during gc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> syscallpc    uintptr        // if status==Gsyscall, syscallpc = sched.pc to use during gc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> stktopsp     uintptr        // expected sp at top of stack, to check in traceback</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> param        unsafe.Pointer // passed parameter on wakeup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> atomicstatus uint32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> stackLock    uint32 // sigprof/scang lock; TODO: fold in to atomicstatus</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> goid         int64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> schedlink    guintptr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> waitsince    int64      // approx time when the g become blocked</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> waitreason   waitReason // if status==Gwaiting</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> preempt       bool // preemption signal, duplicates stackguard0 = stackpreempt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> preemptStop   bool // transition to _Gpreempted on preemption; otherwise, just deschedule</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> preemptShrink bool // shrink stack at synchronous safe point</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> // asyncSafePoint is set if g is stopped at an asynchronous</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> // safe point. This means there are frames on the stack</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> // without precise pointer information.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> asyncSafePoint bool</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> paniconfault bool // panic (instead of crash) on unexpected fault address</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> gcscandone   bool // g has scanned stack; protected by _Gscan bit in status</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> throwsplit   bool // must not split stack</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> // activeStackChans indicates that there are unlocked channels</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> // pointing into this goroutine's stack. If true, stack</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> // copying needs to acquire channel locks to protect these</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> // areas of the stack.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> activeStackChans bool</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> // parkingOnChan indicates that the goroutine is about to</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> // park on a chansend or chanrecv. Used to signal an unsafe point</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> // for stack shrinking. It's a boolean value, but is updated atomically.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> parkingOnChan uint8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> raceignore     int8     // ignore race detection events</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> sysblocktraced bool     // StartTrace has emitted EvGoInSyscall about this goroutine</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> sysexitticks   int64    // cputicks when syscall has returned (for tracing)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> traceseq       uint64   // trace event sequencer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> tracelastp     puintptr // last P emitted an event for this goroutine</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> lockedm        muintptr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> sig            uint32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> writebuf       []byte</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> sigcode0       uintptr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> sigcode1       uintptr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> sigpc          uintptr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> gopc           uintptr         // pc of go statement that created this goroutine</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ancestors      *[]ancestorInfo // ancestor information goroutine(s) that created this goroutine (only used if debug.tracebackancestors)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> startpc        uintptr         // pc of goroutine function</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> racectx        uintptr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> waiting        *sudog         // sudog structures this g is waiting on (that have a valid elem ptr); in lock order</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> cgoCtxt        []uintptr      // cgo traceback context</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> labels         unsafe.Pointer // profiler labels</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> timer          *timer         // cached timer for time.Sleep</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> selectDone     uint32         // are we participating in a select and did someone win the race?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> // Per-G GC state</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> // gcAssistBytes is this G's GC assist credit in terms of</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> // bytes allocated. If this is positive, then the G has credit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> // to allocate gcAssistBytes bytes without assisting. If this</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> // is negative, then the G must correct this by performing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> // scan work. We track this in bytes to make it fast to update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> // and check for debt in the malloc hot path. The assist ratio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> // determines how this corresponds to scan work debt.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> gcAssistBytes int64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="m">M<a href="#m" class="hash-link" aria-label="M的直接链接" title="M的直接链接">​</a></h2><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> m </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> g0      </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">g     </span><span class="token comment" style="color:#999988;font-style:italic">// goroutine with scheduling stack</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> morebuf gobuf  </span><span class="token comment" style="color:#999988;font-style:italic">// gobuf arg to morestack</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> divmod  </span><span class="token builtin">uint32</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// div/mod denominator for arm - known to liblink</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Fields not known to debuggers.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> procid        </span><span class="token builtin">uint64</span><span class="token plain">       </span><span class="token comment" style="color:#999988;font-style:italic">// for debuggers, but offset not hard-coded</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> gsignal       </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">g           </span><span class="token comment" style="color:#999988;font-style:italic">// signal-handling g</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> goSigStack    gsignalStack </span><span class="token comment" style="color:#999988;font-style:italic">// Go-allocated signal handling stack</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> sigmask       sigset       </span><span class="token comment" style="color:#999988;font-style:italic">// storage for saved signal mask</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> tls           </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">6</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">uintptr</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic">// thread-local storage (for x86 extern register)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> mstartfn      </span><span class="token keyword" style="color:#00009f">func</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> curg          </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">g       </span><span class="token comment" style="color:#999988;font-style:italic">// current running goroutine</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> caughtsig     guintptr </span><span class="token comment" style="color:#999988;font-style:italic">// goroutine running during fatal signal</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> p             puintptr </span><span class="token comment" style="color:#999988;font-style:italic">// attached p for executing go code (nil if not executing go code)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> nextp         puintptr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> oldp          puintptr </span><span class="token comment" style="color:#999988;font-style:italic">// the p that was attached before executing a syscall</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> id            </span><span class="token builtin">int64</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> mallocing     </span><span class="token builtin">int32</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> throwing      </span><span class="token builtin">int32</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> preemptoff    </span><span class="token builtin">string</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// if != "", keep curg running on this m</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> locks         </span><span class="token builtin">int32</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> dying         </span><span class="token builtin">int32</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> profilehz     </span><span class="token builtin">int32</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> spinning      </span><span class="token builtin">bool</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// m is out of work and is actively looking for work</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> blocked       </span><span class="token builtin">bool</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// m is blocked on a note</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> newSigstack   </span><span class="token builtin">bool</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// minit on C thread called sigaltstack</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> printlock     </span><span class="token builtin">int8</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> incgo         </span><span class="token builtin">bool</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic">// m is executing a cgo call</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> freeWait      </span><span class="token builtin">uint32</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// if == 0, safe to free g0 and delete m (atomic)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> fastrand      </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">uint32</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> needextram    </span><span class="token builtin">bool</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> traceback     </span><span class="token builtin">uint8</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ncgocall      </span><span class="token builtin">uint64</span><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// number of cgo calls in total</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ncgo          </span><span class="token builtin">int32</span><span class="token plain">       </span><span class="token comment" style="color:#999988;font-style:italic">// number of cgo calls currently in progress</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> cgoCallersUse </span><span class="token builtin">uint32</span><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// if non-zero, cgoCallers in use temporarily</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> cgoCallers    </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">cgoCallers </span><span class="token comment" style="color:#999988;font-style:italic">// cgo traceback if crashing in cgo call</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> doesPark      </span><span class="token builtin">bool</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// non-P running threads: sysmon and newmHandoff never use .park</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> park          note</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> alllink       </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">m </span><span class="token comment" style="color:#999988;font-style:italic">// on allm</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> schedlink     muintptr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> lockedg       guintptr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> createstack   </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">32</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">uintptr</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// stack that created this thread.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> lockedExt     </span><span class="token builtin">uint32</span><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// tracking for external LockOSThread</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> lockedInt     </span><span class="token builtin">uint32</span><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// tracking for internal lockOSThread</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> nextwaitm     muintptr    </span><span class="token comment" style="color:#999988;font-style:italic">// next m waiting for lock</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> waitunlockf   </span><span class="token keyword" style="color:#00009f">func</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">g</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> unsafe</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Pointer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin">bool</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> waitlock      unsafe</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Pointer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> waittraceev   </span><span class="token builtin">byte</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> waittraceskip </span><span class="token builtin">int</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> startingtrace </span><span class="token builtin">bool</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> syscalltick   </span><span class="token builtin">uint32</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> freelink      </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">m </span><span class="token comment" style="color:#999988;font-style:italic">// on sched.freem</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// mFixup is used to synchronize OS related m state (credentials etc)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// use mutex to access.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> mFixup </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  lock mutex</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  fn   </span><span class="token keyword" style="color:#00009f">func</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">bool</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin">bool</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// these are here because they are too large to be on the stack</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// of low-level NOSPLIT functions.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> libcall   libcall</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> libcallpc </span><span class="token builtin">uintptr</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// for cpu profiler</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> libcallsp </span><span class="token builtin">uintptr</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> libcallg  guintptr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> syscall   libcall </span><span class="token comment" style="color:#999988;font-style:italic">// stores syscall parameters on windows</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> vdsoSP </span><span class="token builtin">uintptr</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// SP for traceback while in VDSO call (0 if not in call)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> vdsoPC </span><span class="token builtin">uintptr</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// PC for traceback while in VDSO call</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// preemptGen counts the number of completed preemption</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// signals. This is used to detect when a preemption is</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// requested, but fails. Accessed atomically.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> preemptGen </span><span class="token builtin">uint32</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Whether this is a pending preemption signal on this M.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Accessed atomically.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> signalPending </span><span class="token builtin">uint32</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> dlogPerM</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> mOS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Up to 10 locks held by this m, maintained by the lock ranking code.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> locksHeldLen </span><span class="token builtin">int</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> locksHeld    </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">heldLockInfo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="p">P<a href="#p" class="hash-link" aria-label="P的直接链接" title="P的直接链接">​</a></h2><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> p </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> id          </span><span class="token builtin">int32</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> status      </span><span class="token builtin">uint32</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// one of pidle/prunning/...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> link        puintptr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> schedtick   </span><span class="token builtin">uint32</span><span class="token plain">     </span><span class="token comment" style="color:#999988;font-style:italic">// incremented on every scheduler call</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> syscalltick </span><span class="token builtin">uint32</span><span class="token plain">     </span><span class="token comment" style="color:#999988;font-style:italic">// incremented on every system call</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> sysmontick  sysmontick </span><span class="token comment" style="color:#999988;font-style:italic">// last tick observed by sysmon</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> m           muintptr   </span><span class="token comment" style="color:#999988;font-style:italic">// back-link to associated m (nil if idle)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> mcache      </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">mcache</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> pcache      pageCache</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> raceprocctx </span><span class="token builtin">uintptr</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> deferpool    </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">_defer </span><span class="token comment" style="color:#999988;font-style:italic">// pool of available defer structs of different sizes (see panic.go)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> deferpoolbuf </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">32</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">_defer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Cache of goroutine ids, amortizes accesses to runtime·sched.goidgen.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> goidcache    </span><span class="token builtin">uint64</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> goidcacheend </span><span class="token builtin">uint64</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Queue of runnable goroutines. Accessed without lock.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> runqhead </span><span class="token builtin">uint32</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> runqtail </span><span class="token builtin">uint32</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> runq     </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">256</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">guintptr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// runnext, if non-nil, is a runnable G that was ready'd by</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// the current G and should be run next instead of what's in</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// runq if there's time remaining in the running G's time</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// slice. It will inherit the time left in the current time</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// slice. If a set of goroutines is locked in a</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// communicate-and-wait pattern, this schedules that set as a</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// unit and eliminates the (potentially large) scheduling</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// latency that otherwise arises from adding the ready'd</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// goroutines to the end of the run queue.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> runnext guintptr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Available G's (status == Gdead)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> gFree </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  gList</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  n </span><span class="token builtin">int32</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> sudogcache </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">sudog</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> sudogbuf   </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">128</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">sudog</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Cache of mspan objects from the heap.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> mspancache </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// We need an explicit length here because this field is used</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// in allocation codepaths where write barriers are not allowed,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// and eliminating the write barrier/keeping it eliminated from</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// slice updates is tricky, moreso than just managing the length</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// ourselves.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token builtin">len</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  buf </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">128</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">mspan</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> tracebuf traceBufPtr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// traceSweep indicates the sweep events should be traced.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// This is used to defer the sweep start event until a span</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// has actually been swept.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> traceSweep </span><span class="token builtin">bool</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// traceSwept and traceReclaimed track the number of bytes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// swept and reclaimed by sweeping in the current sweep loop.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> traceSwept</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> traceReclaimed </span><span class="token builtin">uintptr</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> palloc persistentAlloc </span><span class="token comment" style="color:#999988;font-style:italic">// per-P to avoid mutex</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">_</span><span class="token plain"> </span><span class="token builtin">uint32</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Alignment for atomic fields below</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// The when field of the first entry on the timer heap.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// This is updated using atomic functions.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// This is 0 if the timer heap is empty.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> timer0When </span><span class="token builtin">uint64</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// The earliest known nextwhen field of a timer with</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// timerModifiedEarlier status. Because the timer may have been</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// modified again, there need not be any timer with this value.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// This is updated using atomic functions.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// This is 0 if the value is unknown.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> timerModifiedEarliest </span><span class="token builtin">uint64</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Per-P GC state</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> gcAssistTime         </span><span class="token builtin">int64</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Nanoseconds in assistAlloc</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> gcFractionalMarkTime </span><span class="token builtin">int64</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Nanoseconds in fractional mark worker (atomic)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// gcMarkWorkerMode is the mode for the next mark worker to run in.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// That is, this is used to communicate with the worker goroutine</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// selected for immediate execution by</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// gcController.findRunnableGCWorker. When scheduling other goroutines,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// this field must be set to gcMarkWorkerNotWorker.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> gcMarkWorkerMode gcMarkWorkerMode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// gcMarkWorkerStartTime is the nanotime() at which the most recent</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// mark worker started.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> gcMarkWorkerStartTime </span><span class="token builtin">int64</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// gcw is this P's GC work buffer cache. The work buffer is</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// filled by write barriers, drained by mutator assists, and</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// disposed on certain GC state transitions.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> gcw gcWork</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// wbBuf is this P's GC write barrier buffer.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// TODO: Consider caching this in the running G.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> wbBuf wbBuf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> runSafePointFn </span><span class="token builtin">uint32</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// if 1, run sched.safePointFn at next safe point</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// statsSeq is a counter indicating whether this P is currently</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// writing any stats. Its value is even when not, odd when it is.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> statsSeq </span><span class="token builtin">uint32</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Lock for timers. We normally access the timers while running</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// on this P, but the scheduler can also do it from a different P.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> timersLock mutex</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Actions to take at some time. This is used to implement the</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// standard library's time package.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Must hold timersLock to access.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> timers </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">timer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Number of timers in P's heap.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Modified using atomic instructions.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> numTimers </span><span class="token builtin">uint32</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Number of timerModifiedEarlier timers on P's heap.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// This should only be modified while holding timersLock,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// or while the timer status is in a transient state</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// such as timerModifying.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> adjustTimers </span><span class="token builtin">uint32</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Number of timerDeleted timers in P's heap.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Modified using atomic instructions.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> deletedTimers </span><span class="token builtin">uint32</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Race context used while executing timer functions.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> timerRaceCtx </span><span class="token builtin">uintptr</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// preempt is set to indicate that this P should be enter the</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// scheduler ASAP (regardless of what G is running on it).</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> preempt </span><span class="token builtin">bool</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> pad cpu</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">CacheLinePad</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="go-的模型调度">Go 的模型调度<a href="#go-的模型调度" class="hash-link" aria-label="Go 的模型调度的直接链接" title="Go 的模型调度的直接链接">​</a></h2><p>M(thread) 内核线程   , P(processor) 进程 ,G (goroutine) 协程</p><ul><li>G :  Go 运行时对goroutine的描述,G中存放并发执行的 <code>代码入口地址</code>,<code>上下文</code>,<code>运行环境</code> (关联的P和M),运行栈等执行相关的信息,G的新建,休眠,恢复,停止都受到Go运行时的管理</li></ul><p>GO运行时的监控线程会监控G的调度，G不会长久地阻塞系统线程，运行时的调度器会自动切换到其他G上运行。G新建或恢复时会添加到运行队列，等待M取出并运行。</p><ul><li><p>M : OS内核线程,是操作系统层面调度和执行的实体.M仅负责执行,M不停的唤醒或创建,然后执行</p></li><li><p>P : 代表M和P所需要的资源,是对资源的一种抽象管理,P 不是一段代码实体,而是一个管理的数据结构,P主要是降低 M对G的复杂性,增加一个间接的控制层数据结构,<code>P控制Go的并行度</code>,它不是实体</p></li></ul><p>P持有G的队列，P可以隔离调度，解除P和M的绑定就解除了M对一串G的调用。</p><p>G并不是执行体，而是存放并发执行体的元信息，包括并发执行的入口函数、堆栈、上下文等信息。G由于保存的是元信息，为了减少对象的分配和回收，G对象是可以复用，只需要将相关元信息初始化为新值即可。</p><p>M仅负责执行，M启动时进入运行时的管理代码，这段管理代码必须拿到P后，才能执行调度。</p><p>P的数目默认是CPU核心的数量。M和P的数目差不多，但运行时会根据当前的状态动态地创建M，M有一个最大值上限：10000；G与P是M:N的关系，M可以成千上万，远远大于N.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="work-stealing算法的基本原理">Work Stealing算法的基本原理<a href="#work-stealing算法的基本原理" class="hash-link" aria-label="Work Stealing算法的基本原理的直接链接" title="Work Stealing算法的基本原理的直接链接">​</a></h2><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">M和P构成一个运行时环境，每个P有一个本地的可调度的G队列，队列里面的G会被M依次调度执行，如果本地队列空了，则去全局队列偷取一部分G，如果全局队列也是空的，则去其他的P中偷取一部分G。</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="什么时候创建mpg">什么时候创建M、P、G<a href="#什么时候创建mpg" class="hash-link" aria-label="什么时候创建M、P、G的直接链接" title="什么时候创建M、P、G的直接链接">​</a></h2><p>在程序启动过程中会初始化空闲P列表，P是这个时候创建的，同时第一个G也是在初始化过程中被创建的。</p><p>每个并发调用都会初始化一个新的G任务，如何唤醒M执行任务。这个唤醒不是特定唤醒某个线程去工作，而是先尝试获取当前线程M，如果无法获取，则从全局调度的空闲M列表中获取可用的M，如果没有可用的M，则新建M，然后绑定P和GY运行。M和P不是一一对应的，而是按需分配的</p><p>M线程有管理调度和切换堆栈的逻辑，但是M必须拿到P后才能运行，可用看到M是自驱动的，单需要P的配合。</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="goroutine经历的过程">goroutine经历的过程<a href="#goroutine经历的过程" class="hash-link" aria-label="goroutine经历的过程的直接链接" title="goroutine经历的过程的直接链接">​</a></h2><ol><li>通过go func()来创建一个 goroutine</li><li>有两个存储的G队列,一个是局部调度器P的本地队列,一个是全局G队列,新创建的G会先保存在P的本地队列中,如果P的本地队列已经满了就会保存在全局队列中</li><li>G只能运行在M中,一个M必须有一个P,M与P是1:1的关系. M会对P的本地队列弹出一个可执行状态的G来执行,如果P的本地队列为空,就会向其它的MP组合取一个可执行的G来执行</li><li>一个M 调度执行的过程是一个循环机制</li><li>当 M执行某一个G 时候 如果发生了 syscall或其余阻塞操作,M会阻塞,如果</li></ol>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="源码" term="源码"/>
        <category label="Go" term="Go"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[高并发下如何保证接口的幂等性]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/03/05/idempotent</id>
        <link href="https://ahkevinxy.github.io/blog/2023/03/05/idempotent"/>
        <updated>2023-03-05T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[高并发幂等解决方案]]></summary>
        <content type="html"><![CDATA[<p><a href="https://mp.weixin.qq.com/s?__biz=MzkwNjMwMTgzMQ==&amp;mid=2247490307&amp;idx=1&amp;sn=b9eeb427c33cb171da6c3f11243a88f4&amp;chksm=c0ebc3ebf79c4afd0d5a1851a975534b672d86c531d28c5933013140173e794f5f53e78a6765&amp;token=751314179&amp;lang=zh_CN&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer">from</a></p><p><code>接口幂等性</code>问题，对于开发人员来说，是一个跟语言无关的公共问题。本文分享了一些解决这类问题非常实用的办法，绝大部分内容我在项目中实践过的，给有需要的小伙伴一个参考</p><p>场景</p><ol><li>有时我们在填写某些form表单时，保存按钮不小心快速点了两次，表中竟然产生了两条重复的数据，只是id不一样</li><li>我们在项目中为了解决<code>接口超时</code>问题，通常会引入了重试机制。第一次请求<code>接口超时</code>了，请求方没能及时获取返回结果（此时有可能已经成功了），为了避免返回错误的结果（这种情况不可能直接返回失败吧？），于是会对该请求重试几次，这样也会产生重复的数据。</li><li><code>mq</code>消费者在读取消息时，有时候会读取到重复消息，如果处理不好，也会产生重复的数据。</li></ol><p><code>接口幂等性</code>是指用户对于同一操作发起的一次请求或者多次请求的结果是一致的，不会因为多次点击而产生了副作用。</p><ul><li>insert操作，这种情况下多次请求，可能会产生重复数据</li><li>update操作，如果只是单纯的更新数据，比如：update user set status=1 where id=1，是没有问题的。如果还有计算，比如：update user set status=status+1 where id=1，这种情况下多次请求，可能会导致数据错误</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="insert前先select">insert前先select<a href="#insert前先select" class="hash-link" aria-label="insert前先select的直接链接" title="insert前先select的直接链接">​</a></h2><p>通常情况下，在保存数据的接口中，我们为了防止产生重复数据，一般会在insert前，先根据name或code字段select一下数据。如果该数据已存在，则执行update操作，如果不存在，才执行  insert操作。</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="加悲观锁">加悲观锁<a href="#加悲观锁" class="hash-link" aria-label="加悲观锁的直接链接" title="加悲观锁的直接链接">​</a></h2><p>在支付场景中，用户A的账号余额有150元，想转出100元，正常情况下用户A的余额只剩50元。一般情况下，sql是这样的：</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">update</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">user</span><span class="token plain"> amount </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> amount</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">100</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">where</span><span class="token plain"> id</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">123</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>如果出现多次相同的请求，可能会导致用户A的余额变成负数。这种情况，用户A来可能要哭了。于此同时，系统开发人员可能也要哭了，因为这是很严重的系统bug。</p><p>为了解决这个问题，可以加悲观锁，将用户A的那行数据锁住，在同一时刻只允许一个请求获得锁，更新数据，其他的请求则等待。</p><p>通常情况下通过如下sql锁住单行数据：</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">user</span><span class="token plain"> id</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">123</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">update</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol><li>多个请求同时根据id查询用户信息</li><li>判断余额是否不足100，如果余额不足，则直接返回余额不足。</li><li>如果余额充足，则通过for update再次查询用户信息，并且尝试获取锁</li><li>只有第一个请求能获取到行锁，其余没有获取锁的请求，则等待下一次获取锁的机会</li><li>第一个请求获取到锁之后，判断余额是否不足100，如果余额足够，则进行update操作。</li><li>如果余额不足，说明是重复请求，则直接返回成功。</li></ol><blockquote><p>需要特别注意的是：如果使用的是mysql数据库，存储引擎必须用innodb，因为它才支持事务。此外，这里id字段一定要是主键或者唯一索引，不然会锁住整张表。</p></blockquote><p>悲观锁需要在同一个事务操作过程中锁住一行数据，如果事务耗时比较长，会造成大量的请求等待，影响接口性能。</p><p>每次请求接口很难保证都有相同的返回值，所以不适合幂等性设计场景，但是在防重场景中是可以的使用的。</p><p>在这里顺便说一下，<code>防重设计</code> 和 <code>幂等设计</code>，其实是有区别的。防重设计主要为了避免产生重复数据，对接口返回没有太多要求。而幂等设计除了避免产生重复数据之外，还要求每次请求都返回一样的结果。</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="加乐观锁">加乐观锁<a href="#加乐观锁" class="hash-link" aria-label="加乐观锁的直接链接" title="加乐观锁的直接链接">​</a></h2><p>既然悲观锁有性能问题，为了提升接口性能，我们可以使用乐观锁。需要在表中增加一个timestamp或者version字段，这里以version字段为例。</p><p>在更新数据之前先查询一下数据：</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">amount</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">version </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">user</span><span class="token plain"> id</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">123</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>如果数据存在，假设查到的version等于1，再使用id和version字段作为查询条件更新数据：</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">update</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">user</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">set</span><span class="token plain"> amount</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">amount</span><span class="token operator" style="color:#393A34">+</span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">version</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">version</span><span class="token operator" style="color:#393A34">+</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">where</span><span class="token plain"> id</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">123</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> version</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>更新数据的同时version+1，然后判断本次update操作的影响行数，如果大于0，则说明本次更新成功，如果等于0，则说明本次更新没有让数据变更。</p><p>由于第一次请求version等于1是可以成功的，操作成功后version变成2了。这时如果并发的请求过来，再执行相同的sql：</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">update</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">user</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">set</span><span class="token plain"> amount</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">amount</span><span class="token operator" style="color:#393A34">+</span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">version</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">version</span><span class="token operator" style="color:#393A34">+</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">where</span><span class="token plain"> id</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">123</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> version</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>该update操作不会真正更新数据，最终sql的执行结果影响行数是0，因为version已经变成2了，where中的version=1肯定无法满足条件。但为了保证接口幂等性，接口可以直接返回成功，因为version值已经修改了，那么前面必定已经成功过一次，后面都是重复的请求。</p><ol><li>先根据id查询用户信息，包含version字段</li><li>根据id和version字段值作为where条件的参数，更新用户信息，同时version+1</li><li>判断操作影响行数，如果影响1行，则说明是一次请求，可以做其他数据操作</li><li>如果影响0行，说明是重复请求，则直接返回成功</li></ol><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="加唯一索引">加唯一索引<a href="#加唯一索引" class="hash-link" aria-label="加唯一索引的直接链接" title="加唯一索引的直接链接">​</a></h2><p>绝大数情况下，为了防止重复数据的产生，我们都会在表中加唯一索引，这是一个非常简单，并且有效的方案。</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">alter</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">table</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">order</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">add</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">UNIQUE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">KEY</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">un_code</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">code</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>加了唯一索引之后，第一次请求数据可以插入成功。但后面的相同请求，插入数据时会报<code>Duplicate entry '002' for key 'order.un_code</code>异常，表示唯一索引有冲突。</p><p>虽说抛异常对数据来说没有影响，不会造成错误数据。但是为了保证接口幂等性，我们需要对该异常进行捕获，然后返回成功。</p><ol><li>用户通过浏览器发起请求，服务端收集数据。</li><li>将该数据插入mysql</li><li>判断是否执行成功，如果成功，则操作其他数据（可能还有其他的业务逻辑）。</li><li>如果执行失败，捕获唯一索引冲突异常，直接返回成功。</li></ol><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="建防重表">建防重表<a href="#建防重表" class="hash-link" aria-label="建防重表的直接链接" title="建防重表的直接链接">​</a></h2><p>有时候表中并非所有的场景都不允许产生重复的数据，只有某些特定场景才不允许。这时候，直接在表中加唯一索引，显然是不太合适的。
针对这种情况，我们可以通过<code>建防重表</code>来解决问题。</p><p>该表可以只包含两个字段：<code>id</code> 和 <code>唯一索引</code>，唯一索引可以是多个字段比如：name、code等组合起来的唯一标识，例如：susan_0001。</p><ol><li>用户通过浏览器发起请求，服务端收集数据。</li><li>将该数据插入mysql防重表</li><li>判断是否执行成功，如果成功，则做mysql其他的数据操作（可能还有其他的业务逻辑）。</li><li>如果执行失败，捕获唯一索引冲突异常，直接返回成功。</li></ol><blockquote><p>需要特别注意的是：防重表和业务表必须在同一个数据库中，并且操作要在同一个事务中。</p></blockquote><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="根据状态机">根据状态机<a href="#根据状态机" class="hash-link" aria-label="根据状态机的直接链接" title="根据状态机的直接链接">​</a></h2><p>很多时候业务表是有状态的，比如订单表中有：1-下单、2-已支付、3-完成、4-撤销等状态。如果这些状态的值是有规律的，按照业务节点正好是从小到大，我们就能通过它来保证接口的幂等性。</p><p>假如<code>id=123</code>的订单状态是已支付，现在要变成完成状态。</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">update</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">order</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">set</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">status</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">where</span><span class="token plain"> id</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">123</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">status</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>第一次请求时，该订单的状态是<code>已支付</code>，值是<code>2</code>，所以该<code>update</code>语句可以正常更新数据，<code>sql</code>执行结果的影响行数是<code>1</code>，订单状态变成了<code>3</code>。</p><p>后面有相同的请求过来，再执行相同的sql时，由于订单状态变成了3，再用status=2作为条件，无法查询出需要更新的数据，所以最终sql执行结果的影响行数是0，即不会真正的更新数据。但为了保证接口幂等性，影响行数是0时，接口也可以直接返回成功。</p><ol><li>用户通过浏览器发起请求，服务端收集数据。</li><li>根据id和当前状态作为条件，更新成下一个状态</li><li>判断操作影响行数，如果影响了1行，说明当前操作成功，可以进行其他数据操作。</li><li>如果影响了0行，说明是重复请求，直接返回成功。</li></ol><blockquote><p>主要特别注意的是，该方案仅限于要更新的<code>表有状态字段</code>，并且刚好要更新<code>状态字段</code>的这种特殊情况，并非所有场景都适用。</p></blockquote><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="加分布式锁">加分布式锁<a href="#加分布式锁" class="hash-link" aria-label="加分布式锁的直接链接" title="加分布式锁的直接链接">​</a></h2><p>其实前面介绍过的<code>加唯一索引</code>或者<code>加防重表</code>，本质是使用了<code>数据库</code>的<code>分布式锁</code>，也属于<code>分布式锁</code>的一种。但由于<code>数据库分布式锁</code>的性能不太好，我们可以改用：<code>redis</code>或<code>zookeeper</code>。</p><p>鉴于现在很多公司分布式配置中心改用<code>apollo</code>或<code>nacos</code>，已经很少用<code>zookeeper</code>了，我们以<code>redis</code>为例介绍分布式锁。</p><p>目前主要有三种方式实现redis的分布式锁：</p><ol><li>setNx命令</li><li>set命令</li><li>Redission框架</li></ol><p>具体步骤：</p><ol><li>用户通过浏览器发起请求，服务端会收集数据，并且生成订单号code作为唯一业务字段。</li><li>使用redis的set命令，将该订单code设置到redis中，同时设置超时时间。</li><li>判断是否设置成功，如果设置成功，说明是第一次请求，则进行数据操作。</li><li>如果设置失败，说明是重复请求，则直接返回成功。</li></ol><blockquote><p>需要特别注意的是：分布式锁一定要设置一个合理的过期时间，如果设置过短，无法有效的防止重复请求。如果设置过长，可能会浪费redis的存储空间，需要根据实际业务情况而定。</p></blockquote><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="获取token">获取token<a href="#获取token" class="hash-link" aria-label="获取token的直接链接" title="获取token的直接链接">​</a></h2><p>除了上述方案之外，还有最后一种使用token的方案。该方案跟之前的所有方案都有点不一样，需要两次请求才能完成一次业务操作。</p><ol><li>第一次请求获取token</li><li>第二次请求带着这个token，完成业务操作。</li></ol><p>具体步骤：</p><ol><li>用户访问页面时，浏览器自动发起获取token请求。</li><li>服务端生成token，保存到redis中，然后返回给浏览器。</li><li>用户通过浏览器发起请求时，携带该token。</li><li>在redis中查询该token是否存在，如果不存在，说明是第一次请求，做则后续的数据操作。</li><li>如果存在，说明是重复请求，则直接返回成功。</li><li>在redis中token会在过期时间之后，被自动删除。</li></ol><blockquote><p>需要特别注意的是：token必须是全局唯一的。</p></blockquote>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="高并发" term="高并发"/>
        <category label="幂等" term="幂等"/>
        <category label="解决方案" term="解决方案"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[如何优雅的接口]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/03/05/index</id>
        <link href="https://ahkevinxy.github.io/blog/2023/03/05/index"/>
        <updated>2023-03-05T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[如何优雅的接口,接口设计,页面优化,代码规范]]></summary>
        <content type="html"><![CDATA[<p><a href="https://juejin.cn/post/7176220436714225721" target="_blank" rel="noopener noreferrer">from</a></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="签名">签名<a href="#签名" class="hash-link" aria-label="签名的直接链接" title="签名的直接链接">​</a></h2><p>接口请求将 <code>请求参数</code> + <code>时间戳</code> + <code>秘钥</code> 拼接成一个字符串,通过<code>md5</code> 等hash 算法,生成一个sign</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="加密">加密<a href="#加密" class="hash-link" aria-label="加密的直接链接" title="加密的直接链接">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="sm2-国密">sm2 国密<a href="#sm2-国密" class="hash-link" aria-label="sm2 国密的直接链接" title="sm2 国密的直接链接">​</a></h3><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="rsa-加密">rsa 加密<a href="#rsa-加密" class="hash-link" aria-label="rsa 加密的直接链接" title="rsa 加密的直接链接">​</a></h3><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ip-白名单">ip 白名单<a href="#ip-白名单" class="hash-link" aria-label="ip 白名单的直接链接" title="ip 白名单的直接链接">​</a></h2><p>为了 限制 api 接口的安全性,防止 接口签名或加密被破解,攻击者 可以在自己的服务器上请求改接口</p><p>只有 在白名单中的ip地址,才能成功请求api接口,否则返回无权限</p><p>这时候就需要增加web防火墙了，比如：ModSecurity (todo 研究)等。</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="限流">限流<a href="#限流" class="hash-link" aria-label="限流的直接链接" title="限流的直接链接">​</a></h2><p>限流方法有三种：</p><ol><li>对请求ip做限流 : 策略制定</li><li>对请求接口做限流</li><li>对请求用户做限流</li></ol><p>我们在实际工作中，可以通过nginx，redis或者gateway实现限流的功能。</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="参数校验">参数校验<a href="#参数校验" class="hash-link" aria-label="参数校验的直接链接" title="参数校验的直接链接">​</a></h2><p>我们需要对API接口做参数校验，比如：校验必填字段是否为空，校验字段类型，校验字段长度，校验枚举值等等。</p><p>这样做可以拦截一些无效的请求。</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="统一返回值">统一返回值<a href="#统一返回值" class="hash-link" aria-label="统一返回值的直接链接" title="统一返回值的直接链接">​</a></h2><p>我之前调用过别人的API接口，正常返回数据是一种json格式，比如：</p><p>签名错误返回的json格式：</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">"code"</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">1001</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">"message"</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">"签名错误"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">"data"</span><span class="token operator" style="color:#393A34">:</span><span class="token null keyword" style="color:#00009f">null</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>没有数据权限返回的json格式：</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">"rt"</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">"errorMgt"</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">"没有权限"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">"result"</span><span class="token operator" style="color:#393A34">:</span><span class="token null keyword" style="color:#00009f">null</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="统一封装异常">统一封装异常<a href="#统一封装异常" class="hash-link" aria-label="统一封装异常的直接链接" title="统一封装异常的直接链接">​</a></h2><p>我们的API接口需要对异常进行统一处理。</p><p>不知道你有没有遇到过这种场景：有时候在API接口中，需要访问数据库，但表不存在，或者sql语句异常，就会直接把sql信息在API接口中直接返回。</p><p>返回值中包含了<code>异常堆栈信息</code>、<code>数据库信息</code>、<code>错误代码</code>和<code>行数</code>等信息。</p><p>因此非常有必要对API接口中的异常做统一处理，把异常转换成这样：</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">"code"</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">500</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">"message"</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">"服务器内部错误"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">"data"</span><span class="token operator" style="color:#393A34">:</span><span class="token null keyword" style="color:#00009f">null</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>我们可以在gateway中对异常进行拦截，做统一封装，然后给第三方平台的是处理后没有敏感信息的错误信息。</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="请求日志">请求日志<a href="#请求日志" class="hash-link" aria-label="请求日志的直接链接" title="请求日志的直接链接">​</a></h2><p>我们需要把API接口的请求url、请求参数、请求头、请求方式、响应数据和响应时间等，记录到日志文件中。</p><p>当然有些时候，请求日志不光是你们公司开发人员需要查看，第三方平台的用户也需要能查看接口的请求日志。</p><p>这时就需要把日志落地到数据库，比如：mongodb或者elastic search，然后做一个UI页面，给第三方平台的用户开通查看权限。这样他们就能在外网查看请求日志了，他们自己也能定位一部分问题。</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="幂等设计">幂等设计<a href="#幂等设计" class="hash-link" aria-label="幂等设计的直接链接" title="幂等设计的直接链接">​</a></h2><p>第三方平台极有可能在极短的时间内，请求我们接口多次，比如：在1秒内请求两次。有可能是他们业务系统有bug，或者在做接口调用失败重试，因此我们的API接口需要做幂等设计。</p><p>也就是说要支持在极短的时间内，第三方平台用相同的参数请求API接口多次，第一次请求数据库会新增数据，但第二次请求以后就不会新增数据，但也会返回成功。</p><p>我们在日常工作中，可以通过在数据库中增加唯一索引，或者在redis保存requestId和请求参来保证接口幂等性。</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="限制记录条数">限制记录条数<a href="#限制记录条数" class="hash-link" aria-label="限制记录条数的直接链接" title="限制记录条数的直接链接">​</a></h2><p>对于对我提供的批量接口，一定要<code>限制请求的记录条数</code>。</p><p>如果请求的数据太多，很容易造成API接口超时等问题，让API接口变得不稳定。</p><p>通常情况下，建议一次请求中的参数，最多支持传入500条记录。</p><p>如果用户传入多余500条记录，则接口直接给出提示。</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="压测">压测<a href="#压测" class="hash-link" aria-label="压测的直接链接" title="压测的直接链接">​</a></h2><p>上线前我们务必要对API接口做一下压力测试，知道各个接口的<code>qps</code>情况。</p><p>我们在工作中可以用<code>jmeter</code>或者<code>apache benc</code> 或 <code>ab</code>对API接口做压力测试。</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="异步处理">异步处理<a href="#异步处理" class="hash-link" aria-label="异步处理的直接链接" title="异步处理的直接链接">​</a></h2><p>一般的<code>API</code>接口的逻辑都是同步处理的，请求完之后立刻返回结果。</p><p>但有时候，我们的<code>API</code>接口里面的业务逻辑非常复杂，特别是有些批量接口，如果同步处理业务，耗时会非常长。</p><p>这种情况下，为了提升<code>API</code>接口的性能，我们可以改成异步处理。</p><p>在API接口中可以发送一条mq消息，然后直接返回成功。之后，有个专门的mq消费者去异步消费该消息，做业务逻辑处理。</p><p>直接异步处理的接口，第三方平台有两种方式获取到。</p><p>第一种方式是：我们回调第三方平台的接口，告知他们API接口的处理结果，很多支付接口就是这么玩的。</p><p>第二种方式是：第三方平台通过轮询调用我们另外一个查询状态的API接口，每隔一段时间查询一次状态，传入的参数是之前的那个API接口中的id集合。</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="数据脱敏">数据脱敏<a href="#数据脱敏" class="hash-link" aria-label="数据脱敏的直接链接" title="数据脱敏的直接链接">​</a></h2><p>有时候第三方平台调用我们API接口时，获取的数据中有一部分是敏感数据，比如：用户手机号、银行卡号等等。</p><p>这样信息如果通过API接口直接保留到外网，是非常不安全的，很容易造成用户隐私数据泄露的问题。</p><p>这就需要对部分数据做数据脱敏了。</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="完整的接口文档">完整的接口文档<a href="#完整的接口文档" class="hash-link" aria-label="完整的接口文档的直接链接" title="完整的接口文档的直接链接">​</a></h2><p>说实话，一份完整的API接口文档，在双方做接口对接时，可以减少很多沟通成本，让对方少走很多弯路。</p><p>接口文档中需要包含如下信息：</p><ol><li>接口地址</li><li>请求方式，比如：post或get</li><li>请求参数和字段介绍</li><li>返回值和字段介绍</li><li>返回码和错误信息</li><li>加密或签名示例</li><li>完整的请求demo</li><li>额外的说明，比如：开通ip白名单</li></ol><p>接口文档中最好能够统一接口和字段名称的命名风格，比如都用<code>驼峰标识</code>命名。</p><p>统一字段的类型和长度，比如：id字段用Long类型，长度规定20。status字段用int类型，长度固定2等。</p><p>统一时间格式字段，比如：time用String类型，格式为：yyyy-MM-dd HH:mm:ss。</p><p>接口文档中写明AK/SK和域名，找某某单独提供等。</p>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="接口" term="接口"/>
        <category label="加密" term="加密"/>
        <category label="规范" term="规范"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[umi4 配置 antd 默认中文模式]]></title>
        <id>https://ahkevinxy.github.io/blog/2023/02/24/index</id>
        <link href="https://ahkevinxy.github.io/blog/2023/02/24/index"/>
        <updated>2023-02-24T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[umi4 配置 antd 默认中文模式]]></summary>
        <content type="html"><![CDATA[<p>2023年02月24日17:32:20</p><div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> defineConfig </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"umi"</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> zhCN </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'antd/locale/zh_CN'</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">default</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">defineConfig</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  plugins</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">'@umijs/plugins/dist/antd'</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  antd</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    configProvider</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      locale</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> zhCN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  routes</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> path</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"/"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> component</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"index"</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> path</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"/docs"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> component</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"docs"</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  npmClient</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'yarn'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  base</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'/'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  hash</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="umi" term="umi"/>
        <category label="antd" term="antd"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Go 与 Java  Rsa加密算法]]></title>
        <id>https://ahkevinxy.github.io/blog/2022/11/25/index</id>
        <link href="https://ahkevinxy.github.io/blog/2022/11/25/index"/>
        <updated>2022-11-25T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Go 与 Java  Rsa加密算法 兼容性加密解决方案 完美解决语言之间加密不兼容]]></summary>
        <content type="html"><![CDATA[<p>⚡️ 和 甲方对接系统 遇到 java Rsa 加密  go 无法解密的问题</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>备注</div><div class="admonitionContent_S0QG"><ol><li>go 生成的公钥 不能直接给Java使用</li><li>java的 公钥 需要把  go 生成的头 <code>-----BEGIN RSA Public Key-----</code> 和 <code>-----END RSA Public Key-----</code> 删除 不能保存即可</li></ol></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="go--代码">go  代码<a href="#go--代码" class="hash-link" aria-label="go  代码的直接链接" title="go  代码的直接链接">​</a></h2><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">package</span><span class="token plain"> rsa</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">"crypto/rand"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">"crypto/rsa"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">"crypto/x509"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">"encoding/base64"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">"encoding/pem"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">"fmt"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">"os"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//RSA解密</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Decrypt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cipherText </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">byte</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> path </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">byte</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//打开文件</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    file</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">panic</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">defer</span><span class="token plain"> file</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//获取文件内容</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    info</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">_</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> file</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Stat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    buf </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">make</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">byte</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> info</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Size</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    file</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Read</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">buf</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//pem解码</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    block</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">_</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> pem</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Decode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">buf</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//X509解码</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    privateKey</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> x509</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">ParsePKCS1PrivateKey</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">block</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Bytes</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">panic</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//对密文进行解密</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    plainText</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">_</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> rsa</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">DecryptPKCS1v15</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rand</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Reader</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> privateKey</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> cipherText</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//返回明文</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> plainText</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// DecryptByString</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// @Description: 解密</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// @Author ahKevinXy</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// @Date 2022-11-22 16:50:15</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">DecryptByString</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cipherText </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> key </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">byte</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//打开文件</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    content </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Base64Decode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cipherText</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//X509解码</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    block</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">_</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> pem</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Decode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token function" style="color:#d73a49">byte</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    privateKey</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> x509</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">ParsePKCS1PrivateKey</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">block</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Bytes</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">panic</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//对密文进行解密</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    plainText</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">_</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> rsa</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">DecryptPKCS1v15</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rand</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Reader</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> privateKey</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> content</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//返回明文</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> plainText</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//RSA加密 通过私钥路径</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Encrypt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">plainText </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">byte</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> path </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">byte</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//打开文件</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    file</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">panic</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">defer</span><span class="token plain"> file</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//读取文件的内容</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    info</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">_</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> file</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Stat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    buf </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">make</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">byte</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> info</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Size</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    file</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Read</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">buf</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//pem解码</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    block</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">_</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> pem</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Decode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">buf</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//x509解码</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    publicKeyInterface</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> x509</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">ParsePKIXPublicKey</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">block</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Bytes</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">panic</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//类型断言</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    publicKey </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> publicKeyInterface</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">rsa</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">PublicKey</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//对明文进行加密</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cipherText</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> rsa</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">EncryptPKCS1v15</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rand</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Reader</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> publicKey</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> plainText</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">panic</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//返回密文</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> cipherText</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 通过直接传 string 方式</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">EncryptByString</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">plainText </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> public </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    block</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">_</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> pem</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Decode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token function" style="color:#d73a49">byte</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">public</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//x509解码</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    publicKeyInterface</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> x509</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">ParsePKIXPublicKey</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">block</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Bytes</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">panic</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//类型断言</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    publicKey </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> publicKeyInterface</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">rsa</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">PublicKey</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//对明文进行加密</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cipherText</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> rsa</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">EncryptPKCS1v15</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rand</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Reader</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> publicKey</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token function" style="color:#d73a49">byte</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">plainText</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">panic</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cipherText</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">//返回密文</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">string</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cipherText</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Base64EncodeString</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">string</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cipherText</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Base64EncodeString</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">str </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> base64</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">StdEncoding</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">EncodeToString</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token function" style="color:#d73a49">byte</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">str</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Base64Decode</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// @Description: base64解码</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// @Author ahKevinXy</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// @Date 2022-11-22 17:04:52</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Base64Decode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">byte</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    decodedByte</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">_</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> base64</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">StdEncoding</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">DecodeString</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> decodedByte</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="java-代码">java 代码<a href="#java-代码" class="hash-link" aria-label="java 代码的直接链接" title="java 代码的直接链接">​</a></h2><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token import namespace" style="opacity:0.7">javax</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import namespace" style="opacity:0.7">crypto</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import class-name">Cipher</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token import namespace" style="opacity:0.7">java</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import namespace" style="opacity:0.7">io</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import class-name">ByteArrayOutputStream</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token import namespace" style="opacity:0.7">java</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import namespace" style="opacity:0.7">security</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import operator" style="color:#393A34">*</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token import namespace" style="opacity:0.7">java</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import namespace" style="opacity:0.7">security</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import namespace" style="opacity:0.7">interfaces</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import class-name">RSAPrivateKey</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token import namespace" style="opacity:0.7">java</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import namespace" style="opacity:0.7">security</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import namespace" style="opacity:0.7">interfaces</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import class-name">RSAPublicKey</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token import namespace" style="opacity:0.7">java</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import namespace" style="opacity:0.7">security</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import namespace" style="opacity:0.7">spec</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import class-name">InvalidKeySpecException</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token import namespace" style="opacity:0.7">java</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import namespace" style="opacity:0.7">security</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import namespace" style="opacity:0.7">spec</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import class-name">PKCS8EncodedKeySpec</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token import namespace" style="opacity:0.7">java</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import namespace" style="opacity:0.7">security</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import namespace" style="opacity:0.7">spec</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import class-name">X509EncodedKeySpec</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token import namespace" style="opacity:0.7">java</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import namespace" style="opacity:0.7">util</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import class-name">Base64</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token import namespace" style="opacity:0.7">java</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import namespace" style="opacity:0.7">util</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import class-name">HashMap</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token import namespace" style="opacity:0.7">java</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import namespace" style="opacity:0.7">util</span><span class="token import namespace punctuation" style="opacity:0.7;color:#393A34">.</span><span class="token import class-name">Map</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">RSATest</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">final</span><span class="token plain"> </span><span class="token class-name">String</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">KEY_ALGORITHM</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"RSA"</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 公钥</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">final</span><span class="token plain"> </span><span class="token class-name">String</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">PUBLIC_KEY</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"xxxxx加密公钥"</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">final</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">MAX_ENCRYPT_BLOCK</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">117</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">final</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">MAX_DECRYPT_BLOCK</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">128</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">String</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> args</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">throws</span><span class="token plain"> </span><span class="token class-name">Exception</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">String</span><span class="token plain"> cipherText</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">String</span><span class="token plain"> content </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"这是一个测试加密密码"</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">String</span><span class="token plain"> publicKey </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">PUBLIC_KEY</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        cipherText </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">encrypt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">content</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> publicKey</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">out</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cipherText</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 获取公钥</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token class-name">PublicKey</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getPublicKey</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">String</span><span class="token plain"> publicKeyString</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">throws</span><span class="token plain"> </span><span class="token class-name">NoSuchAlgorithmException</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">InvalidKeySpecException</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">byte</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> publicKeyByte </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">Base64</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getDecoder</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">decode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">publicKeyString</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">X509EncodedKeySpec</span><span class="token plain"> keySpec </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">X509EncodedKeySpec</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">publicKeyByte</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">KeyFactory</span><span class="token plain"> keyFactory </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">KeyFactory</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getInstance</span><span class="token punctuation" style="color:#393A34">(</span><span class="token constant" style="color:#36acaa">KEY_ALGORITHM</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> keyFactory</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">generatePublic</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">keySpec</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token class-name">String</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">encrypt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">String</span><span class="token plain"> text</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">String</span><span class="token plain"> publicKeyStr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">try</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token class-name">Cipher</span><span class="token plain"> cipher </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">Cipher</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getInstance</span><span class="token punctuation" style="color:#393A34">(</span><span class="token constant" style="color:#36acaa">KEY_ALGORITHM</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cipher</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">init</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Cipher</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">ENCRYPT_MODE</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getPublicKey</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">publicKeyStr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">byte</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> tempBytes </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cipher</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">doFinal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getBytes</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"UTF-8"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token class-name">Base64</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getEncoder</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">encodeToString</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tempBytes</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Exception</span><span class="token plain"> e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">throw</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">RuntimeException</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"加密字符串["</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> text </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"]时遇到异常"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content>
        <author>
            <name>ahKevinXy</name>
            <email>ahkevinxy@gmail.com</email>
            <uri>https://github.com/ahKevinXy</uri>
        </author>
        <category label="Go" term="Go"/>
        <category label="Java" term="Java"/>
        <category label="加密" term="加密"/>
        <category label="RSA" term="RSA"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[程序员到架构师]]></title>
        <id>https://ahkevinxy.github.io/blog/2022/09/22/index</id>
        <link href="https://ahkevinxy.github.io/blog/2022/09/22/index"/>
        <updated>2022-09-22T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[还是直接放弃吧]]></summary>
        <content type="html"><![CDATA[<p>还是直接放弃吧</p>]]></content>
    </entry>
</feed>